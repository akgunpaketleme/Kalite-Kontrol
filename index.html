<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AKG Kalite Kontrol ve Paketleme Takip Sistemi</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        .header {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        }
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }
        .firebase-status {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 10px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            z-index: 1000;
            transition: all 0.3s ease;
        }
        .firebase-connected {
            background: #27ae60;
            color: white;
        }
        .firebase-disconnected {
            background: #e74c3c;
            color: white;
        }
        .tabs {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 25px;
            justify-content: center;
        }
        .tab {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
        }
        .tab:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(52, 152, 219, 0.4);
        }
        .tab.active {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            box-shadow: 0 6px 20px rgba(231, 76, 60, 0.4);
        }
        .tab-content {
            display: none;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .tab-content.active {
            display: block;
        }
        .tab-content h2 {
            color: #2c3e50;
            margin-bottom: 25px;
            font-size: 2em;
            text-align: center;
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            padding: 15px;
            border-radius: 10px;
        }
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }
        .form-group {
            display: flex;
            flex-direction: column;
        }
        .form-group label {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
            font-size: 1.1em;
        }
        .form-group input, .form-group select, .form-group textarea {
            padding: 12px;
            border: 2px solid #bdc3c7;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s ease;
        }
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 10px rgba(52, 152, 219, 0.3);
        }
        .btn {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(39, 174, 96, 0.3);
            margin: 5px;
        }
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(39, 174, 96, 0.4);
        }
        .btn-success {
            background: linear-gradient(135deg, #f39c12, #e67e22);
        }
        .btn-danger {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }
        .hata-container {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 25px;
            border: 2px solid #e9ecef;
        }
        .hata-container h3 {
            color: #2c3e50;
            margin-bottom: 20px;
            text-align: center;
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
            padding: 12px;
            border-radius: 8px;
        }
        .hata-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 15px;
        }
        .hata-item {
            background: white;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #e9ecef;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: all 0.3s ease;
        }
        .hata-item:hover {
            border-color: #3498db;
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.1);
        }
        .hata-item input[type="checkbox"] {
            margin-right: 12px;
            transform: scale(1.3);
        }
        .hata-item label {
            flex-grow: 1;
            font-weight: 600;
            color: #2c3e50;
        }
        .hata-adet-container {
            display: flex;
            gap: 8px;
        }
        .hata-adet {
            width: 70px;
            padding: 8px;
            text-align: center;
            border: 2px solid #e9ecef;
            border-radius: 6px;
            font-weight: bold;
        }
        .hata-adet:first-child {
            border-color: #e74c3c;
            color: #e74c3c;
        }
        .hata-adet:last-child {
            border-color: #f39c12;
            color: #f39c12;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .stat-card {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            padding: 25px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 6px 20px rgba(52, 152, 219, 0.3);
        }
        .stat-card h3 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        .stat-card p {
            font-size: 1.1em;
            opacity: 0.9;
        }
        .alert {
            padding: 15px;
            margin: 15px 0;
            border-radius: 8px;
            font-weight: 600;
        }
        .alert-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .alert-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .kayit-item {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }
        .kayit-header {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            padding: 12px 15px;
            border-radius: 6px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 600;
        }
        .kayit-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            color: #2c3e50;
        }
        .stok-kayit-item {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }
        .stok-kayit-item:hover {
            border-color: #3498db;
            box-shadow: 0 6px 20px rgba(52, 152, 219, 0.2);
        }
        .stok-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #ecf0f1;
        }
        .stok-header h4 {
            color: #2c3e50;
            font-size: 1.3em;
        }
        .stok-bilgi {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        .stok-bilgi-item {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 6px;
            border-left: 4px solid #3498db;
        }
        .stok-kontrol {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-bottom: 15px;
            padding: 15px;
            background: #ecf0f1;
            border-radius: 8px;
        }
        .stok-btn-small {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            color: white;
            border: none;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 18px;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        .stok-btn-small.minus {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }
        .stok-btn-small:hover {
            transform: scale(1.1);
        }
        .stok-adet-display {
            background: white;
            padding: 8px 15px;
            border: 2px solid #3498db;
            border-radius: 6px;
            font-weight: bold;
            font-size: 1.2em;
            color: #2c3e50;
            min-width: 60px;
            text-align: center;
        }
        .stok-adet-input {
            width: 80px;
            padding: 8px;
            text-align: center;
            border: 2px solid #f39c12;
            border-radius: 6px;
            font-weight: bold;
        }
        .stok-actions {
            display: flex;
            gap: 10px;
            justify-content: center;
        }
        .btn-edit {
            background: linear-gradient(135deg, #f39c12, #e67e22);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s ease;
        }
        .btn-delete {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s ease;
        }
        .btn-edit:hover, .btn-delete:hover {
            transform: translateY(-2px);
        }
        .kaydedilmis-stoklar {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 12px;
            margin: 25px 0;
            border: 2px solid #e9ecef;
        }
        .kaydedilmis-stoklar h3 {
            color: #2c3e50;
            margin-bottom: 20px;
            text-align: center;
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            color: white;
            padding: 12px;
            border-radius: 8px;
        }
        .siparis-checkbox-container {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-top: 10px;
            border: 2px solid #e9ecef;
        }
        .siparis-checkboxes {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }
        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: background-color 0.2s ease;
        }
        .checkbox-item:hover {
            background-color: #e9ecef;
        }
        .checkbox-item input[type="checkbox"] {
            transform: scale(1.1);
        }
        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
            .hata-grid {
                grid-template-columns: 1fr;
            }
            .tabs {
                flex-direction: column;
            }
            .tab {
                width: 100%;
                margin-bottom: 5px;
            }
            .stok-bilgi {
                grid-template-columns: 1fr;
            }
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Firebase bağlantı durumu göstergesi -->
    <div id="firebaseStatus" class="firebase-status firebase-disconnected">
        🔴 Firebase: Bağlanıyor...
    </div>

    <div class="container">
        <div class="header">
            <h1>🏭 AKG Kalite Kontrol ve Paketleme Takip Sistemi</h1>
        </div>
        
        <!-- Tabs -->
        <div class="tabs">
            <button class="tab active" onclick="showTab('kalite-kontrol')">🔍 Kalite Kontrol</button>
            <button class="tab" onclick="showTab('siparis-hazirlik')">📋 Sipariş Hazırlığı</button>
            <button class="tab" onclick="showTab('stok')">📦 Stok Yönetimi</button>
            <button class="tab" onclick="showTab('temizleme')">🧽 Temizlemeye Gidecek Ürünler</button>
            <button class="tab" onclick="showTab('sevke-hazir')">📤 Sevke Hazır Ürünler</button>
            <button class="tab" onclick="showTab('sevk-edilen')">🚚 Sevk Edilen Ürünler</button>
            <button class="tab" onclick="showTab('yari-mamul')">🔧 Yarı Mamül Stok</button>
            <button class="tab" onclick="showTab('gunluk-performans')">⚡ Günlük Performans</button>
            <button class="tab" onclick="showTab('istatistikler')">📈 İstatistikler</button>
            <button class="tab" onclick="showTab('veri-goruntule')">📊 Veri Görüntüle</button>
            <button class="tab" onclick="showTab('raporlar')">📋 Raporlar</button>
            <button class="tab" onclick="showTab('ayarlar')">⚙️ Ayarlar</button>
        </div>
        
        <!-- Kalite Kontrol Tab -->
        <div id="kalite-kontrol" class="tab-content active">
            <h2>🔍 Kalite Kontrol Formu</h2>
            <form id="kaliteForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="tarih">📅 Tarih/Saat</label>
                        <input type="datetime-local" id="tarih" required>
                    </div>
                    <div class="form-group">
                        <label for="operator">👤 Operatörün Adı</label>
                        <select id="operator" required>
                            <option value="">Operatör seçin</option>
                            <option value="Esat">Esat</option>
                            <option value="Ahmet">Ahmet</option>
                            <option value="Emre">Emre</option>
                            <option value="Gökay">Gökay</option>
                            <option value="Berke">Berke</option>
                            <option value="Melisa">Melisa</option>
                            <option value="Evrim">Evrim</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="urunKodu">📦 Ürün Kodu</label>
                        <input type="text" id="urunKodu" placeholder="Ürün kodunu girin" required>
                    </div>
                    <div class="form-group">
                        <label for="toplamAdet">📊 Toplam Adet</label>
                        <input type="number" id="toplamAdet" min="1" placeholder="Toplam ürün adedi" required>
                    </div>
                    <div class="form-group">
                        <label for="siparisNo">🏷️ Sipariş Numarası</label>
                        <input type="text" id="siparisNo" placeholder="Sipariş numarasını girin" required>
                    </div>
                </div>
                <div class="hata-container">
                    <h3>🚫 Hata Türleri ve Adetleri</h3>
                    <div style="display: flex; justify-content: flex-end; margin-bottom: 15px; gap: 8px; font-size: 12px; color: #666; font-weight: bold;">
                        <span style="color: #e74c3c; width: 70px; text-align: center;">İskarta</span>
                        <span style="color: #f39c12; width: 70px; text-align: center;">Geri Giden</span>
                    </div>
                    <div class="hata-grid">
                        <div class="hata-item">
                            <input type="checkbox" id="hata1" name="hatalar" value="Ağız yamukluğu">
                            <label for="hata1">Ağız yamukluğu</label>
                            <div class="hata-adet-container">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                            </div>
                        </div>
                        <div class="hata-item">
                            <input type="checkbox" id="hata2" name="hatalar" value="Yetersiz kaynak">
                            <label for="hata2">Yetersiz kaynak</label>
                            <div class="hata-adet-container">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                            </div>
                        </div>
                        <div class="hata-item">
                            <input type="checkbox" id="hata3" name="hatalar" value="Fazla kaynak">
                            <label for="hata3">Fazla kaynak</label>
                            <div class="hata-adet-container">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                            </div>
                        </div>
                        <div class="hata-item">
                            <input type="checkbox" id="hata4" name="hatalar" value="Bakır erimesi">
                            <label for="hata4">Bakır erimesi</label>
                            <div class="hata-adet-container">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                            </div>
                        </div>
                        <div class="hata-item">
                            <input type="checkbox" id="hata5" name="hatalar" value="Dışa kaynak akması">
                            <label for="hata5">Dışa kaynak akması</label>
                            <div class="hata-adet-container">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                            </div>
                        </div>
                        <div class="hata-item">
                            <input type="checkbox" id="hata6" name="hatalar" value="Vuruk">
                            <label for="hata6">Vuruk</label>
                            <div class="hata-adet-container">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                            </div>
                        </div>
                        <div class="hata-item">
                            <input type="checkbox" id="hata7" name="hatalar" value="Boğum uzunluğu farklılığı">
                            <label for="hata7">Boğum uzunluğu farklılığı</label>
                            <div class="hata-adet-container">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                            </div>
                        </div>
                        <div class="hata-item">
                            <input type="checkbox" id="hata8" name="hatalar" value="Boğum yamukluğu">
                            <label for="hata8">Boğum yamukluğu</label>
                            <div class="hata-adet-container">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                            </div>
                        </div>
                        <div class="hata-item">
                            <input type="checkbox" id="hata9" name="hatalar" value="Çizik ürün">
                            <label for="hata9">Çizik ürün</label>
                            <div class="hata-adet-container">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                            </div>
                        </div>
                        <div class="hata-item">
                            <input type="checkbox" id="hata10" name="hatalar" value="Temizlenememiş ürün">
                            <label for="hata10">Temizlenememiş ürün</label>
                            <div class="hata-adet-container">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                            </div>
                        </div>
                        <div class="hata-item">
                            <input type="checkbox" id="hata11" name="hatalar" value="Bilyeli ürün">
                            <label for="hata11">Bilyeli ürün</label>
                            <div class="hata-adet-container">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                            </div>
                        </div>
                        <div class="hata-item">
                            <input type="checkbox" id="hataDiger" name="hatalar" value="Diğer">
                            <label for="hataDiger">Diğer</label>
                            <div class="hata-adet-container">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                            </div>
                        </div>
                    </div>
                    <div id="digerHataDetay" style="display: none; margin-top: 15px;">
                        <label for="digerHataAciklama" style="display: block; margin-bottom: 5px; font-weight: bold;">Diğer Hata Açıklaması:</label>
                        <input type="text" id="digerHataAciklama" placeholder="Hata detayını yazın..." style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 6px;">
                    </div>
                </div>
                <button type="submit" class="btn">💾 Kalite Kontrol Kaydını Kaydet</button>
            </form>
            <div id="kaliteAlert"></div>
            <!-- Kalite Kontrol Kayıtları Tablosu -->
            <div id="kaliteKayitlari">
                <h3>📋 Kalite Kontrol Kayıtları</h3>
                <div id="kaliteKayitlariListesi"></div>
            </div>
        </div>
        
        <!-- Sipariş Hazırlığı Tab -->
        <div id="siparis-hazirlik" class="tab-content">
            <h2>📋 Sipariş Hazırlığı</h2>
            <!-- Sipariş Ekleme Formu -->
            <form id="siparisEkleForm">
                <h3>➕ Yeni Sipariş Ekle</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="hazirlikTarih">📅 Tarih</label>
                        <input type="date" id="hazirlikTarih" required>
                    </div>
                    <div class="form-group">
                        <label for="hazirlikOperator">👤 Operatör</label>
                        <select id="hazirlikOperator" required>
                            <option value="">Operatör seçin</option>
                            <option value="Esat">Esat</option>
                            <option value="Ahmet">Ahmet</option>
                            <option value="Emre">Emre</option>
                            <option value="Gökay">Gökay</option>
                            <option value="Berke">Berke</option>
                            <option value="Melisa">Melisa</option>
                            <option value="Evrim">Evrim</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="hazirlikSiparisNo">🏷️ Sipariş No</label>
                        <input type="text" id="hazirlikSiparisNo" placeholder="Sipariş numarası" required>
                    </div>
                    <div class="form-group">
                        <label for="urunKoduSiparis">📦 Ürün Kodu</label>
                        <input type="text" id="urunKoduSiparis" placeholder="Ürün kodu" required>
                    </div>
                    <div class="form-group">
                        <label for="siparisAdet">📊 Sipariş Adedi</label>
                        <input type="number" id="siparisAdet" min="1" placeholder="Toplam adet" required>
                    </div>
                </div>
                <button type="submit" class="btn">➕ Sipariş Ekle</button>
            </form>
            <div id="siparisEkleAlert"></div>
            <!-- Siparişler Listesi -->
            <div id="siparislerContainer">
                <h3>📋 Mevcut Siparişler</h3>
                <div id="siparislerListesi"></div>
            </div>
        </div>
        
        <!-- Stok Yönetimi Tab -->
        <div id="stok" class="tab-content">
            <h2>📦 Stok Yönetimi</h2>
            <!-- Stok Ekleme Formu -->
            <form id="stokForm">
                <h3>➕ Stok Ekle/Güncelle</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="stokMalzemeTuru">🔧 Malzeme Türü</label>
                        <select id="stokMalzemeTuru" required>
                            <option value="">Malzeme türünü seçin</option>
                            <option value="izolasyon">İzolasyon</option>
                            <option value="koli">Koli</option>
                            <option value="kutu">Kutu</option>
                            <option value="poset">Poşet</option>
                            <option value="tapa">Tapa</option>
                            <option value="etiket">Etiket</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="stokUrunAdi">📦 Ürün Adı</label>
                        <input type="text" id="stokUrunAdi" placeholder="Ürün adını yazın" required>
                    </div>
                    <div class="form-group">
                        <label for="stokOlculeri">📏 Ölçüler (İsteğe Bağlı)</label>
                        <input type="text" id="stokOlculeri" placeholder="Örn: 25x15x10 cm">
                    </div>
                    <div class="form-group">
                        <label for="stokMevcut">📊 Mevcut Adet</label>
                        <input type="number" id="stokMevcut" min="0" placeholder="Mevcut adet" required>
                    </div>
                    <div class="form-group">
                        <label for="stokEkleyen">👤 Verileri Ekleyen</label>
                        <select id="stokEkleyen" required>
                            <option value="">Kişi seçin</option>
                            <option value="Esat">Esat</option>
                            <option value="Ahmet">Ahmet</option>
                            <option value="Emre">Emre</option>
                            <option value="Gökay">Gökay</option>
                            <option value="Berke">Berke</option>
                            <option value="Melisa">Melisa</option>
                            <option value="Evrim">Evrim</option>
                        </select>
                    </div>
                </div>
                <div style="text-align: center; margin-top: 20px;">
                    <button type="submit" class="btn">💾 Stok Kaydet</button>
                    <button type="button" class="btn btn-success" onclick="temizleStokFormu()">🧹 Formu Temizle</button>
                </div>
            </form>
            <div id="stokAlert"></div>
            <!-- Stok Yönetim Butonları -->
            <div style="text-align: center; margin: 25px 0;">
                <button class="btn btn-success" onclick="tumStoklariYukle()">🔄 Stokları Yenile</button>
                <button class="btn btn-danger" onclick="tumStoklariSifirla()">🗑️ Tüm Stokları Sil</button>
            </div>
            <!-- Tüm Stoklar Özeti -->
            <div class="kaydedilmis-stoklar">
                <h3>📦 Tüm Stoklar Özeti</h3>
                <div id="stokOzeti"></div>
            </div>
            <!-- Stoklar Listesi -->
            <div id="stokListesiContainer">
                <h3>📋 Kayıtlı Stoklar</h3>
                <div id="stokListesi"></div>
            </div>
        </div>
        
        <!-- Temizlemeye Gidecek Ürünler Tab -->
        <div id="temizleme" class="tab-content">
            <h2>🧽 Temizlemeye Gidecek Ürünler</h2>
            <form id="temizlemeForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="temizlemeSiparisNo">🏷️ Sipariş No</label>
                        <input type="text" id="temizlemeSiparisNo" placeholder="Sipariş numarası" required>
                    </div>
                    <div class="form-group">
                        <label for="temizlemeUrunKodu">📦 Ürün Kodu</label>
                        <input type="text" id="temizlemeUrunKodu" placeholder="Ürün kodu" required>
                    </div>
                    <div class="form-group">
                        <label for="temizlemeSiparisAdet">📊 Sipariş Adeti</label>
                        <input type="number" id="temizlemeSiparisAdet" min="0" placeholder="Sipariş adeti" required>
                    </div>
                    <div class="form-group">
                        <label for="temizlemeGelenAdet">📦 Gelen Ürün Adeti</label>
                        <input type="number" id="temizlemeGelenAdet" min="0" placeholder="Gelen ürün adeti" required>
                    </div>
                    <div class="form-group">
                        <label for="temizlemeAdetKg">⚖️ Adet KG</label>
                        <input type="number" id="temizlemeAdetKg" step="0.01" min="0" placeholder="Adet kg" required>
                    </div>
                    <div class="form-group">
                        <label for="temizlemeToplamKg">⚖️ Toplam KG</label>
                        <input type="number" id="temizlemeToplamKg" step="0.01" min="0" placeholder="Toplam kg" required>
                    </div>
                    <div class="form-group">
                        <label for="temizlemeEkleyen">👤 Verileri Ekleyen</label>
                        <select id="temizlemeEkleyen" required>
                            <option value="">Kişi seçin</option>
                            <option value="Esat">Esat</option>
                            <option value="Ahmet">Ahmet</option>
                            <option value="Emre">Emre</option>
                            <option value="Gökay">Gökay</option>
                            <option value="Berke">Berke</option>
                            <option value="Melisa">Melisa</option>
                            <option value="Evrim">Evrim</option>
                        </select>
                    </div>
                </div>
                <button type="submit" class="btn">💾 Temizleme Kaydını Kaydet</button>
            </form>
            <div id="temizlemeAlert"></div>
            <div id="temizlemeListesi">
                <h3>📋 Temizlemeye Gidecek Ürünler Listesi</h3>
                <div id="temizlemeKayitlari"></div>
            </div>
        </div>
        
        <!-- Sevke Hazır Ürünler Tab -->
        <div id="sevke-hazir" class="tab-content">
            <h2>📤 Sevke Hazır Ürünler</h2>
            <form id="sevkeHazirForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="sevkeSiparisNo">🏷️ Sipariş No</label>
                        <input type="text" id="sevkeSiparisNo" placeholder="Sipariş numarası" required>
                    </div>
                    <div class="form-group">
                        <label for="sevkeUrunNo">📦 Ürün No</label>
                        <input type="text" id="sevkeUrunNo" placeholder="Ürün numarası" required>
                    </div>
                    <div class="form-group">
                        <label for="sevkeHazirAdet">📊 Sevke Hazır Ürün Adeti</label>
                        <input type="number" id="sevkeHazirAdet" min="0" placeholder="Sevke hazır adet" required>
                    </div>
                    <div class="form-group">
                        <label for="sevkeKoliAdet">📦 Koli Adeti</label>
                        <input type="number" id="sevkeKoliAdet" min="0" placeholder="Koli adeti" required>
                    </div>
                    <div class="form-group">
                        <label for="sevkeHazirEkleyen">👤 Verileri Ekleyen</label>
                        <select id="sevkeHazirEkleyen" required>
                            <option value="">Kişi seçin</option>
                            <option value="Esat">Esat</option>
                            <option value="Ahmet">Ahmet</option>
                            <option value="Emre">Emre</option>
                            <option value="Gökay">Gökay</option>
                            <option value="Berke">Berke</option>
                            <option value="Melisa">Melisa</option>
                            <option value="Evrim">Evrim</option>
                        </select>
                    </div>
                </div>
                <button type="submit" class="btn">💾 Sevke Hazır Kaydını Kaydet</button>
            </form>
            <div id="sevkeHazirAlert"></div>
            <div id="sevkeHazirListesi">
                <h3>📋 Sevke Hazır Ürünler Listesi</h3>
                <div id="sevkeHazirKayitlari"></div>
            </div>
        </div>
        
        <!-- Sevk Edilen Ürünler Tab -->
        <div id="sevk-edilen" class="tab-content">
            <h2>🚚 Sevk Edilen Ürün Listesi</h2>
            <form id="sevkEdilenForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="sevkSiparisNo">🏷️ Sipariş No</label>
                        <input type="text" id="sevkSiparisNo" placeholder="Sipariş numarası" required>
                    </div>
                    <div class="form-group">
                        <label for="sevkUrunTuru">📦 Ürün Türü</label>
                        <input type="text" id="sevkUrunTuru" placeholder="Ürün türü" required>
                    </div>
                    <div class="form-group">
                        <label for="sevkUrunNo">📦 Ürün No</label>
                        <input type="text" id="sevkUrunNo" placeholder="Ürün numarası" required>
                    </div>
                    <div class="form-group">
                        <label for="sevkTeslimTarih">📅 Teslim Edilen Tarih</label>
                        <input type="date" id="sevkTeslimTarih" required>
                    </div>
                    <div class="form-group">
                        <label for="sevkTeslimAdet">📊 Teslim Edilen Adet</label>
                        <input type="number" id="sevkTeslimAdet" min="0" placeholder="Teslim edilen adet" required>
                    </div>
                    <div class="form-group">
                        <label for="sevkTeslimAlan">👤 Teslim Alan</label>
                        <input type="text" id="sevkTeslimAlan" placeholder="Teslim alan kişi" required>
                    </div>
                    <div class="form-group">
                        <label for="sevkDepoIrsaliye">📋 Depo Giriş İrsaliyesi</label>
                        <input type="text" id="sevkDepoIrsaliye" placeholder="İrsaliye numarası" required>
                    </div>
                    <div class="form-group">
                        <label for="sevkEdilenEkleyen">👤 Verileri Ekleyen</label>
                        <select id="sevkEdilenEkleyen" required>
                            <option value="">Kişi seçin</option>
                            <option value="Esat">Esat</option>
                            <option value="Ahmet">Ahmet</option>
                            <option value="Emre">Emre</option>
                            <option value="Gökay">Gökay</option>
                            <option value="Berke">Berke</option>
                            <option value="Melisa">Melisa</option>
                            <option value="Evrim">Evrim</option>
                        </select>
                    </div>
                </div>
                <button type="submit" class="btn">💾 Sevk Kaydını Kaydet</button>
            </form>
            <div id="sevkEdilenAlert"></div>
            <div id="sevkEdilenListesi">
                <h3>📋 Sevk Edilen Ürünler Listesi</h3>
                <div id="sevkEdilenKayitlari"></div>
            </div>
        </div>
        
        <!-- Yarı Mamül Stok Tab -->
        <div id="yari-mamul" class="tab-content">
            <h2>🔧 Yarı Mamül Stok</h2>
            <form id="yariMamulForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="yariMamulUrunAdi">📦 Ürün Adı</label>
                        <input type="text" id="yariMamulUrunAdi" placeholder="Ürün adını yazın" required>
                    </div>
                    <div class="form-group">
                        <label for="yariMamulAdet">📊 Adeti</label>
                        <input type="number" id="yariMamulAdet" min="0" placeholder="Adet" required>
                    </div>
                    <div class="form-group">
                        <label for="yariMamulHangiParca">🔧 Hangi Parça</label>
                        <input type="text" id="yariMamulHangiParca" placeholder="Parça bilgisi" required>
                    </div>
                    <div class="form-group">
                        <label for="yariMamulNot">📝 Not</label>
                        <textarea id="yariMamulNot" rows="3" placeholder="Not yazın..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="yariMamulEkleyen">👤 Verileri Ekleyen</label>
                        <select id="yariMamulEkleyen" required>
                            <option value="">Kişi seçin</option>
                            <option value="Esat">Esat</option>
                            <option value="Ahmet">Ahmet</option>
                            <option value="Emre">Emre</option>
                            <option value="Gökay">Gökay</option>
                            <option value="Berke">Berke</option>
                            <option value="Melisa">Melisa</option>
                            <option value="Evrim">Evrim</option>
                        </select>
                    </div>
                </div>
                <button type="submit" class="btn">💾 Yarı Mamül Kaydını Kaydet</button>
            </form>
            <div id="yariMamulAlert"></div>
            <div id="yariMamulListesi">
                <h3>📋 Yarı Mamül Stok Listesi</h3>
                <div id="yariMamulKayitlari"></div>
            </div>
        </div>
        
        <!-- Günlük Performans Tab -->
        <div id="gunluk-performans" class="tab-content">
            <h2>⚡ Günlük Performans Takibi</h2>
            <form id="performansForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="performansTarih">📅 Tarih</label>
                        <input type="date" id="performansTarih" required>
                    </div>
                    <div class="form-group">
                        <label for="performansCalisan">👤 Çalışan Adı</label>
                        <select id="performansCalisan" required>
                            <option value="">Çalışan seçin</option>
                            <option value="Esat">Esat</option>
                            <option value="Ahmet">Ahmet</option>
                            <option value="Emre">Emre</option>
                            <option value="Gökay">Gökay</option>
                            <option value="Berke">Berke</option>
                            <option value="Melisa">Melisa</option>
                            <option value="Evrim">Evrim</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="performansEkleyen">👤 Verileri Ekleyen</label>
                        <select id="performansEkleyen" required>
                            <option value="">Kişi seçin</option>
                            <option value="Esat">Esat</option>
                            <option value="Ahmet">Ahmet</option>
                            <option value="Emre">Emre</option>
                            <option value="Gökay">Gökay</option>
                            <option value="Berke">Berke</option>
                            <option value="Melisa">Melisa</option>
                            <option value="Evrim">Evrim</option>
                        </select>
                    </div>
                </div>
                <div class="hata-container">
                    <h3>🏭 İşlem Performansları</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <h4>📦 Kutu Hazırlığı</h4>
                            <input type="text" id="kutuHazirlikUrun" placeholder="Ürün adı">
                            <input type="number" id="kutuHazirlikAdet" placeholder="Adet" min="0">
                            <input type="number" id="kutuHazirlikSure" placeholder="Süre (dk)" min="0">
                        </div>
                        <div class="form-group">
                            <h4>📋 Koli Hazırlama</h4>
                            <input type="text" id="koliHazirlamaUrun" placeholder="Ürün adı">
                            <input type="number" id="koliHazirlamaAdet" placeholder="Adet" min="0">
                            <input type="number" id="koliHazirlamaSure" placeholder="Süre (dk)" min="0">
                        </div>
                        <div class="form-group">
                            <h4>🔧 İzolasyon</h4>
                            <input type="text" id="izolasyonUrunPerf" placeholder="Ürün adı">
                            <input type="number" id="izolasyonAdetPerf" placeholder="Adet" min="0">
                            <input type="number" id="izolasyonSure" placeholder="Süre (dk)" min="0">
                        </div>
                        <div class="form-group">
                            <h4>🔍 Kalite Kontrol</h4>
                            <input type="text" id="kaliteKontrolUrun" placeholder="Ürün adı">
                            <input type="number" id="kaliteKontrolAdet" placeholder="Adet" min="0">
                            <input type="number" id="kaliteKontrolSure" placeholder="Süre (dk)" min="0">
                        </div>
                        <div class="form-group">
                            <h4>🛍️ Poşetleme</h4>
                            <input type="text" id="posetlemeUrunPerf" placeholder="Ürün adı">
                            <input type="number" id="posetlemeAdetPerf" placeholder="Adet" min="0">
                            <input type="number" id="posetlemeSure" placeholder="Süre (dk)" min="0">
                        </div>
                        <div class="form-group">
                            <h4>📦 Ürün Kutulama</h4>
                            <input type="text" id="urunKutulamaUrun" placeholder="Ürün adı">
                            <input type="number" id="urunKutulamaAdet" placeholder="Adet" min="0">
                            <input type="number" id="urunKutulamaSure" placeholder="Süre (dk)" min="0">
                        </div>
                        <div class="form-group">
                            <h4>🔩 Ek Parça</h4>
                            <input type="text" id="ekParcaUrunPerf" placeholder="Ürün adı">
                            <input type="number" id="ekParcaAdetPerf" placeholder="Adet" min="0">
                            <input type="number" id="ekParcaSure" placeholder="Süre (dk)" min="0">
                        </div>
                    </div>
                </div>
                <button type="submit" class="btn">💾 Performans Kaydını Kaydet</button>
            </form>
            <div id="performansAlert"></div>
            <!-- Son Performans Kayıtları -->
            <div id="performansKayitlariContainer">
                <h3>📊 Son Performans Kayıtları</h3>
                <div id="performansKayitlariListesi"></div>
            </div>
        </div>
        
        <!-- İstatistikler Tab -->
        <div id="istatistikler" class="tab-content">
            <h2>📈 İstatistikler</h2>
            <div class="stats-grid">
                <div class="stat-card">
                    <h3 id="toplamKaliteKayit">0</h3>
                    <p>Toplam Kalite Kontrol</p>
                </div>
                <div class="stat-card">
                    <h3 id="toplamSiparisKayit">0</h3>
                    <p>Toplam Sipariş</p>
                </div>
                <div class="stat-card">
                    <h3 id="toplamPerformansKayit">0</h3>
                    <p>Toplam Performans</p>
                </div>
                <div class="stat-card">
                    <h3 id="tamamlananSiparis">0</h3>
                    <p>Tamamlanan Sipariş</p>
                </div>
                <div class="stat-card">
                    <h3 id="toplamHataAdet">0</h3>
                    <p>Toplam Hatalı Ürün</p>
                </div>
                <div class="stat-card">
                    <h3 id="basariOrani">0%</h3>
                    <p>Başarı Oranı</p>
                </div>
            </div>
            <div style="background: white; padding: 25px; border-radius: 10px; border: 2px solid #e9ecef; margin-bottom: 20px;">
                <h4 style="color: #2c3e50; margin-bottom: 15px; text-align: center; background: linear-gradient(135deg, #3498db, #2980b9); color: white; padding: 12px; border-radius: 6px;">📊 Hata İstatistikleri</h4>
                <div id="hataIstatistikleri"></div>
            </div>
            <div style="background: white; padding: 25px; border-radius: 10px; border: 2px solid #e9ecef; margin-bottom: 20px;">
                <h4 style="color: #2c3e50; margin-bottom: 15px; text-align: center; background: linear-gradient(135deg, #3498db, #2980b9); color: white; padding: 12px; border-radius: 6px;">⏱️ Performans İstatistikleri</h4>
                <div id="performansIstatistikleri"></div>
            </div>
            <div style="background: white; padding: 25px; border-radius: 10px; border: 2px solid #e9ecef; margin-bottom: 20px;">
                <h4 style="color: #2c3e50; margin-bottom: 15px; text-align: center; background: linear-gradient(135deg, #3498db, #2980b9); color: white; padding: 12px; border-radius: 6px;">👥 Çalışan Bazlı İstatistikler</h4>
                <div id="calisanIstatistikleri"></div>
            </div>
        </div>
        
        <!-- Veri Görüntüle Tab -->
        <div id="veri-goruntule" class="tab-content">
            <h2>📊 Veri Görüntüle</h2>
            <div class="form-grid" style="margin-bottom: 20px;">
                <div class="form-group">
                    <label for="veriTuru">🔍 Veri Türü</label>
                    <select id="veriTuru" onchange="loadVeriTablosu()">
                        <option value="kalite">Kalite Kontrol Verileri</option>
                        <option value="siparis">Sipariş Hazırlık Verileri</option>
                        <option value="performans">Performans Verileri</option>
                        <option value="stok">Stok Verileri</option>
                        <option value="temizleme">Temizleme Verileri</option>
                        <option value="sevkeHazir">Sevke Hazır Verileri</option>
                        <option value="sevkEdilen">Sevk Edilen Verileri</option>
                        <option value="yariMamul">Yarı Mamül Stok Verileri</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="tarihFiltre">📅 Tarih Filtresi</label>
                    <select id="tarihFiltre" onchange="loadVeriTablosu()">
                        <option value="hepsi">Tüm Tarihler</option>
                        <option value="bugun">Bugün</option>
                        <option value="bu-hafta">Bu Hafta</option>
                        <option value="bu-ay">Bu Ay</option>
                    </select>
                </div>
            </div>
            <div id="veriTablosuContainer"></div>
            <div style="margin-top: 20px; text-align: center;">
                <button class="btn" onclick="exportCurrentData()">📥 Görüntülenen Verileri Excel'e Aktar</button>
            </div>
        </div>
        
        <!-- Raporlar Tab -->
        <div id="raporlar" class="tab-content">
            <h2>📋 Raporlar</h2>
            <div class="stats-grid">
                <div class="stat-card">
                                        <h3 id="toplamKayit">0</h3>
                    <p>Toplam Kalite Kontrol Kaydı</p>
                </div>
                <div class="stat-card">
                    <h3 id="toplamSiparis">0</h3>
                    <p>Sipariş Hazırlık Kaydı</p>
                </div>
                <div class="stat-card">
                    <h3 id="toplamPerformans">0</h3>
                    <p>Performans Kaydı</p>
                </div>
                <div class="stat-card">
                    <h3 id="stokSayisi">0</h3>
                    <p>Stok Kalemi</p>
                </div>
            </div>
            <div style="margin-top: 30px;">
                <button class="btn" onclick="exportToExcel('kalite')">📥 Kalite Verilerini Excel'e Aktar</button>
                <button class="btn btn-success" onclick="exportToExcel('performans')">📥 Performans Verilerini Excel'e Aktar</button>
                <button class="btn" onclick="exportToExcel('siparis')">📥 Sipariş Verilerini Excel'e Aktar</button>
                <button class="btn btn-danger" onclick="exportToExcel('hepsi')">📥 Tüm Verileri Excel'e Aktar</button>
            </div>
        </div>
        
        <!-- Ayarlar Tab -->
        <div id="ayarlar" class="tab-content">
            <h2>⚙️ Sistem Ayarları</h2>
            <div class="form-grid">
                <div class="form-group">
                    <label>💾 Veri Yedekleme</label>
                    <button class="btn" onclick="exportAllData()">Tüm Verileri Yedekle (JSON)</button>
                </div>
                <div class="form-group">
                    <label>📤 Veri Geri Yükleme</label>
                    <input type="file" id="importFile" accept=".json" onchange="importData()">
                </div>
                <div class="form-group">
                    <label>🗑️ Veri Temizleme</label>
                    <button class="btn btn-danger" onclick="clearAllData()">Tüm Verileri Temizle</button>
                </div>
            </div>
        </div>
        
        <!-- Modal for Editing -->
        <div id="editModal" style="display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5);">
            <div style="background-color: white; margin: 5% auto; padding: 20px; border-radius: 10px; width: 90%; max-width: 800px; max-height: 80vh; overflow-y: auto;">
                <span style="color: #aaa; float: right; font-size: 28px; font-weight: bold; cursor: pointer;" onclick="document.getElementById('editModal').style.display='none'">&times;</span>
                <h3>✏️ Düzenle</h3>
                <div id="editFormContainer"></div>
            </div>
        </div>
    </div>

    <!-- Firebase SDK'ları -->
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getFirestore, collection, addDoc, getDocs, updateDoc, deleteDoc, doc, onSnapshot, orderBy, query, where } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
        import { getAnalytics } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-analytics.js';

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBuUG9u2vV_dV7zCWd4AjNBLk7wY0QLtMU",
            authDomain: "akg-kalite-kontrol.firebaseapp.com",
            projectId: "akg-kalite-kontrol",
            storageBucket: "akg-kalite-kontrol.firebasestorage.app",
            messagingSenderId: "1071081516456",
            appId: "1:1071081516456:web:0be7b69f2b6b4f5f37f30a"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const db = getFirestore(app);

        // Firebase bağlantı durumu
        let isFirebaseConnected = false;
        const firebaseStatusElement = document.getElementById('firebaseStatus');

        function updateFirebaseStatus(connected) {
            isFirebaseConnected = connected;
            if (connected) {
                firebaseStatusElement.textContent = '🟢 Firebase: Bağlı';
                firebaseStatusElement.className = 'firebase-status firebase-connected';
            } else {
                firebaseStatusElement.textContent = '🔴 Firebase: Bağlantı Kesildi';
                firebaseStatusElement.className = 'firebase-status firebase-disconnected';
            }
        }

        // Firebase bağlantı testi
        async function testFirebaseConnection() {
            try {
                const testCollection = collection(db, 'connectionTest');
                await getDocs(testCollection);
                updateFirebaseStatus(true);
                console.log('✅ Firebase bağlantısı başarılı!');
                
                // Real-time listeners'ı başlat
                setupFirebaseListeners();
                
                // LocalStorage verilerini Firebase'e migrate et (sadece ilk kez)
                const migrated = localStorage.getItem('firebaseMigrated');
                if (!migrated) {
                    await migrateLocalStorageToFirebase();
                    localStorage.setItem('firebaseMigrated', 'true');
                }
                
            } catch (error) {
                updateFirebaseStatus(false);
                console.error('❌ Firebase bağlantı hatası:', error);
                
                // Firebase bağlantısı yoksa localStorage kullanmaya devam et
                initializeLocalStorage();
            }
        }

        // LocalStorage verilerini Firebase'e taşı
        async function migrateLocalStorageToFirebase() {
            try {
                console.log('🔄 LocalStorage verilerini Firebase\'e aktarılıyor...');

                const collections = [
                    'kaliteKayitlari', 'siparisHazirlikKayitlari', 'performansKayitlari', 
                    'stokKayitlari', 'temizlemeKayitlari', 'sevkeHazirKayitlari', 
                    'sevkEdilenKayitlari', 'yariMamulKayitlari'
                ];

                for (const collectionName of collections) {
                    const localData = JSON.parse(localStorage.getItem(collectionName) || '[]');
                    if (localData.length > 0) {
                        // Firebase'de bu koleksiyonda kayıt var mı kontrol et
                        const existingDocs = await getDocs(collection(db, collectionName));
                        
                        if (existingDocs.empty) {
                            // Sadece koleksiyon boşsa migrate et
                            for (const kayit of localData) {
                                const { id, ...dataWithoutId } = kayit;
                                await addDoc(collection(db, collectionName), dataWithoutId);
                            }
                            console.log(`✅ ${localData.length} ${collectionName} kaydı Firebase'e aktarıldı`);
                        } else {
                            console.log(`ℹ️ ${collectionName} Firebase'de zaten mevcut, atlaniyor`);
                        }
                    }
                }

                console.log('🎉 Veri migrasyonu tamamlandı!');
                
            } catch (error) {
                console.error('❌ Veri aktarma hatası:', error);
            }
        }

        // Firebase real-time listeners
        function setupFirebaseListeners() {
            // Kalite kontrol verilerini dinle
            onSnapshot(query(collection(db, 'kaliteKayitlari'), orderBy('tarih', 'desc')), (snapshot) => {
                window.kaliteKayitlari = [];
                snapshot.forEach((doc) => {
                    window.kaliteKayitlari.push({ firebaseId: doc.id, id: Date.now() + Math.random(), ...doc.data() });
                });
                if (typeof window.loadKaliteKayitlari === 'function') {
                    window.loadKaliteKayitlari();
                }
                if (typeof window.loadStats === 'function') {
                    window.loadStats();
                }
            });

            // Sipariş verilerini dinle
            onSnapshot(collection(db, 'siparisHazirlikKayitlari'), (snapshot) => {
                window.siparisHazirlikKayitlari = [];
                snapshot.forEach((doc) => {
                    window.siparisHazirlikKayitlari.push({ firebaseId: doc.id, id: Date.now() + Math.random(), ...doc.data() });
                });
                if (typeof window.loadSiparislerListesi === 'function') {
                    window.loadSiparislerListesi();
                }
                if (typeof window.loadStats === 'function') {
                    window.loadStats();
                }
            });

            // Performans verilerini dinle
            onSnapshot(query(collection(db, 'performansKayitlari'), orderBy('tarih', 'desc')), (snapshot) => {
                window.performansKayitlari = [];
                snapshot.forEach((doc) => {
                    window.performansKayitlari.push({ firebaseId: doc.id, id: Date.now() + Math.random(), ...doc.data() });
                });
                if (typeof window.loadPerformansKayitlari === 'function') {
                    window.loadPerformansKayitlari();
                }
            });

            // Stok verilerini dinle
            onSnapshot(collection(db, 'stokKayitlari'), (snapshot) => {
                window.stokKayitlari = [];
                snapshot.forEach((doc) => {
                    window.stokKayitlari.push({ firebaseId: doc.id, id: Date.now() + Math.random(), ...doc.data() });
                });
                if (typeof window.loadStokListesi === 'function') {
                    window.loadStokListesi();
                }
                if (typeof window.tumStoklariOzetGoster === 'function') {
                    window.tumStoklariOzetGoster();
                }
            });

            // Diğer koleksiyonları dinle
            const otherCollections = [
                { name: 'temizlemeKayitlari', variable: 'temizlemeKayitlari', loader: 'loadTemizlemeKayitlari' },
                { name: 'sevkeHazirKayitlari', variable: 'sevkeHazirKayitlari', loader: 'loadSevkeHazirKayitlari' },
                { name: 'sevkEdilenKayitlari', variable: 'sevkEdilenKayitlari', loader: 'loadSevkEdilenKayitlari' },
                { name: 'yariMamulKayitlari', variable: 'yariMamulKayitlari', loader: 'loadYariMamulKayitlari' }
            ];

            otherCollections.forEach(({ name, variable, loader }) => {
                onSnapshot(collection(db, name), (snapshot) => {
                    window[variable] = [];
                    snapshot.forEach((doc) => {
                        window[variable].push({ firebaseId: doc.id, id: Date.now() + Math.random(), ...doc.data() });
                    });
                    if (typeof window[loader] === 'function') {
                        window[loader]();
                    }
                });
            });
        }

        // LocalStorage initialization (Firebase bağlantısı yoksa)
        function initializeLocalStorage() {
            console.log('📱 LocalStorage modu aktif');
            window.kaliteKayitlari = JSON.parse(localStorage.getItem('kaliteKayitlari') || '[]');
            window.siparisHazirlikKayitlari = JSON.parse(localStorage.getItem('siparisHazirlikKayitlari') || '[]');
            window.performansKayitlari = JSON.parse(localStorage.getItem('performansKayitlari') || '[]');
            window.stokKayitlari = JSON.parse(localStorage.getItem('stokKayitlari') || '[]');
            window.temizlemeKayitlari = JSON.parse(localStorage.getItem('temizlemeKayitlari') || '[]');
            window.sevkeHazirKayitlari = JSON.parse(localStorage.getItem('sevkeHazirKayitlari') || '[]');
            window.sevkEdilenKayitlari = JSON.parse(localStorage.getItem('sevkEdilenKayitlari') || '[]');
            window.yariMamulKayitlari = JSON.parse(localStorage.getItem('yariMamulKayitlari') || '[]');
        }

        // Firebase'e veri kaydetme fonksiyonları
        window.saveToFirebase = async function(collectionName, data) {
            if (!isFirebaseConnected) {
                console.log('Firebase bağlantısı yok, localStorage\'a kaydediliyor');
                return saveToLocalStorage(collectionName, data);
            }

            try {
                const { id, ...dataWithoutId } = data;
                const docRef = await addDoc(collection(db, collectionName), dataWithoutId);
                console.log(`✅ ${collectionName} Firebase'e kaydedildi:`, docRef.id);
                return docRef.id;
            } catch (error) {
                console.error(`❌ Firebase kaydetme hatası (${collectionName}):`, error);
                // Hata durumunda localStorage'a kaydet
                return saveToLocalStorage(collectionName, data);
            }
        };

        // Firebase'den veri silme
        window.deleteFromFirebase = async function(collectionName, firebaseId, localId) {
            if (!isFirebaseConnected || !firebaseId) {
                return deleteFromLocalStorage(collectionName, localId);
            }

            try {
                await deleteDoc(doc(db, collectionName, firebaseId));
                console.log(`✅ ${collectionName} Firebase'den silindi:`, firebaseId);
            } catch (error) {
                console.error(`❌ Firebase silme hatası (${collectionName}):`, error);
                return deleteFromLocalStorage(collectionName, localId);
            }
        };

        // Firebase'de veri güncelleme
        window.updateInFirebase = async function(collectionName, firebaseId, updateData) {
            if (!isFirebaseConnected || !firebaseId) {
                return updateInLocalStorage(collectionName, updateData);
            }

            try {
                const docRef = doc(db, collectionName, firebaseId);
                const { id, firebaseId: fbId, ...cleanData } = updateData;
                await updateDoc(docRef, cleanData);
                console.log(`✅ ${collectionName} Firebase'de güncellendi:`, firebaseId);
            } catch (error) {
                console.error(`❌ Firebase güncelleme hatası (${collectionName}):`, error);
                return updateInLocalStorage(collectionName, updateData);
            }
        };

        // LocalStorage fallback fonksiyonları
        function saveToLocalStorage(collectionName, data) {
            const localData = JSON.parse(localStorage.getItem(collectionName) || '[]');
            localData.push(data);
            localStorage.setItem(collectionName, JSON.stringify(localData));
            return data.id;
        }

        function deleteFromLocalStorage(collectionName, localId) {
            const localData = JSON.parse(localStorage.getItem(collectionName) || '[]');
            const filteredData = localData.filter(item => item.id !== localId);
            localStorage.setItem(collectionName, JSON.stringify(filteredData));
        }

        function updateInLocalStorage(collectionName, data) {
            const localData = JSON.parse(localStorage.getItem(collectionName) || '[]');
            const index = localData.findIndex(item => item.id === data.id);
            if (index !== -1) {
                localData[index] = data;
                localStorage.setItem(collectionName, JSON.stringify(localData));
            }
        }

        // Global değişkenleri window objesine ekle
        window.kaliteKayitlari = [];
        window.siparisHazirlikKayitlari = [];
        window.performansKayitlari = [];
        window.stokKayitlari = [];
        window.temizlemeKayitlari = [];
        window.sevkeHazirKayitlari = [];
        window.sevkEdilenKayitlari = [];
        window.yariMamulKayitlari = [];

        // Firebase bağlantısını test et
        testFirebaseConnection();

        // Sayfa yüklendiğinde Firebase bağlantı durumunu kontrol et
        setInterval(() => {
            if (!isFirebaseConnected) {
                testFirebaseConnection();
            }
        }, 30000); // 30 saniyede bir kontrol et
    </script>

    <!-- Ana JavaScript kodları -->
    <script>
        // Sayfa yüklendiğinde
        document.addEventListener('DOMContentLoaded', function() {
            const now = new Date();
            const nowString = now.toISOString().slice(0, 16);
            const today = now.toISOString().slice(0, 10);
            
            document.getElementById('tarih').value = nowString;
            document.getElementById('hazirlikTarih').value = today;
            document.getElementById('performansTarih').value = today;
            document.getElementById('sevkTeslimTarih').value = today;

            // Form event listeners
            document.getElementById('kaliteForm').addEventListener('submit', kaliteFormSubmit);
            document.getElementById('siparisEkleForm').addEventListener('submit', siparisEkleFormSubmit);
            document.getElementById('performansForm').addEventListener('submit', performansFormSubmit);
            document.getElementById('stokForm').addEventListener('submit', stokEkleGuncelle);
            document.getElementById('temizlemeForm').addEventListener('submit', temizlemeEkle);
            document.getElementById('sevkeHazirForm').addEventListener('submit', sevkeHazirEkle);
            document.getElementById('sevkEdilenForm').addEventListener('submit', sevkEdilenEkle);
            document.getElementById('yariMamulForm').addEventListener('submit', yariMamulEkle);
            
            // Diğer hata checkbox'ı için listener
            document.getElementById('hataDiger').addEventListener('change', function() {
                const digerDetay = document.getElementById('digerHataDetay');
                digerDetay.style.display = this.checked ? 'block' : 'none';
            });
            
            // İlk yüklemede verileri göster (2 saniye bekle Firebase bağlantısı için)
            setTimeout(() => {
                loadStats();
                loadStokListesi();
                loadKaliteKayitlari();
                loadSiparislerListesi();
                loadIstatistikler();
                loadVeriTablosu();
                tumStoklariOzetGoster();
                loadTemizlemeKayitlari();
                loadSevkeHazirKayitlari();
                loadSevkEdilenKayitlari();
                loadYariMamulKayitlari();
                loadPerformansKayitlari();
            }, 2000);
        });

        // Firebase entegrasyonu ile güncellenmiş form submit fonksiyonları
        async function kaliteFormSubmit(e) {
            e.preventDefault();
            
            const formData = {
                id: Date.now(),
                tarih: document.getElementById('tarih').value,
                operator: document.getElementById('operator').value,
                urunKodu: document.getElementById('urunKodu').value.trim(),
                toplamAdet: parseInt(document.getElementById('toplamAdet').value),
                siparisNo: document.getElementById('siparisNo').value.trim(),
                hatalar: []
            };
            
            // Seçili hataları topla
            const hataCheckboxes = document.querySelectorAll('input[name="hatalar"]:checked');
            hataCheckboxes.forEach(checkbox => {
                const hataItem = checkbox.closest('.hata-item');
                const hataAdetInputs = hataItem.querySelectorAll('.hata-adet');
                const iskartaAdet = parseInt(hataAdetInputs[0].value) || 0;
                const geriGidenAdet = parseInt(hataAdetInputs[1].value) || 0;
                
                if (iskartaAdet > 0 || geriGidenAdet > 0) {
                    let hataTuru = checkbox.value;
                    if (hataTuru === 'Diğer') {
                        const digerAciklama = document.getElementById('digerHataAciklama').value.trim();
                        if (digerAciklama) {
                            hataTuru = `Diğer: ${digerAciklama}`;
                        }
                    }
                    formData.hatalar.push({
                        tur: hataTuru,
                        iskartaAdet: iskartaAdet,
                        geriGidenAdet: geriGidenAdet
                    });
                }
            });
            
            if (formData.hatalar.length === 0) {
                showAlert('kaliteAlert', 'Lütfen en az bir hata türü seçin ve adetlerini girin!', 'error');
                return;
            }
            
            // Firebase'e kaydet
            await saveToFirebase('kaliteKayitlari', formData);
            
            // Form temizle
            document.getElementById('kaliteForm').reset();
            const now = new Date().toISOString().slice(0, 16);
            document.getElementById('tarih').value = now;
            document.getElementById('digerHataDetay').style.display = 'none';
            
            showAlert('kaliteAlert', 'Kalite kontrol kaydı başarıyla kaydedildi!', 'success');
        }

        async function siparisEkleFormSubmit(e) {
            e.preventDefault();
            
            const formData = {
                id: Date.now(),
                tarih: document.getElementById('hazirlikTarih').value,
                operator: document.getElementById('hazirlikOperator').value,
                siparisNo: document.getElementById('hazirlikSiparisNo').value.trim(),
                urunKodu: document.getElementById('urunKoduSiparis').value.trim(),
                siparisAdet: parseInt(document.getElementById('siparisAdet').value),
                durum: 'hazirlanıyor',
                olusturmaTarihi: new Date().toISOString(),
                checkboxDurum: {
                    koli: false,
                    kutu: false,
                    izolasyon: false,
                    etiket: false,
                    posetMevcut: false,
                    tapaMevcut: false
                }
            };
            
            await saveToFirebase('siparisHazirlikKayitlari', formData);
            
            // Form temizle
            document.getElementById('siparisEkleForm').reset();
            const today = new Date().toISOString().slice(0, 10);
            document.getElementById('hazirlikTarih').value = today;
            
            showAlert('siparisEkleAlert', 'Sipariş başarıyla eklendi!', 'success');
        }

        async function performansFormSubmit(e) {
            e.preventDefault();
            
            const performansData = {
                id: Date.now(),
                tarih: document.getElementById('performansTarih').value,
                calisan: document.getElementById('performansCalisan').value,
                ekleyen: document.getElementById('performansEkleyen').value,
                islemler: []
            };
            
            // İşlem verilerini topla
            const islemler = [
                { ad: 'Kutu Hazırlığı', urun: 'kutuHazirlikUrun', adet: 'kutuHazirlikAdet', sure: 'kutuHazirlikSure' },
                { ad: 'Koli Hazırlama', urun: 'koliHazirlamaUrun', adet: 'koliHazirlamaAdet', sure: 'koliHazirlamaSure' },
                { ad: 'İzolasyon', urun: 'izolasyonUrunPerf', adet: 'izolasyonAdetPerf', sure: 'izolasyonSure' },
                { ad: 'Kalite Kontrol', urun: 'kaliteKontrolUrun', adet: 'kaliteKontrolAdet', sure: 'kaliteKontrolSure' },
                { ad: 'Poşetleme', urun: 'posetlemeUrunPerf', adet: 'posetlemeAdetPerf', sure: 'posetlemeSure' },
                { ad: 'Ürün Kutulama', urun: 'urunKutulamaUrun', adet: 'urunKutulamaAdet', sure: 'urunKutulamaSure' },
                { ad: 'Ek Parça', urun: 'ekParcaUrunPerf', adet: 'ekParcaAdetPerf', sure: 'ekParcaSure' }
            ];
            
            islemler.forEach(islem => {
                const urun = document.getElementById(islem.urun).value.trim();
                const adet = parseInt(document.getElementById(islem.adet).value) || 0;
                const sure = parseInt(document.getElementById(islem.sure).value) || 0;
                
                if (urun && adet > 0 && sure > 0) {
                    performansData.islemler.push({
                        ad: islem.ad,
                        urun: urun,
                        adet: adet,
                        sure: sure,
                        hiz: Math.round((adet / sure) * 60 * 100) / 100
                    });
                }
            });
            
            if (performansData.islemler.length === 0) {
                showAlert('performansAlert', 'Lütfen en az bir işlem performansı girin!', 'error');
                return;
            }
            
            await saveToFirebase('performansKayitlari', performansData);
            
            document.getElementById('performansForm').reset();
            const today = new Date().toISOString().slice(0, 10);
            document.getElementById('performansTarih').value = today;
            
            showAlert('performansAlert', 'Performans kaydı başarıyla kaydedildi!', 'success');
        }

        // Temizleme kayıtları fonksiyonları
        async function temizlemeEkle(e) {
            e.preventDefault();
            const formData = {
                id: Date.now(),
                siparisNo: document.getElementById('temizlemeSiparisNo').value.trim(),
                urunKodu: document.getElementById('temizlemeUrunKodu').value.trim(),
                siparisAdet: parseInt(document.getElementById('temizlemeSiparisAdet').value) || 0,
                gelenAdet: parseInt(document.getElementById('temizlemeGelenAdet').value) || 0,
                adetKg: parseFloat(document.getElementById('temizlemeAdetKg').value) || 0,
                toplamKg: parseFloat(document.getElementById('temizlemeToplamKg').value) || 0,
                ekleyen: document.getElementById('temizlemeEkleyen').value,
                tarih: new Date().toISOString()
            };
            
            await saveToFirebase('temizlemeKayitlari', formData);
            document.getElementById('temizlemeForm').reset();
            showAlert('temizlemeAlert', 'Temizleme kaydı başarıyla eklendi!', 'success');
        }

        function loadTemizlemeKayitlari() {
            const container = document.getElementById('temizlemeKayitlari');
            if (!container) return;
            
            if (temizlemeKayitlari.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #666; padding: 20px;">Henüz temizleme kaydı bulunmuyor.</p>';
                return;
            }
            
            let html = '';
            temizlemeKayitlari.slice().reverse().forEach(kayit => {
                html += `
                    <div class="kayit-item">
                        <div class="kayit-header">
                            <div>
                                <strong>🏷️ ${kayit.siparisNo} - 📦 ${kayit.urunKodu}</strong>
                            </div>
                            <div>
                                <button class="btn-edit" onclick="temizlemeEdit(${kayit.id})">✏️</button>
                                <button class="btn-delete" onclick="temizlemeSil(${kayit.id})" style="margin-left: 5px;">🗑️</button>
                            </div>
                        </div>
                        <div class="kayit-details">
                            <div><strong>📊 Sipariş Adeti:</strong> ${kayit.siparisAdet}</div>
                            <div><strong>📦 Gelen Adet:</strong> ${kayit.gelenAdet}</div>
                            <div><strong>⚖️ Adet KG:</strong> ${kayit.adetKg}</div>
                            <div><strong>⚖️ Toplam KG:</strong> ${kayit.toplamKg}</div>
                            <div><strong>👤 Ekleyen:</strong> ${kayit.ekleyen}</div>
                            <div><strong>📅 Tarih:</strong> ${new Date(kayit.tarih).toLocaleString('tr-TR')}</div>
                        </div>
                    </div>
                `;
            });
            container.innerHTML = html;
        }

        async function temizlemeSil(id) {
            if (confirm('Bu temizleme kaydını silmek istediğinizden emin misiniz?')) {
                const kayit = temizlemeKayitlari.find(k => k.id === id);
                if (kayit) {
                    await deleteFromFirebase('temizlemeKayitlari', kayit.firebaseId, id);
                }
                showAlert('temizlemeAlert', 'Temizleme kaydı silindi!', 'success');
            }
        }

        // Sevke Hazır kayıtları fonksiyonları
        async function sevkeHazirEkle(e) {
            e.preventDefault();
            const formData = {
                id: Date.now(),
                siparisNo: document.getElementById('sevkeSiparisNo').value.trim(),
                urunNo: document.getElementById('sevkeUrunNo').value.trim(),
                sevkeHazirAdet: parseInt(document.getElementById('sevkeHazirAdet').value) || 0,
                koliAdet: parseInt(document.getElementById('sevkeKoliAdet').value) || 0,
                ekleyen: document.getElementById('sevkeHazirEkleyen').value,
                tarih: new Date().toISOString()
            };
            
            await saveToFirebase('sevkeHazirKayitlari', formData);
            document.getElementById('sevkeHazirForm').reset();
            showAlert('sevkeHazirAlert', 'Sevke hazır kaydı başarıyla eklendi!', 'success');
        }

        function loadSevkeHazirKayitlari() {
            const container = document.getElementById('sevkeHazirKayitlari');
            if (!container) return;
            
            if (sevkeHazirKayitlari.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #666; padding: 20px;">Henüz sevke hazır kayıt bulunmuyor.</p>';
                return;
            }
            
            let html = '';
            sevkeHazirKayitlari.slice().reverse().forEach(kayit => {
                html += `
                    <div class="kayit-item">
                        <div class="kayit-header">
                            <div>
                                <strong>🏷️ ${kayit.siparisNo} - 📦 ${kayit.urunNo}</strong>
                            </div>
                            <div>
                                <button class="btn-edit" onclick="sevkeHazirEdit(${kayit.id})">✏️</button>
                                <button class="btn-delete" onclick="sevkeHazirSil(${kayit.id})" style="margin-left: 5px;">🗑️</button>
                            </div>
                        </div>
                        <div class="kayit-details">
                            <div><strong>📊 Sevke Hazır Adet:</strong> ${kayit.sevkeHazirAdet}</div>
                            <div><strong>📦 Koli Adeti:</strong> ${kayit.koliAdet}</div>
                            <div><strong>👤 Ekleyen:</strong> ${kayit.ekleyen}</div>
                            <div><strong>📅 Tarih:</strong> ${new Date(kayit.tarih).toLocaleString('tr-TR')}</div>
                        </div>
                    </div>
                `;
            });
            container.innerHTML = html;
        }

        async function sevkeHazirSil(id) {
            if (confirm('Bu sevke hazır kaydını silmek istediğinizden emin misiniz?')) {
                const kayit = sevkeHazirKayitlari.find(k => k.id === id);
                if (kayit) {
                    await deleteFromFirebase('sevkeHazirKayitlari', kayit.firebaseId, id);
                }
                showAlert('sevkeHazirAlert', 'Sevke hazır kaydı silindi!', 'success');
            }
        }

        // Sevk Edilen kayıtları fonksiyonları
        async function sevkEdilenEkle(e) {
            e.preventDefault();
            const formData = {
                id: Date.now(),
                siparisNo: document.getElementById('sevkSiparisNo').value.trim(),
                urunTuru: document.getElementById('sevkUrunTuru').value.trim(),
                urunNo: document.getElementById('sevkUrunNo').value.trim(),
                teslimTarih: document.getElementById('sevkTeslimTarih').value,
                teslimAdet: parseInt(document.getElementById('sevkTeslimAdet').value) || 0,
                teslimAlan: document.getElementById('sevkTeslimAlan').value.trim(),
                depoIrsaliye: document.getElementById('sevkDepoIrsaliye').value.trim(),
                ekleyen: document.getElementById('sevkEdilenEkleyen').value,
                tarih: new Date().toISOString()
            };
            
            await saveToFirebase('sevkEdilenKayitlari', formData);
            
            document.getElementById('sevkEdilenForm').reset();
            const today = new Date().toISOString().slice(0, 10);
            document.getElementById('sevkTeslimTarih').value = today;
            
            showAlert('sevkEdilenAlert', 'Sevk edilen kaydı başarıyla eklendi!', 'success');
        }

        function loadSevkEdilenKayitlari() {
            const container = document.getElementById('sevkEdilenKayitlari');
            if (!container) return;
            
            if (sevkEdilenKayitlari.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #666; padding: 20px;">Henüz sevk edilen kayıt bulunmuyor.</p>';
                return;
            }
            
            let html = '';
            sevkEdilenKayitlari.slice().reverse().forEach(kayit => {
                html += `
                    <div class="kayit-item">
                        <div class="kayit-header">
                            <div>
                                <strong>🏷️ ${kayit.siparisNo} - ${kayit.urunTuru} (${kayit.urunNo})</strong>
                            </div>
                            <div>
                                <button class="btn-edit" onclick="sevkEdilenEdit(${kayit.id})">✏️</button>
                                <button class="btn-delete" onclick="sevkEdilenSil(${kayit.id})" style="margin-left: 5px;">🗑️</button>
                            </div>
                        </div>
                        <div class="kayit-details">
                            <div><strong>📅 Teslim Tarihi:</strong> ${new Date(kayit.teslimTarih).toLocaleDateString('tr-TR')}</div>
                            <div><strong>📊 Teslim Adeti:</strong> ${kayit.teslimAdet}</div>
                            <div><strong>👤 Teslim Alan:</strong> ${kayit.teslimAlan}</div>
                            <div><strong>📋 Depo İrsaliye:</strong> ${kayit.depoIrsaliye}</div>
                            <div><strong>👤 Ekleyen:</strong> ${kayit.ekleyen}</div>
                            <div><strong>📅 Kayıt Tarihi:</strong> ${new Date(kayit.tarih).toLocaleString('tr-TR')}</div>
                        </div>
                    </div>
                `;
            });
            container.innerHTML = html;
        }

        async function sevkEdilenSil(id) {
            if (confirm('Bu sevk edilen kaydını silmek istediğinizden emin misiniz?')) {
                const kayit = sevkEdilenKayitlari.find(k => k.id === id);
                if (kayit) {
                    await deleteFromFirebase('sevkEdilenKayitlari', kayit.firebaseId, id);
                }
                showAlert('sevkEdilenAlert', 'Sevk edilen kaydı silindi!', 'success');
            }
        }

        // Yarı Mamül kayıtları fonksiyonları
        async function yariMamulEkle(e) {
            e.preventDefault();
            const formData = {
                id: Date.now(),
                urunAdi: document.getElementById('yariMamulUrunAdi').value.trim(),
                adet: parseInt(document.getElementById('yariMamulAdet').value) || 0,
                hangiParca: document.getElementById('yariMamulHangiParca').value.trim(),
                not: document.getElementById('yariMamulNot').value.trim(),
                ekleyen: document.getElementById('yariMamulEkleyen').value,
                tarih: new Date().toISOString()
            };
            
            await saveToFirebase('yariMamulKayitlari', formData);
            document.getElementById('yariMamulForm').reset();
            showAlert('yariMamulAlert', 'Yarı mamül kaydı başarıyla eklendi!', 'success');
        }

        function loadYariMamulKayitlari() {
            const container = document.getElementById('yariMamulKayitlari');
            if (!container) return;
            
            if (yariMamulKayitlari.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #666; padding: 20px;">Henüz yarı mamül kayıt bulunmuyor.</p>';
                return;
            }
            
            let html = '';
            yariMamulKayitlari.slice().reverse().forEach(kayit => {
                html += `
                    <div class="kayit-item">
                        <div class="kayit-header">
                            <div>
                                <strong>📦 ${kayit.urunAdi} - 🔧 ${kayit.hangiParca}</strong>
                            </div>
                            <div>
                                <button class="btn-edit" onclick="yariMamulEdit(${kayit.id})">✏️</button>
                                <button class="btn-delete" onclick="yariMamulSil(${kayit.id})" style="margin-left: 5px;">🗑️</button>
                            </div>
                        </div>
                        <div class="kayit-details">
                            <div><strong>📊 Adet:</strong> ${kayit.adet}</div>
                            <div><strong>📝 Not:</strong> ${kayit.not || 'Yok'}</div>
                            <div><strong>👤 Ekleyen:</strong> ${kayit.ekleyen}</div>
                            <div><strong>📅 Tarih:</strong> ${new Date(kayit.tarih).toLocaleString('tr-TR')}</div>
                        </div>
                    </div>
                `;
            });
            container.innerHTML = html;
        }

        async function yariMamulSil(id) {
            if (confirm('Bu yarı mamül kaydını silmek istediğinizden emin misiniz?')) {
                const kayit = yariMamulKayitlari.find(k => k.id === id);
                if (kayit) {
                    await deleteFromFirebase('yariMamulKayitlari', kayit.firebaseId, id);
                }
                showAlert('yariMamulAlert', 'Yarı mamül kaydı silindi!', 'success');
            }
        }

        // Kalite kaydı silme (Firebase entegreli)
        async function kaliteKaydiSil(id) {
            if (confirm('Bu kalite kontrol kaydını silmek istediğinizden emin misiniz?')) {
                const kayit = kaliteKayitlari.find(k => k.id === id);
                if (kayit) {
                    await deleteFromFirebase('kaliteKayitlari', kayit.firebaseId, id);
                }
                showAlert('kaliteAlert', 'Kalite kontrol kaydı silindi!', 'success');
            }
        }

        // Performans kaydı silme (Firebase entegreli)
        async function performansKaydiSil(id) {
            if (confirm('Bu performans kaydını silmek istediğinizden emin misiniz?')) {
                const kayit = performansKayitlari.find(k => k.id === id);
                if (kayit) {
                    await deleteFromFirebase('performansKayitlari', kayit.firebaseId, id);
                }
                showAlert('performansAlert', 'Performans kaydı silindi!', 'success');
            }
        }

        // Kalite kayıtlarını tablo formatında yükle
        function loadKaliteKayitlari() {
            const container = document.getElementById('kaliteKayitlariListesi');
            if (!container) return;
            
            if (kaliteKayitlari.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #666; padding: 20px;">Henüz kalite kontrol kaydı bulunmuyor.</p>';
                return;
            }

            // Hata türlerini topla (dinamik sütunlar için)
            const tumHataTurleri = new Set();
            kaliteKayitlari.forEach(kayit => {
                kayit.hatalar.forEach(hata => {
                    tumHataTurleri.add(hata.tur);
                });
            });

            let html = '<div style="overflow-x: auto; background: white; border-radius: 8px; border: 2px solid #e9ecef; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">';
            html += '<table style="width: 100%; border-collapse: collapse; font-size: 14px;">';
            
            // Tablo başlığı
            html += `
                <thead style="background: linear-gradient(135deg, #3498db, #2980b9); color: white;">
                    <tr>
                        <th style="padding: 12px 8px; border: 1px solid #2980b9; text-align: center; white-space: nowrap;">📅 Tarih/Saat</th>
                        <th style="padding: 12px 8px; border: 1px solid #2980b9; text-align: center; white-space: nowrap;">👤 Operatör</th>
                        <th style="padding: 12px 8px; border: 1px solid #2980b9; text-align: center; white-space: nowrap;">📦 Ürün Kodu</th>
                        <th style="padding: 12px 8px; border: 1px solid #2980b9; text-align: center; white-space: nowrap;">📊 Toplam Adet</th>
                        <th style="padding: 12px 8px; border: 1px solid #2980b9; text-align: center; white-space: nowrap;">🏷️ Sipariş No</th>
                        <th style="padding: 12px 8px; border: 1px solid #2980b9; text-align: center; white-space: nowrap; background: #e74c3c;">🗑️ Toplam İskarta</th>
                        <th style="padding: 12px 8px; border: 1px solid #2980b9; text-align: center; white-space: nowrap; background: #f39c12;">↩️ Toplam Geri Dönen</th>
                        <th style="padding: 12px 8px; border: 1px solid #2980b9; text-align: center; white-space: nowrap; background: #e74c3c;">🚫 İşlem</th>
            `;
            
            // Hata türü sütunları
            Array.from(tumHataTurleri).forEach(hataTuru => {
                html += `<th style="padding: 12px 8px; border: 1px solid #2980b9; text-align: center; white-space: nowrap; background: #8e44ad; font-size: 12px;">🚫 ${hataTuru}</th>`;
            });
            
            html += '</tr></thead><tbody>';

            // Veri satırları (en son kayıt üstte)
            kaliteKayitlari.slice().reverse().forEach((kayit, index) => {
                const toplamIskarta = kayit.hatalar.reduce((total, hata) => total + hata.iskartaAdet, 0);
                const toplamGeriDonen = kayit.hatalar.reduce((total, hata) => total + hata.geriGidenAdet, 0);
                
                html += `<tr style="background: ${index % 2 === 0 ? '#f8f9fa' : 'white'}; border-bottom: 1px solid #dee2e6;">`;
                html += `<td style="padding: 10px 8px; border: 1px solid #dee2e6; text-align: center; white-space: nowrap; font-size: 12px;">${new Date(kayit.tarih).toLocaleString('tr-TR')}</td>`;
                html += `<td style="padding: 10px 8px; border: 1px solid #dee2e6; text-align: center; font-weight: 600;">${kayit.operator}</td>`;
                html += `<td style="padding: 10px 8px; border: 1px solid #dee2e6; text-align: center; font-weight: 600; color: #2c3e50;">${kayit.urunKodu}</td>`;
                html += `<td style="padding: 10px 8px; border: 1px solid #dee2e6; text-align: center; font-weight: bold; color: #27ae60;">${kayit.toplamAdet}</td>`;
                html += `<td style="padding: 10px 8px; border: 1px solid #dee2e6; text-align: center;">${kayit.siparisNo}</td>`;
                html += `<td style="padding: 10px 8px; border: 1px solid #dee2e6; text-align: center; font-weight: bold; color: ${toplamIskarta > 0 ? '#e74c3c' : '#27ae60'}; background: ${toplamIskarta > 0 ? '#fdf2f2' : '#f0f9f0'};">${toplamIskarta}</td>`;
                html += `<td style="padding: 10px 8px; border: 1px solid #dee2e6; text-align: center; font-weight: bold; color: ${toplamGeriDonen > 0 ? '#f39c12' : '#27ae60'}; background: ${toplamGeriDonen > 0 ? '#fef9e7' : '#f0f9f0'};">${toplamGeriDonen}</td>`;
                html += `<td style="padding: 10px 8px; border: 1px solid #dee2e6; text-align: center;"><button onclick="kaliteKaydiSil(${kayit.id})" style="background: #e74c3c; color: white; border: none; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px;">🗑️ Sil</button></td>`;
                
                // Her hata türü için veri
                Array.from(tumHataTurleri).forEach(hataTuru => {
                    const hataVeri = kayit.hatalar.find(h => h.tur === hataTuru);
                    if (hataVeri) {
                        const toplamHata = hataVeri.iskartaAdet + hataVeri.geriGidenAdet;
                        html += `<td style="padding: 10px 8px; border: 1px solid #dee2e6; text-align: center; font-size: 11px; ${toplamHata > 0 ? 'background: #fff2f2; color: #721c24; font-weight: bold;' : 'color: #666;'}">
                            ${toplamHata > 0 ? `İ:${hataVeri.iskartaAdet} G:${hataVeri.geriGidenAdet}` : '-'}
                        </td>`;
                    } else {
                        html += `<td style="padding: 10px 8px; border: 1px solid #dee2e6; text-align: center; color: #999;">-</td>`;
                    }
                });
                html += '</tr>';
            });
            
            html += '</tbody></table></div>';

            // Özet bilgi
            const toplamKayit = kaliteKayitlari.length;
            const genelToplamIskarta = kaliteKayitlari.reduce((total, kayit) =>
                total + kayit.hatalar.reduce((hataTotal, hata) => hataTotal + hata.iskartaAdet, 0), 0);
            const genelToplamGeriDonen = kaliteKayitlari.reduce((total, kayit) =>
                total + kayit.hatalar.reduce((hataTotal, hata) => hataTotal + hata.geriGidenAdet, 0), 0);
            const genelToplamUretim = kaliteKayitlari.reduce((total, kayit) => total + kayit.toplamAdet, 0);
            
            html += `
                <div style="margin-top: 15px; padding: 15px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 8px; color: white;">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; text-align: center;">
                        <div><strong style="font-size: 1.2em;">${toplamKayit}</strong><br><small>Toplam Kayıt</small></div>
                        <div><strong style="font-size: 1.2em;">${genelToplamUretim}</strong><br><small>Toplam Üretim</small></div>
                        <div><strong style="font-size: 1.2em; color: #ffcccb;">${genelToplamIskarta}</strong><br><small>Toplam İskarta</small></div>
                        <div><strong style="font-size: 1.2em; color: #ffe4b5;">${genelToplamGeriDonen}</strong><br><small>Toplam Geri Dönen</small></div>
                        <div><strong style="font-size: 1.2em; color: #90ee90;">${genelToplamUretim > 0 ? Math.round((1 - (genelToplamIskarta + genelToplamGeriDonen)/genelToplamUretim) * 100) : 0}%</strong><br><small>Başarı Oranı</small></div>
                    </div>
                </div>
            `;
            
            container.innerHTML = html;
        }

        // Stok ekleme/güncelleme fonksiyonu
        async function stokEkleGuncelle(e) {
            if (e) e.preventDefault();
            
            const malzemeTuru = document.getElementById('stokMalzemeTuru').value;
            const urunAdi = document.getElementById('stokUrunAdi').value.trim();
            const olculeri = document.getElementById('stokOlculeri').value.trim();
            const mevcutAdet = parseInt(document.getElementById('stokMevcut').value) || 0;
            const ekleyen = document.getElementById('stokEkleyen').value;
            
            if (!malzemeTuru || !urunAdi || !ekleyen) {
                showAlert('stokAlert', 'Lütfen malzeme türü, ürün adı ve ekleyen kişiyi giriniz!', 'error');
                return;
            }
            
            // Aynı ürün var mı kontrol et
            const existingIndex = stokKayitlari.findIndex(stok =>
                stok.malzemeTuru === malzemeTuru &&
                stok.urunAdi.toLowerCase() === urunAdi.toLowerCase() &&
                stok.olculeri === olculeri
            );
            
            const yeniStok = {
                id: existingIndex !== -1 ? stokKayitlari[existingIndex].id : Date.now(),
                malzemeTuru: malzemeTuru,
                urunAdi: urunAdi,
                olculeri: olculeri,
                mevcutAdet: mevcutAdet,
                ekleyen: ekleyen,
                sonGuncelleme: new Date().toISOString()
            };
            
            if (existingIndex !== -1) {
                // Güncelle
                yeniStok.firebaseId = stokKayitlari[existingIndex].firebaseId;
                await updateInFirebase('stokKayitlari', yeniStok.firebaseId, yeniStok);
                showAlert('stokAlert', 'Stok başarıyla güncellendi!', 'success');
            } else {
                // Yeni ekle
                await saveToFirebase('stokKayitlari', yeniStok);
                showAlert('stokAlert', 'Stok başarıyla eklendi!', 'success');
            }
            
            temizleStokFormu();
        }

        // Stok formu temizle
        function temizleStokFormu() {
            document.getElementById('stokForm').reset();
        }

        // Stok listesi göster
        function loadStokListesi() {
            const container = document.getElementById('stokListesi');
            if (!container) return;
            
            if (stokKayitlari.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #666; padding: 20px;">Henüz stok kaydı bulunmuyor.</p>';
                return;
            }
            
            let html = '';
            stokKayitlari.forEach(stok => {
                html += `
                    <div class="stok-kayit-item">
                        <div class="stok-header">
                            <h4>📦 ${stok.urunAdi}</h4>
                            <span style="background: #3498db; color: white; padding: 5px 10px; border-radius: 15px; font-size: 12px; font-weight: bold;">
                                ${stok.malzemeTuru.toUpperCase()}
                            </span>
                        </div>
                        <div class="stok-bilgi">
                            <div class="stok-bilgi-item">
                                <span><strong>📏 Ölçüler:</strong></span>
                                <span>${stok.olculeri || 'Belirtilmemiş'}</span>
                            </div>
                            <div class="stok-bilgi-item">
                                <span><strong>📊 Mevcut Adet:</strong></span>
                                <span style="font-weight: bold; color: ${stok.mevcutAdet > 0 ? '#27ae60' : '#e74c3c'};">
                                    ${stok.mevcutAdet}
                                </span>
                            </div>
                            <div class="stok-bilgi-item">
                                <span><strong>👤 Ekleyen:</strong></span>
                                <span>${stok.ekleyen}</span>
                            </div>
                            <div class="stok-bilgi-item">
                                <span><strong>🕒 Son Güncelleme:</strong></span>
                                <span>${new Date(stok.sonGuncelleme).toLocaleString('tr-TR')}</span>
                            </div>
                        </div>
                        <div class="stok-kontrol">
                            <button class="stok-btn-small minus" onclick="stokAzalt(${stok.id})">-</button>
                            <div class="stok-adet-display">${stok.mevcutAdet}</div>
                            <button class="stok-btn-small" onclick="stokArttir(${stok.id})">+</button>
                            <input type="number" class="stok-adet-input" id="adet-${stok.id}" placeholder="Adet" min="0">
                            <button class="btn" style="margin-left: 10px; padding: 5px 10px;" onclick="stokGuncelle(${stok.id})">Güncelle</button>
                        </div>
                        <div class="stok-actions">
                            <button class="btn-edit" onclick="stokDuzenle(${stok.id})">✏️ Düzenle</button>
                            <button class="btn-delete" onclick="stokSil(${stok.id})">🗑️ Sil</button>
                        </div>
                    </div>
                `;
            });
            container.innerHTML = html;
        }

        // Stok miktarı arttır
        async function stokArttir(id) {
            const stok = stokKayitlari.find(s => s.id === id);
            if (stok) {
                stok.mevcutAdet++;
                stok.sonGuncelleme = new Date().toISOString();
                await updateInFirebase('stokKayitlari', stok.firebaseId, stok);
            }
        }

        // Stok miktarı azalt
        async function stokAzalt(id) {
            const stok = stokKayitlari.find(s => s.id === id);
            if (stok && stok.mevcutAdet > 0) {
                stok.mevcutAdet--;
                stok.sonGuncelleme = new Date().toISOString();
                await updateInFirebase('stokKayitlari', stok.firebaseId, stok);
            }
        }

        // Stok güncelle (input ile)
        async function stokGuncelle(id) {
            const inputElement = document.getElementById(`adet-${id}`);
            const yeniAdet = parseInt(inputElement.value);
            
            if (isNaN(yeniAdet) || yeniAdet < 0) {
                alert('Lütfen geçerli bir adet girin!');
                return;
            }
            
            const stok = stokKayitlari.find(s => s.id === id);
            if (stok) {
                stok.mevcutAdet = yeniAdet;
                stok.sonGuncelleme = new Date().toISOString();
                await updateInFirebase('stokKayitlari', stok.firebaseId, stok);
                inputElement.value = '';
            }
        }

        // Stok sil
        async function stokSil(id) {
            if (confirm('Bu stok kaydını silmek istediğinizden emin misiniz?')) {
                const stok = stokKayitlari.find(s => s.id === id);
                if (stok) {
                    await deleteFromFirebase('stokKayitlari', stok.firebaseId, id);
                }
                showAlert('stokAlert', 'Stok kaydı silindi!', 'success');
            }
        }

        // Stok düzenle
        function stokDuzenle(id) {
            const stok = stokKayitlari.find(s => s.id === id);
            if (stok) {
                document.getElementById('stokMalzemeTuru').value = stok.malzemeTuru;
                document.getElementById('stokUrunAdi').value = stok.urunAdi;
                document.getElementById('stokOlculeri').value = stok.olculeri;
                document.getElementById('stokMevcut').value = stok.mevcutAdet;
                document.getElementById('stokEkleyen').value = stok.ekleyen;
                
                // Formu üste scroll et
                document.getElementById('stokForm').scrollIntoView({ behavior: 'smooth' });
            }
        }

        // Tüm stokları yükle (yenileme)
        function tumStoklariYukle() {
            loadStokListesi();
            tumStoklariOzetGoster();
            showAlert('stokAlert', 'Stoklar yenilendi!', 'success');
        }

        // Tüm stokları sıfırla
        async function tumStoklariSifirla() {
            if (confirm('TÜM STOK KAYITLARINI silmek istediğinizden emin misiniz? Bu işlem geri alınamaz!')) {
                try {
                    // Firebase'deki tüm stok kayıtlarını sil
                    for (const stok of stokKayitlari) {
                        if (stok.firebaseId) {
                            await deleteFromFirebase('stokKayitlari', stok.firebaseId, stok.id);
                        }
                    }
                    showAlert('stokAlert', 'Tüm stoklar temizlendi!', 'success');
                } catch (error) {
                    console.error('Stok temizleme hatası:', error);
                    showAlert('stokAlert', 'Stok temizleme sırasında hata oluştu!', 'error');
                }
            }
        }

        // Stok özeti göster
        function tumStoklariOzetGoster() {
            const container = document.getElementById('stokOzeti');
            if (!container) return;
            
            if (stokKayitlari.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #666; padding: 20px;">Henüz stok kaydı bulunmuyor.</p>';
                return;
            }
            
            // Malzeme türlerine göre grupla
            const malzemeTurleri = {};
            stokKayitlari.forEach(stok => {
                if (!malzemeTurleri[stok.malzemeTuru]) {
                    malzemeTurleri[stok.malzemeTuru] = [];
                }
                malzemeTurleri[stok.malzemeTuru].push(stok);
            });
            
            let html = '<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px;">';
            
            Object.keys(malzemeTurleri).forEach(tur => {
                const stoklar = malzemeTurleri[tur];
                const toplamAdet = stoklar.reduce((total, stok) => total + stok.mevcutAdet, 0);
                const kritikStoklar = stoklar.filter(stok => stok.mevcutAdet <= 5).length;
                
                html += `
                    <div style="background: white; border: 2px solid #e9ecef; border-radius: 10px; padding: 15px; box-shadow: 0 3px 10px rgba(0,0,0,0.1);">
                        <h4 style="color: #2c3e50; margin-bottom: 10px; text-transform: uppercase; border-bottom: 2px solid #3498db; padding-bottom: 5px;">
                            🔧 ${tur}
                        </h4>
                        <div style="margin-bottom: 10px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                <span><strong>📦 Toplam Kalem:</strong></span>
                                <span style="font-weight: bold; color: #3498db;">${stoklar.length}</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                <span><strong>📊 Toplam Adet:</strong></span>
                                <span style="font-weight: bold; color: #27ae60;">${toplamAdet}</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span><strong>⚠️ Kritik Stok:</strong></span>
                                <span style="font-weight: bold; color: ${kritikStoklar > 0 ? '#e74c3c' : '#27ae60'};">
                                    ${kritikStoklar}
                                </span>
                            </div>
                        </div>
                        <div style="max-height: 200px; overflow-y: auto; border-top: 1px solid #e9ecef; padding-top: 10px;">
                `;
                
                stoklar.forEach(stok => {
                    const durumRenk = stok.mevcutAdet <= 5 ? '#e74c3c' : stok.mevcutAdet <= 20 ? '#f39c12' : '#27ae60';
                    html += `
                        <div style="display: flex; justify-content: space-between; align-items: center; padding: 5px 0; border-bottom: 1px solid #f8f9fa;">
                            <span style="font-size: 14px; color: #2c3e50;">${stok.urunAdi}</span>
                            <span style="font-weight: bold; color: ${durumRenk}; background: ${durumRenk}20; padding: 2px 8px; border-radius: 12px; font-size: 12px;">
                                ${stok.mevcutAdet}
                            </span>
                        </div>
                    `;
                });
                
                html += '</div></div>';
            });
            
            html += '</div>';
            container.innerHTML = html;
        }

        // Sipariş listesi yükle
        function loadSiparislerListesi() {
            const container = document.getElementById('siparislerListesi');
            if (!container) return;
            
            if (siparisHazirlikKayitlari.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #666; padding: 20px;">Henüz sipariş kaydı bulunmuyor.</p>';
                return;
            }
            
            let html = '';
            siparisHazirlikKayitlari.slice().reverse().forEach(siparis => {
                const checkboxDurum = siparis.checkboxDurum || {};
                const tamamlananGörevler = Object.values(checkboxDurum).filter(durum => durum === true).length;
                const toplamGörevler = Object.keys(checkboxDurum).length;
                const tamamlanmaYuzdesi = toplamGörevler > 0 ? Math.round((tamamlananGörevler / toplamGörevler) * 100) : 0;
                
                html += `
                    <div class="stok-kayit-item">
                        <div class="stok-header">
                            <div>
                                <h4>🏷️ ${siparis.siparisNo} - 📦 ${siparis.urunKodu}</h4>
                                <div style="font-size: 12px; color: #666; margin-top: 3px;">
                                    📅 ${new Date(siparis.tarih).toLocaleDateString('tr-TR')} | 👤 ${siparis.operator} | 📊 ${siparis.siparisAdet} adet
                                </div>
                            </div>
                            <div style="text-align: right;">
                                <div style="background: ${tamamlanmaYuzdesi === 100 ? '#27ae60' : tamamlanmaYuzdesi >= 50 ? '#f39c12' : '#e74c3c'}; 
                                           color: white; padding: 5px 10px; border-radius: 15px; font-size: 12px; font-weight: bold; margin-bottom: 5px;">
                                    %${tamamlanmaYuzdesi} Tamamlandı
                                </div>
                                <span style="background: #3498db; color: white; padding: 3px 8px; border-radius: 12px; font-size: 11px;">
                                    ${siparis.durum.toUpperCase()}
                                </span>
                            </div>
                        </div>
                        
                        <div class="siparis-checkbox-container">
                            <label style="font-weight: bold; color: #2c3e50; margin-bottom: 8px; display: block;">📋 Hazırlık Durumu:</label>
                            <div class="siparis-checkboxes">
                                <div class="checkbox-item">
                                    <input type="checkbox" id="koli-${siparis.id}" ${checkboxDurum.koli ? 'checked' : ''} 
                                           onchange="updateSiparisCheckbox(${siparis.id}, 'koli', this.checked)">
                                    <label for="koli-${siparis.id}">📦 Koli</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="kutu-${siparis.id}" ${checkboxDurum.kutu ? 'checked' : ''} 
                                           onchange="updateSiparisCheckbox(${siparis.id}, 'kutu', this.checked)">
                                    <label for="kutu-${siparis.id}">📦 Kutu</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="izolasyon-${siparis.id}" ${checkboxDurum.izolasyon ? 'checked' : ''} 
                                           onchange="updateSiparisCheckbox(${siparis.id}, 'izolasyon', this.checked)">
                                    <label for="izolasyon-${siparis.id}">🔧 İzolasyon</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="etiket-${siparis.id}" ${checkboxDurum.etiket ? 'checked' : ''} 
                                           onchange="updateSiparisCheckbox(${siparis.id}, 'etiket', this.checked)">
                                    <label for="etiket-${siparis.id}">🏷️ Etiket</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="posetMevcut-${siparis.id}" ${checkboxDurum.posetMevcut ? 'checked' : ''} 
                                           onchange="updateSiparisCheckbox(${siparis.id}, 'posetMevcut', this.checked)">
                                    <label for="posetMevcut-${siparis.id}">🛍️ Poşet</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="tapaMevcut-${siparis.id}" ${checkboxDurum.tapaMevcut ? 'checked' : ''} 
                                           onchange="updateSiparisCheckbox(${siparis.id}, 'tapaMevcut', this.checked)">
                                    <label for="tapaMevcut-${siparis.id}">🔩 Tapa</label>
                                </div>
                            </div>
                        </div>
                        
                        <div class="stok-actions" style="margin-top: 15px;">
                            <button class="btn-edit" onclick="siparisEdit(${siparis.id})">✏️ Düzenle</button>
                            <button class="btn-delete" onclick="siparisSil(${siparis.id})">🗑️ Sil</button>
                            <button class="btn" onclick="siparisTamamla(${siparis.id})" 
                                    ${tamamlanmaYuzdesi === 100 ? 'style="background: #27ae60;"' : ''}>
                                ${tamamlanmaYuzdesi === 100 ? '✅ Tamamlandı' : '⏳ Tamamla'}
                            </button>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        // Sipariş checkbox durumunu güncelle
        async function updateSiparisCheckbox(siparisId, checkboxType, isChecked) {
            const siparis = siparisHazirlikKayitlari.find(s => s.id === siparisId);
            if (siparis) {
                if (!siparis.checkboxDurum) {
                    siparis.checkboxDurum = {};
                }
                siparis.checkboxDurum[checkboxType] = isChecked;
                
                // Firebase'de güncelle
                await updateInFirebase('siparisHazirlikKayitlari', siparis.firebaseId, siparis);
                
                // Listeyi yenile
                setTimeout(() => loadSiparislerListesi(), 100);
            }
        }

        // Sipariş tamamla
        async function siparisTamamla(id) {
            const siparis = siparisHazirlikKayitlari.find(s => s.id === id);
            if (siparis) {
                siparis.durum = 'tamamlandi';
                siparis.tamamlanmaTarihi = new Date().toISOString();
                
                await updateInFirebase('siparisHazirlikKayitlari', siparis.firebaseId, siparis);
                
                showAlert('siparisEkleAlert', 'Sipariş tamamlandı!', 'success');
            }
        }

        // Sipariş sil
        async function siparisSil(id) {
            if (confirm('Bu sipariş kaydını silmek istediğinizden emin misiniz?')) {
                const siparis = siparisHazirlikKayitlari.find(s => s.id === id);
                if (siparis) {
                    await deleteFromFirebase('siparisHazirlikKayitlari', siparis.firebaseId, id);
                }
                showAlert('siparisEkleAlert', 'Sipariş kaydı silindi!', 'success');
            }
        }

        // Performans kayıtlarını yükle
        function loadPerformansKayitlari() {
            const container = document.getElementById('performansKayitlariListesi');
            if (!container) return;
            
            if (performansKayitlari.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #666; padding: 20px;">Henüz performans kaydı bulunmuyor.</p>';
                return;
            }
            
            let html = '';
            performansKayitlari.slice().reverse().forEach(kayit => {
                html += `
                    <div class="kayit-item">
                        <div class="kayit-header">
                            <div>
                                <strong>📅 ${new Date(kayit.tarih).toLocaleDateString('tr-TR')} - 👤 ${kayit.calisan}</strong>
                            </div>
                            <div>
                                <button class="btn-edit" onclick="performansEdit(${kayit.id})">✏️</button>
                                <button class="btn-delete" onclick="performansKaydiSil(${kayit.id})" style="margin-left: 5px;">🗑️</button>
                            </div>
                        </div>
                        <div style="margin-top: 15px;">
                            <h5 style="color: #2c3e50; margin-bottom: 10px;">⚡ Performans Detayları:</h5>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px;">
                `;
                
                kayit.islemler.forEach(islem => {
                    html += `
                        <div style="background: #f8f9fa; padding: 10px; border-radius: 6px; border-left: 4px solid #3498db;">
                            <div style="font-weight: bold; color: #2c3e50; margin-bottom: 5px;">${islem.ad}</div>
                            <div style="font-size: 13px; color: #666;">
                                <div><strong>📦 Ürün:</strong> ${islem.urun}</div>
                                <div><strong>📊 Adet:</strong> ${islem.adet}</div>
                                <div><strong>⏱️ Süre:</strong> ${islem.sure} dk</div>
                                <div><strong>⚡ Hız:</strong> <span style="color: #e74c3c; font-weight: bold;">${islem.hiz} adet/saat</span></div>
                            </div>
                        </div>
                    `;
                });
                
                html += `
                            </div>
                        </div>
                        <div style="margin-top: 10px; padding: 10px; background: #ecf0f1; border-radius: 6px; font-size: 13px; color: #666;">
                            <strong>👤 Veri Ekleyen:</strong> ${kayit.ekleyen} | <strong>📅 Kayıt Tarihi:</strong> ${new Date(kayit.tarih).toLocaleString('tr-TR')}
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        // İstatistikleri yükle
        function loadStats() {
            // Toplam kayıt sayıları
            document.getElementById('toplamKaliteKayit').textContent = kaliteKayitlari.length;
            document.getElementById('toplamSiparisKayit').textContent = siparisHazirlikKayitlari.length;
            document.getElementById('toplamPerformansKayit').textContent = performansKayitlari.length;
            
            // Tamamlanan sipariş sayısı
            const tamamlananSiparisler = siparisHazirlikKayitlari.filter(s => s.durum === 'tamamlandi').length;
            document.getElementById('tamamlananSiparis').textContent = tamamlananSiparisler;
            
            // Toplam hata adedi
            const toplamHataAdet = kaliteKayitlari.reduce((total, kayit) =>
                total + kayit.hatalar.reduce((hataTotal, hata) => hataTotal + hata.iskartaAdet + hata.geriGidenAdet, 0), 0);
            document.getElementById('toplamHataAdet').textContent = toplamHataAdet;
            
            // Başarı oranı
            const toplamUretim = kaliteKayitlari.reduce((total, kayit) => total + kayit.toplamAdet, 0);
            const basariOrani = toplamUretim > 0 ? Math.round((1 - toplamHataAdet / toplamUretim) * 100) : 0;
            document.getElementById('basariOrani').textContent = basariOrani + '%';
            
            // Raporlar sayfası için ayrı istatistikler
            if (document.getElementById('toplamKayit')) {
                document.getElementById('toplamKayit').textContent = kaliteKayitlari.length;
                document.getElementById('toplamSiparis').textContent = siparisHazirlikKayitlari.length;
                document.getElementById('toplamPerformans').textContent = performansKayitlari.length;
                document.getElementById('stokSayisi').textContent = stokKayitlari.length;
            }
        }

        // Detaylı istatistikleri yükle
        function loadIstatistikler() {
            loadHataIstatistikleri();
            loadPerformansIstatistikleri();
            loadCalisanIstatistikleri();
        }

        // Hata istatistiklerini yükle
        function loadHataIstatistikleri() {
            const container = document.getElementById('hataIstatistikleri');
            if (!container) return;
            
            if (kaliteKayitlari.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #666;">Henüz veri bulunmuyor.</p>';
                return;
            }
            
            // Hata türlerini topla
            const hataTurleri = {};
            kaliteKayitlari.forEach(kayit => {
                kayit.hatalar.forEach(hata => {
                    if (!hataTurleri[hata.tur]) {
                        hataTurleri[hata.tur] = { iskarta: 0, geriGiden: 0, toplam: 0 };
                    }
                    hataTurleri[hata.tur].iskarta += hata.iskartaAdet;
                    hataTurleri[hata.tur].geriGiden += hata.geriGidenAdet;
                    hataTurleri[hata.tur].toplam += hata.iskartaAdet + hata.geriGidenAdet;
                });
            });
            
            // Sıralama (en çok hatadan az hataya)
            const siraliHataTurleri = Object.entries(hataTurleri).sort((a, b) => b[1].toplam - a[1].toplam);
            
            let html = '<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px;">';
            siraliHataTurleri.forEach(([hataTuru, veriler]) => {
                const yuzde = ((veriler.toplam / kaliteKayitlari.reduce((total, kayit) =>
                    total + kayit.hatalar.reduce((hataTotal, hata) => hataTotal + hata.iskartaAdet + hata.geriGidenAdet, 0), 0)) * 100).toFixed(1);
                
                html += `
                    <div style="background: white; border: 2px solid #e9ecef; border-radius: 10px; padding: 15px; box-shadow: 0 3px 10px rgba(0,0,0,0.1);">
                        <h5 style="color: #2c3e50; margin-bottom: 10px; font-size: 14px;">${hataTuru}</h5>
                        <div style="margin-bottom: 8px;">
                            <div style="display: flex; justify-content: space-between; font-size: 13px;">
                                <span>🗑️ İskarta:</span>
                                <span style="font-weight: bold; color: #e74c3c;">${veriler.iskarta}</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; font-size: 13px;">
                                <span>↩️ Geri Dönen:</span>
                                <span style="font-weight: bold; color: #f39c12;">${veriler.geriGiden}</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; font-size: 13px; border-top: 1px solid #eee; padding-top: 5px; margin-top: 5px;">
                                <span><strong>📊 Toplam:</strong></span>
                                <span style="font-weight: bold; color: #e74c3c;">${veriler.toplam}</span>
                            </div>
                            <div style="text-align: center; margin-top: 8px;">
                                <span style="background: #3498db; color: white; padding: 3px 8px; border-radius: 12px; font-size: 12px; font-weight: bold;">
                                    %${yuzde}
                                </span>
                            </div>
                        </div>
                    </div>
                `;
            });
            html += '</div>';
            
            container.innerHTML = html;
        }

        // Performans istatistiklerini yükle
        function loadPerformansIstatistikleri() {
            const container = document.getElementById('performansIstatistikleri');
            if (!container) return;
            
            if (performansKayitlari.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #666;">Henüz veri bulunmuyor.</p>';
                return;
            }
            
            // İşlem türlerine göre ortalama performansları hesapla
            const islemPerformanslari = {};
            performansKayitlari.forEach(kayit => {
                kayit.islemler.forEach(islem => {
                    if (!islemPerformanslari[islem.ad]) {
                        islemPerformanslari[islem.ad] = { toplamHiz: 0, sayac: 0 };
                    }
                    islemPerformanslari[islem.ad].toplamHiz += islem.hiz;
                    islemPerformanslari[islem.ad].sayac++;
                });
            });
            
            let html = '<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">';
            Object.entries(islemPerformanslari).forEach(([islemAdi, veriler]) => {
                const ortalamaHiz = (veriler.toplamHiz / veriler.sayac).toFixed(2);
                
                html += `
                    <div style="background: white; border: 2px solid #e9ecef; border-radius: 10px; padding: 15px; box-shadow: 0 3px 10px rgba(0,0,0,0.1); text-align: center;">
                        <h5 style="color: #2c3e50; margin-bottom: 10px;">${islemAdi}</h5>
                        <div style="font-size: 24px; font-weight: bold; color: #27ae60; margin-bottom: 5px;">
                            ${ortalamaHiz}
                        </div>
                        <div style="font-size: 12px; color: #666;">
                            adet/saat (ortalama)
                        </div>
                        <div style="font-size: 11px; color: #999; margin-top: 5px;">
                            ${veriler.sayac} kayıt
                        </div>
                    </div>
                `;
            });
            html += '</div>';
            
            container.innerHTML = html;
        }

        // Çalışan bazlı istatistikleri yükle
        function loadCalisanIstatistikleri() {
            const container = document.getElementById('calisanIstatistikleri');
            if (!container) return;
            
            if (kaliteKayitlari.length === 0 && performansKayitlari.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #666;">Henüz veri bulunmuyor.</p>';
                return;
            }
            
            const calisanVerileri = {};
            
            // Kalite kontrol verilerinden çalışan istatistikleri
            kaliteKayitlari.forEach(kayit => {
                if (!calisanVerileri[kayit.operator]) {
                    calisanVerileri[kayit.operator] = { 
                        kaliteKontrol: 0, 
                        performans: 0, 
                        toplamUretim: 0, 
                        toplamHata: 0 
                    };
                }
                calisanVerileri[kayit.operator].kaliteKontrol++;
                calisanVerileri[kayit.operator].toplamUretim += kayit.toplamAdet;
                calisanVerileri[kayit.operator].toplamHata += kayit.hatalar.reduce((total, hata) => 
                    total + hata.iskartaAdet + hata.geriGidenAdet, 0);
            });
            
            // Performans verilerinden çalışan istatistikleri
            performansKayitlari.forEach(kayit => {
                if (!calisanVerileri[kayit.calisan]) {
                    calisanVerileri[kayit.calisan] = { 
                        kaliteKontrol: 0, 
                        performans: 0, 
                        toplamUretim: 0, 
                        toplamHata: 0 
                    };
                }
                calisanVerileri[kayit.calisan].performans++;
            });
            
            let html = '<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px;">';
            Object.entries(calisanVerileri).forEach(([calisan, veriler]) => {
                const basariOrani = veriler.toplamUretim > 0 ? 
                    Math.round((1 - veriler.toplamHata / veriler.toplamUretim) * 100) : 0;
                
                html += `
                    <div style="background: white; border: 2px solid #e9ecef; border-radius: 10px; padding: 15px; box-shadow: 0 3px 10px rgba(0,0,0,0.1);">
                        <h5 style="color: #2c3e50; margin-bottom: 15px; text-align: center; background: #3498db; color: white; padding: 8px; border-radius: 6px;">
                            👤 ${calisan}
                        </h5>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; font-size: 13px;">
                            <div style="text-align: center; background: #f8f9fa; padding: 8px; border-radius: 4px;">
                                <div style="font-weight: bold; color: #3498db;">${veriler.kaliteKontrol}</div>
                                <div style="color: #666; font-size: 11px;">Kalite Kontrol</div>
                            </div>
                            <div style="text-align: center; background: #f8f9fa; padding: 8px; border-radius: 4px;">
                                <div style="font-weight: bold; color: #27ae60;">${veriler.performans}</div>
                                <div style="color: #666; font-size: 11px;">Performans Kaydı</div>
                            </div>
                            <div style="text-align: center; background: #f8f9fa; padding: 8px; border-radius: 4px;">
                                <div style="font-weight: bold; color: #2c3e50;">${veriler.toplamUretim}</div>
                                <div style="color: #666; font-size: 11px;">Toplam Üretim</div>
                            </div>
                            <div style="text-align: center; background: #f8f9fa; padding: 8px; border-radius: 4px;">
                                <div style="font-weight: bold; color: ${veriler.toplamHata > 0 ? '#e74c3c' : '#27ae60'};">${veriler.toplamHata}</div>
                                <div style="color: #666; font-size: 11px;">Toplam Hata</div>
                            </div>
                        </div>
                        <div style="text-align: center; margin-top: 10px;">
                            <div style="background: ${basariOrani >= 90 ? '#27ae60' : basariOrani >= 80 ? '#f39c12' : '#e74c3c'}; 
                                       color: white; padding: 5px 10px; border-radius: 15px; font-weight: bold; font-size: 12px;">
                                %${basariOrani} Başarı Oranı
                            </div>
                        </div>
                    </div>
                `;
            });
            html += '</div>';
            
            container.innerHTML = html;
        }

        // Veri tablosunu yükle
        function loadVeriTablosu() {
            const veriTuru = document.getElementById('veriTuru').value;
            const tarihFiltre = document.getElementById('tarihFiltre').value;
            const container = document.getElementById('veriTablosuContainer');
            
            if (!container) return;
            
            let veriler = [];
            let baslik = '';
            
            // Veri türüne göre verileri seç
            switch (veriTuru) {
                case 'kalite':
                    veriler = kaliteKayitlari;
                    baslik = '🔍 Kalite Kontrol Verileri';
                    break;
                case 'siparis':
                    veriler = siparisHazirlikKayitlari;
                    baslik = '📋 Sipariş Hazırlık Verileri';
                    break;
                case 'performans':
                    veriler = performansKayitlari;
                    baslik = '⚡ Performans Verileri';
                    break;
                case 'stok':
                    veriler = stokKayitlari;
                    baslik = '📦 Stok Verileri';
                    break;
                case 'temizleme':
                    veriler = temizlemeKayitlari;
                    baslik = '🧽 Temizleme Verileri';
                    break;
                case 'sevkeHazir':
                    veriler = sevkeHazirKayitlari;
                    baslik = '📤 Sevke Hazır Verileri';
                    break;
                case 'sevkEdilen':
                    veriler = sevkEdilenKayitlari;
                    baslik = '🚚 Sevk Edilen Verileri';
                    break;
                case 'yariMamul':
                    veriler = yariMamulKayitlari;
                    baslik = '🔧 Yarı Mamül Stok Verileri';
                    break;
            }
            
            // Tarih filtresini uygula
            const filtrelenVeriler = veriler.filter(veri => {
                if (tarihFiltre === 'hepsi') return true;
                
                const veriTarihi = new Date(veri.tarih || veri.sonGuncelleme);
                const bugun = new Date();
                
                switch (tarihFiltre) {
                    case 'bugun':
                        return veriTarihi.toDateString() === bugun.toDateString();
                    case 'bu-hafta':
                        const haftaBasi = new Date(bugun);
                        haftaBasi.setDate(bugun.getDate() - bugun.getDay());
                        return veriTarihi >= haftaBasi;
                    case 'bu-ay':
                        return veriTarihi.getMonth() === bugun.getMonth() && 
                               veriTarihi.getFullYear() === bugun.getFullYear();
                    default:
                        return true;
                }
            });
            
            if (filtrelenVeriler.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 40px; background: white; border-radius: 10px; border: 2px solid #e9ecef;">
                        <h3>${baslik}</h3>
                        <p style="color: #666; margin-top: 15px;">Seçilen kriterlere uygun veri bulunamadı.</p>
                    </div>
                `;
                return;
            }
            
            // Tabloyu oluştur
            let html = `
                <div style="background: white; border-radius: 10px; border: 2px solid #e9ecef; overflow: hidden; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
                    <h3 style="background: linear-gradient(135deg, #3498db, #2980b9); color: white; padding: 15px; margin: 0; text-align: center;">
                        ${baslik} (${filtrelenVeriler.length} kayıt)
                    </h3>
                    <div style="overflow-x: auto; max-height: 600px;">
                        <table style="width: 100%; border-collapse: collapse; font-size: 13px;">
            `;
            
            // Tablo başlığı ve içeriği veri türüne göre oluştur
            if (veriTuru === 'kalite') {
                html += generateKaliteTablosu(filtrelenVeriler);
            } else if (veriTuru === 'performans') {
                html += generatePerformansTablosu(filtrelenVeriler);
            } else if (veriTuru === 'siparis') {
                html += generateSiparisTablosu(filtrelenVeriler);
            } else if (veriTuru === 'stok') {
                html += generateStokTablosu(filtrelenVeriler);
            } else {
                html += generateGenelTablo(filtrelenVeriler);
            }
            
            html += '</table></div></div>';
            container.innerHTML = html;
            
            // Global değişkene kaydet (export için)
            window.currentTableData = {
                data: filtrelenVeriler,
                type: veriTuru,
                title: baslik
            };
        }

        // Kalite tablosu oluştur
        function generateKaliteTablosu(veriler) {
            let html = `
                <thead style="background: #f8f9fa; position: sticky; top: 0;">
                    <tr>
                        <th style="padding: 12px 8px; border: 1px solid #dee2e6; text-align: center;">📅 Tarih</th>
                        <th style="padding: 12px 8px; border: 1px solid #dee2e6; text-align: center;">👤 Operatör</th>
                        <th style="padding: 12px 8px; border: 1px solid #dee2e6; text-align: center;">📦 Ürün Kodu</th>
                        <th style="padding: 12px 8px; border: 1px solid #dee2e6; text-align: center;">📊 Toplam Adet</th>
                        <th style="padding: 12px 8px; border: 1px solid #dee2e6; text-align: center;">🏷️ Sipariş No</th>
                        <th style="padding: 12px 8px; border: 1px solid #dee2e6; text-align: center;">🗑️ İskarta</th>
                        <th style="padding: 12px 8px; border: 1px solid #dee2e6; text-align: center;">↩️ Geri Dönen</th>
                    </tr>
                </thead>
                <tbody>
            `;
            
            veriler.slice().reverse().forEach((kayit, index) => {
                const toplamIskarta = kayit.hatalar.reduce((total, hata) => total + hata.iskartaAdet, 0);
                const toplamGeriDonen = kayit.hatalar.reduce((total, hata) => total + hata.geriGidenAdet, 0);
                
                html += `
                    <tr style="background: ${index % 2 === 0 ? '#f8f9fa' : 'white'};">
                        <td style="padding: 10px 8px; border: 1px solid #dee2e6; text-align: center;">${new Date(kayit.tarih).toLocaleString('tr-TR')}</td>
                        <td style="padding: 10px 8px; border: 1px solid #dee2e6; text-align: center;">${kayit.operator}</td>
                        <td style="padding: 10px 8px; border: 1px solid #dee2e6; text-align: center; font-weight: bold;">${kayit.urunKodu}</td>
                        <td style="padding: 10px 8px; border: 1px solid #dee2e6; text-align: center; font-weight: bold; color: #27ae60;">${kayit.toplamAdet}</td>
                        <td style="padding: 10px 8px; border: 1px solid #dee2e6; text-align: center;">${kayit.siparisNo}</td>
                        <td style="padding: 10px 8px; border: 1px solid #dee2e6; text-align: center; font-weight: bold; color: ${toplamIskarta > 0 ? '#e74c3c' : '#27ae60'};">${toplamIskarta}</td>
                        <td style="padding: 10px 8px; border: 1px solid #dee2e6; text-align: center; font-weight: bold; color: ${toplamGeriDonen > 0 ? '#f39c12' : '#27ae60'};">${toplamGeriDonen}</td>
                    </tr>
                `;
            });
            
            html += '</tbody>';
            return html;
        }

        // Performans tablosu oluştur
        function generatePerformansTablosu(veriler) {
            let html = `
                <thead style="background: #f8f9fa; position: sticky; top: 0;">
                    <tr>
                        <th style="padding: 12px 8px; border: 1px solid #dee2e6; text-align: center;">📅 Tarih</th>
                        <th style="padding: 12px 8px; border: 1px solid #dee2e6; text-align: center;">👤 Çalışan</th>
                        <th style="padding: 12px 8px; border: 1px solid #dee2e6; text-align: center;">⚡ İşlemler</th>
                        <th style="padding: 12px 8px; border: 1px solid #dee2e6; text-align: center;">👤 Ekleyen</th>
                    </tr>
                </thead>
                <tbody>
            `;
            
            veriler.slice().reverse().forEach((kayit, index) => {
                let islemlerStr = kayit.islemler.map(islem => 
                    `${islem.ad}: ${islem.adet} adet (${islem.hiz} adet/saat)`
                ).join(', ');
                
                html += `
                    <tr style="background: ${index % 2 === 0 ? '#f8f9fa' : 'white'};">
                        <td style="padding: 10px 8px; border: 1px solid #dee2e6; text-align: center;">${new Date(kayit.tarih).toLocaleDateString('tr-TR')}</td>
                        <td style="padding: 10px 8px; border: 1px solid #dee2e6; text-align: center; font-weight: bold;">${kayit.calisan}</td>
                        <td style="padding: 10px 8px; border: 1px solid #dee2e6; font-size: 11px;">${islemlerStr}</td>
                        <td style="padding: 10px 8px; border: 1px solid #dee2e6; text-align: center;">${kayit.ekleyen}</td>
                    </tr>
                `;
            });
            
            html += '</tbody>';
            return html;
        }

        // Sipariş tablosu oluştur
        function generateSiparisTablosu(veriler) {
            let html = `
                <thead style="background: #f8f9fa; position: sticky; top: 0;">
                    <tr>
                        <th style="padding: 12px 8px; border: 1px solid #dee2e6; text-align: center;">📅 Tarih</th>
                        <th style="padding: 12px 8px; border: 1px solid #dee2e6; text-align: center;">👤 Operatör</th>
                        <th style="padding: 12px 8px; border: 1px solid #dee2e6; text-align: center;">🏷️ Sipariş No</th>
                        <th style="padding: 12px 8px; border: 1px solid #dee2e6; text-align: center;">📦 Ürün Kodu</th>
                        <th style="padding: 12px 8px; border: 1px solid #dee2e6; text-align: center;">📊 Adet</th>
                        <th style="padding: 12px 8px; border: 1px solid #dee2e6; text-align: center;">📋 Durum</th>
                    </tr>
                </thead>
                <tbody>
            `;
            
            veriler.slice().reverse().forEach((kayit, index) => {
                const checkboxDurum = kayit.checkboxDurum || {};
                const tamamlananGorevler = Object.values(checkboxDurum).filter(durum => durum === true).length;
                const toplamGorevler = Object.keys(checkboxDurum).length;
                const tamamlanmaYuzdesi = toplamGorevler > 0 ? Math.round((tamamlananGorevler / toplamGorevler) * 100) : 0;
                
                html += `
                    <tr style="background: ${index % 2 === 0 ? '#f8f9fa' : 'white'};">
                        <td style="padding: 10px 8px; border: 1px solid #dee2e6; text-align: center;">${new Date(kayit.tarih).toLocaleDateString('tr-TR')}</td>
                        <td style="padding: 10px 8px; border: 1px solid #dee2e6; text-align: center;">${kayit.operator}</td>
                        <td style="padding: 10px 8px; border: 1px solid #dee2e6; text-align: center; font-weight: bold;">${kayit.siparisNo}</td>
                        <td style="padding: 10px 8px; border: 1px solid #dee2e6; text-align: center;">${kayit.urunKodu}</td>
                        <td style="padding: 10px 8px; border: 1px solid #dee2e6; text-align: center; font-weight: bold; color: #27ae60;">${kayit.siparisAdet}</td>
                        <td style="padding: 10px 8px; border: 1px solid #dee2e6; text-align: center;">
                            <span style="background: ${kayit.durum === 'tamamlandi' ? '#27ae60' : '#3498db'}; color: white; padding: 3px 8px; border-radius: 12px; font-size: 11px;">
                                ${kayit.durum} (%${tamamlanmaYuzdesi})
                            </span>
                        </td>
                    </tr>
                `;
            });
            
            html += '</tbody>';
            return html;
        }

        // Stok tablosu oluştur
        function generateStokTablosu(veriler) {
            let html = `
                <thead style="background: #f8f9fa; position: sticky; top: 0;">
                    <tr>
                        <th style="padding: 12px 8px; border: 1px solid #dee2e6; text-align: center;">🔧 Malzeme Türü</th>
                        <th style="padding: 12px 8px; border: 1px solid #dee2e6; text-align: center;">📦 Ürün Adı</th>
                        <th style="padding: 12px 8px; border: 1px solid #dee2e6; text-align: center;">📏 Ölçüler</th>
                        <th style="padding: 12px 8px; border: 1px solid #dee2e6; text-align: center;">📊 Mevcut Adet</th>
                        <th style="padding: 12px 8px; border: 1px solid #dee2e6; text-align: center;">👤 Ekleyen</th>
                        <th style="padding: 12px 8px; border: 1px solid #dee2e6; text-align: center;">🕒 Son Güncelleme</th>
                    </tr>
                </thead>
                <tbody>
            `;
            
            veriler.forEach((kayit, index) => {
                html += `
                    <tr style="background: ${index % 2 === 0 ? '#f8f9fa' : 'white'};">
                        <td style="padding: 10px 8px; border: 1px solid #dee2e6; text-align: center;">
                            <span style="background: #3498db; color: white; padding: 2px 8px; border-radius: 12px; font-size: 11px;">
                                ${kayit.malzemeTuru.toUpperCase()}
                            </span>
                        </td>
                        <td style="padding: 10px 8px; border: 1px solid #dee2e6; font-weight: bold;">${kayit.urunAdi}</td>
                        <td style="padding: 10px 8px; border: 1px solid #dee2e6; text-align: center;">${kayit.olculeri || '-'}</td>
                        <td style="padding: 10px 8px; border: 1px solid #dee2e6; text-align: center; font-weight: bold; color: ${kayit.mevcutAdet <= 5 ? '#e74c3c' : kayit.mevcutAdet <= 20 ? '#f39c12' : '#27ae60'};">${kayit.mevcutAdet}</td>
                        <td style="padding: 10px 8px; border: 1px solid #dee2e6; text-align: center;">${kayit.ekleyen}</td>
                        <td style="padding: 10px 8px; border: 1px solid #dee2e6; text-align: center; font-size: 11px;">${new Date(kayit.sonGuncelleme).toLocaleString('tr-TR')}</td>
                    </tr>
                `;
            });
            
            html += '</tbody>';
            return html;
        }

        // Genel tablo oluştur (diğer veri türleri için)
        function generateGenelTablo(veriler) {
            if (veriler.length === 0) return '<tbody></tbody>';
            
            // İlk verinin anahtarlarını al
            const anahtarlar = Object.keys(veriler[0]).filter(key => 
                key !== 'id' && key !== 'firebaseId' && typeof veriler[0][key] !== 'object'
            );
            
            let html = '<thead style="background: #f8f9fa; position: sticky; top: 0;"><tr>';
            anahtarlar.forEach(anahtar => {
                html += `<th style="padding: 12px 8px; border: 1px solid #dee2e6; text-align: center;">${anahtar}</th>`;
            });
            html += '</tr></thead><tbody>';
            
            veriler.slice().reverse().forEach((kayit, index) => {
                html += `<tr style="background: ${index % 2 === 0 ? '#f8f9fa' : 'white'};">`;
                anahtarlar.forEach(anahtar => {
                    let deger = kayit[anahtar];
                    if (anahtar.toLowerCase().includes('tarih') && deger) {
                        deger = new Date(deger).toLocaleString('tr-TR');
                    }
                    html += `<td style="padding: 10px 8px; border: 1px solid #dee2e6; text-align: center;">${deger || '-'}</td>`;
                });
                html += '</tr>';
            });
            
            html += '</tbody>';
            return html;
        }

        // Excel export fonksiyonu
        function exportCurrentData() {
            if (!window.currentTableData) {
                alert('Önce bir veri türü seçin ve verileri görüntüleyin!');
                return;
            }
            
            const { data, type, title } = window.currentTableData;
            exportToExcel(type, data, title);
        }

        // Excel'e aktar
        function exportToExcel(veriTuru, customData = null, customTitle = null) {
            let veriler = [];
            let dosyaAdi = '';
            
            if (customData && customTitle) {
                veriler = customData;
                dosyaAdi = customTitle;
            } else {
                switch (veriTuru) {
                    case 'kalite':
                        veriler = kaliteKayitlari;
                        dosyaAdi = 'kalite_kontrol_verileri';
                        break;
                    case 'performans':
                        veriler = performansKayitlari;
                        dosyaAdi = 'performans_verileri';
                        break;
                    case 'siparis':
                        veriler = siparisHazirlikKayitlari;
                        dosyaAdi = 'siparis_hazirlik_verileri';
                        break;
                    case 'hepsi':
                        veriler = {
                            kaliteKayitlari,
                            siparisHazirlikKayitlari,
                            performansKayitlari,
                            stokKayitlari,
                            temizlemeKayitlari,
                            sevkeHazirKayitlari,
                            sevkEdilenKayitlari,
                            yariMamulKayitlari
                        };
                        dosyaAdi = 'tum_veriler';
                        break;
                    default:
                        alert('Geçersiz veri türü!');
                        return;
                }
            }
            
            // CSV formatına çevir
            let csvContent = '';
            
            if (veriTuru === 'hepsi') {
                Object.entries(veriler).forEach(([kategori, veriListesi]) => {
                    if (veriListesi.length > 0) {
                        csvContent += `\n${kategori.toUpperCase()}\n`;
                        csvContent += convertToCSV(veriListesi);
                        csvContent += '\n';
                    }
                });
            } else {
                csvContent = convertToCSV(veriler);
            }
            
            // Dosyayı indir
            downloadCSV(csvContent, `${dosyaAdi}_${new Date().toISOString().slice(0, 10)}.csv`);
        }

        // CSV formatına çevir
        function convertToCSV(data) {
            if (!data || data.length === 0) return '';
            
            // Başlık satırı
            const headers = Object.keys(data[0]).filter(key => key !== 'firebaseId');
            let csv = headers.join(',') + '\n';
            
            // Veri satırları
            data.forEach(row => {
                const values = headers.map(header => {
                    let value = row[header];
                    
                    // Özel veri türleri için formatla
                    if (header === 'hatalar' && Array.isArray(value)) {
                        value = value.map(hata => 
                            `${hata.tur}:İ${hata.iskartaAdet}G${hata.geriGidenAdet}`
                        ).join(';');
                    } else if (header === 'islemler' && Array.isArray(value)) {
                        value = value.map(islem =>
                            `${islem.ad}:${islem.adet}adet/${islem.sure}dk/${islem.hiz}hız`
                        ).join(';');
                    } else if (header === 'checkboxDurum' && typeof value === 'object' && value !== null) {
                        value = Object.entries(value).map(([key, val]) => 
                            `${key}:${val ? '✓' : '✗'}`
                        ).join(';');
                    } else if (typeof value === 'object' && value !== null) {
                        value = JSON.stringify(value);
                    } else if (header.toLowerCase().includes('tarih') && value) {
                        value = new Date(value).toLocaleString('tr-TR');
                    }
                    
                    // Virgülü escape et
                    if (typeof value === 'string' && value.includes(',')) {
                        value = `"${value.replace(/"/g, '""')}"`;
                    }
                    
                    return value || '';
                });
                csv += values.join(',') + '\n';
            });
            
            return csv;
        }

        // CSV dosyasını indir
        function downloadCSV(csvContent, filename) {
            // BOM ekle (UTF-8 için)
            const BOM = '\uFEFF';
            const csvData = BOM + csvContent;
            
            const blob = new Blob([csvData], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            
            if (link.download !== undefined) {
                const url = URL.createObjectURL(blob);
                link.setAttribute('href', url);
                link.setAttribute('download', filename);
                link.style.visibility = 'hidden';
                document.body.appendChild(link);
                link.click();
                                document.body.removeChild(link);
            } else {
                // Eski tarayıcılar için
                window.open('data:text/csv;charset=utf-8,' + encodeURIComponent(csvContent));
            }
            
            showAlert('raporlarAlert', 'Veriler Excel dosyası olarak indirildi!', 'success');
        }

        // Tüm verileri JSON olarak dışa aktar
        function exportAllData() {
            const tumVeriler = {
                kaliteKayitlari,
                siparisHazirlikKayitlari,
                performansKayitlari,
                stokKayitlari,
                temizlemeKayitlari,
                sevkeHazirKayitlari,
                sevkEdilenKayitlari,
                yariMamulKayitlari,
                exportDate: new Date().toISOString(),
                version: '1.0'
            };
            
            const dataStr = JSON.stringify(tumVeriler, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = `akg_kalite_kontrol_backup_${new Date().toISOString().slice(0, 10)}.json`;
            link.click();
            
            showAlert('ayarlarAlert', 'Tüm veriler JSON dosyası olarak yedeklendi!', 'success');
        }

        // JSON dosyasından veri içe aktar
        function importData() {
            const fileInput = document.getElementById('importFile');
            const file = fileInput.files[0];
            
            if (!file) {
                showAlert('ayarlarAlert', 'Lütfen bir dosya seçin!', 'error');
                return;
            }
            
            if (file.type !== 'application/json') {
                showAlert('ayarlarAlert', 'Sadece JSON dosyaları destekleniyor!', 'error');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = async function(e) {
                try {
                    const importedData = JSON.parse(e.target.result);
                    
                    if (!importedData.version) {
                        showAlert('ayarlarAlert', 'Geçersiz yedek dosyası formatı!', 'error');
                        return;
                    }
                    
                    if (confirm('Bu işlem mevcut tüm verileri silecek ve yedek dosyasındaki verilerle değiştirecektir. Devam etmek istediğinizden emin misiniz?')) {
                        // Önce mevcut verileri temizle
                        await clearAllDataWithoutConfirm();
                        
                        // Yeni verileri içe aktar
                        const collections = [
                            'kaliteKayitlari', 'siparisHazirlikKayitlari', 'performansKayitlari',
                            'stokKayitlari', 'temizlemeKayitlari', 'sevkeHazirKayitlari',
                            'sevkEdilenKayitlari', 'yariMamulKayitlari'
                        ];
                        
                        for (const collectionName of collections) {
                            if (importedData[collectionName] && Array.isArray(importedData[collectionName])) {
                                for (const kayit of importedData[collectionName]) {
                                    const { id, firebaseId, ...cleanData } = kayit;
                                    const newData = { ...cleanData, id: Date.now() + Math.random() };
                                    await saveToFirebase(collectionName, newData);
                                }
                            }
                        }
                        
                        showAlert('ayarlarAlert', 'Veriler başarıyla içe aktarıldı!', 'success');
                        fileInput.value = '';
                        
                        // Sayfayı yenile
                        setTimeout(() => {
                            window.location.reload();
                        }, 2000);
                    }
                } catch (error) {
                    console.error('İçe aktarma hatası:', error);
                    showAlert('ayarlarAlert', 'Dosya okunamadı veya geçersiz format!', 'error');
                }
            };
            reader.readAsText(file);
        }

        // Tüm verileri temizle
        async function clearAllData() {
            if (confirm('TÜM VERİLERİ silmek istediğinizden emin misiniz? Bu işlem geri alınamaz!')) {
                if (confirm('Bu işlem kalıcıdır ve tüm kalite kontrol, sipariş, performans ve stok verilerinizi silecektir. Gerçekten devam etmek istiyor musunuz?')) {
                    await clearAllDataWithoutConfirm();
                    showAlert('ayarlarAlert', 'Tüm veriler temizlendi!', 'success');
                    
                    // Sayfayı yenile
                    setTimeout(() => {
                        window.location.reload();
                    }, 2000);
                }
            }
        }

        // Onaysız veri temizleme (import için)
        async function clearAllDataWithoutConfirm() {
            const collections = [
                'kaliteKayitlari', 'siparisHazirlikKayitlari', 'performansKayitlari',
                'stokKayitlari', 'temizlemeKayitlari', 'sevkeHazirKayitlari',
                'sevkEdilenKayitlari', 'yariMamulKayitlari'
            ];
            
            for (const collectionName of collections) {
                const currentData = window[collectionName] || [];
                for (const kayit of currentData) {
                    if (kayit.firebaseId) {
                        await deleteFromFirebase(collectionName, kayit.firebaseId, kayit.id);
                    }
                }
                // LocalStorage'ı da temizle
                localStorage.removeItem(collectionName);
            }
        }

        // Alert göster
        function showAlert(containerId, message, type = 'info') {
            const container = document.getElementById(containerId);
            if (!container) return;
            
            const alertDiv = document.createElement('div');
            alertDiv.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                z-index: 10000;
                padding: 15px 20px;
                border-radius: 8px;
                color: white;
                font-weight: bold;
                box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                animation: slideInRight 0.3s ease;
            `;
            
            switch (type) {
                case 'success':
                    alertDiv.style.background = 'linear-gradient(135deg, #27ae60, #2ecc71)';
                    alertDiv.innerHTML = '✅ ' + message;
                    break;
                case 'error':
                    alertDiv.style.background = 'linear-gradient(135deg, #e74c3c, #c0392b)';
                    alertDiv.innerHTML = '❌ ' + message;
                    break;
                case 'warning':
                    alertDiv.style.background = 'linear-gradient(135deg, #f39c12, #e67e22)';
                    alertDiv.innerHTML = '⚠️ ' + message;
                    break;
                default:
                    alertDiv.style.background = 'linear-gradient(135deg, #3498db, #2980b9)';
                    alertDiv.innerHTML = 'ℹ️ ' + message;
            }
            
            document.body.appendChild(alertDiv);
            
            // 3 saniye sonra kaldır
            setTimeout(() => {
                alertDiv.style.animation = 'slideOutRight 0.3s ease forwards';
                setTimeout(() => {
                    if (document.body.contains(alertDiv)) {
                        document.body.removeChild(alertDiv);
                    }
                }, 300);
            }, 3000);
        }

        // Tab değiştirme
        function showTab(tabName) {
            // Tüm tab içeriklerini gizle
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(tab => {
                tab.style.display = 'none';
            });
            
            // Tüm tab butonlarından active sınıfını kaldır
            const tabButtons = document.querySelectorAll('.tab-btn');
            tabButtons.forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Seçili tab'ı göster
            document.getElementById(tabName).style.display = 'block';
            
            // Seçili tab butonunu aktif yap
            event.target.classList.add('active');
            
            // Tab açıldığında verileri yükle
            switch (tabName) {
                case 'anaSayfa':
                    loadStats();
                    break;
                case 'kaliteKontrol':
                    loadKaliteKayitlari();
                    break;
                case 'siparisHazirlik':
                    loadSiparislerListesi();
                    break;
                case 'performansTakip':
                    loadPerformansKayitlari();
                    break;
                case 'stokYonetimi':
                    loadStokListesi();
                    tumStoklariOzetGoster();
                    break;
                case 'istatistikler':
                    loadIstatistikler();
                    break;
                case 'veriGoruntule':
                    loadVeriTablosu();
                    break;
                case 'temizleme':
                    loadTemizlemeKayitlari();
                    break;
                case 'sevkeHazir':
                    loadSevkeHazirKayitlari();
                    break;
                case 'sevkEdilen':
                    loadSevkEdilenKayitlari();
                    break;
                case 'yariMamulStok':
                    loadYariMamulKayitlari();
                    break;
                case 'raporlar':
                    loadStats();
                    break;
            }
        }

        // Sayfa ilk yüklendiğinde ana sayfa tab'ını göster
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                const anaSayfaBtn = document.querySelector('.tab-btn');
                if (anaSayfaBtn) {
                    anaSayfaBtn.click();
                }
            }, 100);
        });

        // Edit modal fonksiyonları (boş implementasyonlar - ileride kullanılmak üzere)
        function kaliteEdit(id) {
            console.log('Kalite edit:', id);
            // İleride implementasyon yapılacak
        }

        function siparisEdit(id) {
            console.log('Sipariş edit:', id);
            // İleride implementasyon yapılacak
        }

        function performansEdit(id) {
            console.log('Performans edit:', id);
            // İleride implementasyon yapılacak
        }

        function temizlemeEdit(id) {
            console.log('Temizleme edit:', id);
            // İleride implementasyon yapılacak
        }

        function sevkeHazirEdit(id) {
            console.log('Sevke hazır edit:', id);
            // İleride implementasyon yapılacak
        }

        function sevkEdilenEdit(id) {
            console.log('Sevk edilen edit:', id);
            // İleride implementasyon yapılacak
        }

        function yariMamulEdit(id) {
            console.log('Yarı mamül edit:', id);
            // İleride implementasyon yapılacak
        }

        // CSS animasyonları
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideInRight {
                from {
                    transform: translateX(100%);
                    opacity: 0;
                }
                to {
                    transform: translateX(0);
                    opacity: 1;
                }
            }
            
            @keyframes slideOutRight {
                from {
                    transform: translateX(0);
                    opacity: 1;
                }
                to {
                    transform: translateX(100%);
                    opacity: 0;
                }
            }
            
            @keyframes fadeIn {
                from {
                    opacity: 0;
                    transform: translateY(20px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }
            
            .kayit-item {
                animation: fadeIn 0.3s ease-in-out;
            }
            
            .stok-kayit-item {
                animation: fadeIn 0.3s ease-in-out;
            }
        `;
        document.head.appendChild(style);

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            // Ctrl + S ile hızlı kaydet
            if (e.ctrlKey && e.key === 's') {
                e.preventDefault();
                
                // Hangi tab aktifse o form submit edilsin
                const activeTab = document.querySelector('.tab-content[style*="block"]');
                if (activeTab) {
                    const form = activeTab.querySelector('form');
                    if (form) {
                        form.dispatchEvent(new Event('submit'));
                    }
                }
            }
            
            // Ctrl + E ile Excel export
            if (e.ctrlKey && e.key === 'e') {
                e.preventDefault();
                exportCurrentData();
            }
        });

        // Service Worker kaydı (offline kullanım için)
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('/sw.js').then(function(registration) {
                    console.log('ServiceWorker kayıtlı:', registration.scope);
                }, function(err) {
                    console.log('ServiceWorker kayıt hatası:', err);
                });
            });
        }

        // PWA install prompt
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            
            // Install butonunu göster
            const installBtn = document.createElement('button');
            installBtn.textContent = '📱 Uygulamayı Yükle';
            installBtn.style.cssText = `
                position: fixed;
                bottom: 20px;
                left: 20px;
                background: #3498db;
                color: white;
                border: none;
                padding: 10px 15px;
                border-radius: 25px;
                font-weight: bold;
                cursor: pointer;
                box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                z-index: 1000;
            `;
            
            installBtn.addEventListener('click', async () => {
                if (deferredPrompt) {
                    deferredPrompt.prompt();
                    const { outcome } = await deferredPrompt.userChoice;
                    console.log(`User response to the install prompt: ${outcome}`);
                    deferredPrompt = null;
                    document.body.removeChild(installBtn);
                }
            });
            
            document.body.appendChild(installBtn);
        });

        console.log('🎉 AKG Kalite Kontrol Sistemi başarıyla yüklendi!');
    </script>
</body>
</html>
