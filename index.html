<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AKG Kalite Kontrol ve Paketleme Takip Sistemi</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .tabs {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 25px;
            justify-content: center;
        }

        .tab {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
        }

        .tab:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(52, 152, 219, 0.4);
        }

        .tab.active {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            box-shadow: 0 6px 20px rgba(231, 76, 60, 0.4);
        }

        .tab-content {
            display: none;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .tab-content.active {
            display: block;
        }

        .tab-content h2 {
            color: #2c3e50;
            margin-bottom: 25px;
            font-size: 2em;
            text-align: center;
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            padding: 15px;
            border-radius: 10px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
            font-size: 1.1em;
        }

        .form-group input, .form-group select, .form-group textarea {
            padding: 12px;
            border: 2px solid #bdc3c7;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 10px rgba(52, 152, 219, 0.3);
        }

        .btn {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(39, 174, 96, 0.3);
            margin: 5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(39, 174, 96, 0.4);
        }

        .btn-success {
            background: linear-gradient(135deg, #f39c12, #e67e22);
        }

        .btn-danger {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }

        .hata-container {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 25px;
            border: 2px solid #e9ecef;
        }

        .hata-container h3 {
            color: #2c3e50;
            margin-bottom: 20px;
            text-align: center;
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
            padding: 12px;
            border-radius: 8px;
        }

        .hata-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 15px;
        }

        .hata-item {
            background: white;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #e9ecef;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: all 0.3s ease;
        }

        .hata-item:hover {
            border-color: #3498db;
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.1);
        }

        .hata-item input[type="checkbox"] {
            margin-right: 12px;
            transform: scale(1.3);
        }

        .hata-item label {
            flex-grow: 1;
            font-weight: 600;
            color: #2c3e50;
        }

        .hata-adet-container {
            display: flex;
            gap: 8px;
        }

        .hata-adet {
            width: 70px;
            padding: 8px;
            text-align: center;
            border: 2px solid #e9ecef;
            border-radius: 6px;
            font-weight: bold;
        }

        .hata-adet:first-child {
            border-color: #e74c3c;
            color: #e74c3c;
        }

        .hata-adet:last-child {
            border-color: #f39c12;
            color: #f39c12;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            padding: 25px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 6px 20px rgba(52, 152, 219, 0.3);
        }

        .stat-card h3 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .stat-card p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .alert {
            padding: 15px;
            margin: 15px 0;
            border-radius: 8px;
            font-weight: 600;
        }

        .alert-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .alert-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .kayit-item {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }

        .kayit-header {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            padding: 12px 15px;
            border-radius: 6px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 600;
        }

        .kayit-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            color: #2c3e50;
        }

        .stok-kayit-item {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }

        .stok-kayit-item:hover {
            border-color: #3498db;
            box-shadow: 0 6px 20px rgba(52, 152, 219, 0.2);
        }

        .stok-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #ecf0f1;
        }

        .stok-header h4 {
            color: #2c3e50;
            font-size: 1.3em;
        }

        .stok-bilgi {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .stok-bilgi-item {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 6px;
            border-left: 4px solid #3498db;
        }

        .stok-kontrol {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-bottom: 15px;
            padding: 15px;
            background: #ecf0f1;
            border-radius: 8px;
        }

        .stok-btn-small {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            color: white;
            border: none;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 18px;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .stok-btn-small.minus {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }

        .stok-btn-small:hover {
            transform: scale(1.1);
        }

        .stok-adet-display {
            background: white;
            padding: 8px 15px;
            border: 2px solid #3498db;
            border-radius: 6px;
            font-weight: bold;
            font-size: 1.2em;
            color: #2c3e50;
            min-width: 60px;
            text-align: center;
        }

        .stok-adet-input {
            width: 80px;
            padding: 8px;
            text-align: center;
            border: 2px solid #f39c12;
            border-radius: 6px;
            font-weight: bold;
        }

        .stok-actions {
            display: flex;
            gap: 10px;
            justify-content: center;
        }

        .btn-edit {
            background: linear-gradient(135deg, #f39c12, #e67e22);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s ease;
        }

        .btn-delete {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s ease;
        }

        .btn-edit:hover, .btn-delete:hover {
            transform: translateY(-2px);
        }

        .kaydedilmis-stoklar {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 12px;
            margin: 25px 0;
            border: 2px solid #e9ecef;
        }

        .kaydedilmis-stoklar h3 {
            color: #2c3e50;
            margin-bottom: 20px;
            text-align: center;
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            color: white;
            padding: 12px;
            border-radius: 8px;
        }

        .siparis-checkbox-container {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-top: 10px;
            border: 2px solid #e9ecef;
        }

        .siparis-checkboxes {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: background-color 0.2s ease;
        }

        .checkbox-item:hover {
            background-color: #e9ecef;
        }

        .checkbox-item input[type="checkbox"] {
            transform: scale(1.1);
        }

        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
            .hata-grid {
                grid-template-columns: 1fr;
            }
            .tabs {
                flex-direction: column;
            }
            .tab {
                width: 100%;
                margin-bottom: 5px;
            }
            .stok-bilgi {
                grid-template-columns: 1fr;
            }
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🏭 AKG Kalite Kontrol ve Paketleme Takip Sistemi</h1>
        </div>

        <!-- Tabs -->
        <div class="tabs">
            <button class="tab active" onclick="showTab('kalite-kontrol')">🔍 Kalite Kontrol</button>
            <button class="tab" onclick="showTab('siparis-hazirlik')">📋 Sipariş Hazırlığı</button>
            <button class="tab" onclick="showTab('stok')">📦 Stok Yönetimi</button>
            <button class="tab" onclick="showTab('temizleme')">🧽 Temizlemeye Gidecek Ürünler</button>
            <button class="tab" onclick="showTab('sevke-hazir')">📤 Sevke Hazır Ürünler</button>
            <button class="tab" onclick="showTab('sevk-edilen')">🚚 Sevk Edilen Ürünler</button>
            <button class="tab" onclick="showTab('yari-mamul')">🔧 Yarı Mamül Stok</button>
            <button class="tab" onclick="showTab('gunluk-performans')">⚡ Günlük Performans</button>
            <button class="tab" onclick="showTab('istatistikler')">📈 İstatistikler</button>
            <button class="tab" onclick="showTab('veri-goruntule')">📊 Veri Görüntüle</button>
            <button class="tab" onclick="showTab('raporlar')">📋 Raporlar</button>
            <button class="tab" onclick="showTab('ayarlar')">⚙️ Ayarlar</button>
        </div>

        <!-- Kalite Kontrol Tab -->
        <div id="kalite-kontrol" class="tab-content active">
            <h2>🔍 Kalite Kontrol Formu</h2>
            <form id="kaliteForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="tarih">📅 Tarih/Saat</label>
                        <input type="datetime-local" id="tarih" required>
                    </div>
                    <div class="form-group">
                        <label for="operator">👤 Operatörün Adı</label>
                        <select id="operator" required>
                            <option value="">Operatör seçin</option>
                            <option value="Esat">Esat</option>
                            <option value="Ahmet">Ahmet</option>
                            <option value="Emre">Emre</option>
                            <option value="Gökay">Gökay</option>
                            <option value="Berke">Berke</option>
                            <option value="Melisa">Melisa</option>
                            <option value="Evrim">Evrim</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="urunKodu">📦 Ürün Kodu</label>
                        <input type="text" id="urunKodu" placeholder="Ürün kodunu girin" required>
                    </div>
                    <div class="form-group">
                        <label for="toplamAdet">📊 Toplam Adet</label>
                        <input type="number" id="toplamAdet" min="1" placeholder="Toplam ürün adedi" required>
                    </div>
                    <div class="form-group">
                        <label for="siparisNo">🏷️ Sipariş Numarası</label>
                        <input type="text" id="siparisNo" placeholder="Sipariş numarasını girin" required>
                    </div>
                </div>

                <div class="hata-container">
                    <h3>🚫 Hata Türleri ve Adetleri</h3>
                    <div style="display: flex; justify-content: flex-end; margin-bottom: 15px; gap: 8px; font-size: 12px; color: #666; font-weight: bold;">
                        <span style="color: #e74c3c; width: 70px; text-align: center;">İskarta</span>
                        <span style="color: #f39c12; width: 70px; text-align: center;">Geri Giden</span>
                    </div>
                    <div class="hata-grid">
                        <div class="hata-item">
                            <input type="checkbox" id="hata1" name="hatalar" value="Ağız yamukluğu">
                            <label for="hata1">Ağız yamukluğu</label>
                            <div class="hata-adet-container">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                            </div>
                        </div>
                        <div class="hata-item">
                            <input type="checkbox" id="hata2" name="hatalar" value="Yetersiz kaynak">
                            <label for="hata2">Yetersiz kaynak</label>
                            <div class="hata-adet-container">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                            </div>
                        </div>
                        <div class="hata-item">
                            <input type="checkbox" id="hata3" name="hatalar" value="Fazla kaynak">
                            <label for="hata3">Fazla kaynak</label>
                            <div class="hata-adet-container">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                            </div>
                        </div>
                        <div class="hata-item">
                            <input type="checkbox" id="hata4" name="hatalar" value="Bakır erimesi">
                            <label for="hata4">Bakır erimesi</label>
                            <div class="hata-adet-container">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                            </div>
                        </div>
                        <div class="hata-item">
                            <input type="checkbox" id="hata5" name="hatalar" value="Dışa kaynak akması">
                            <label for="hata5">Dışa kaynak akması</label>
                            <div class="hata-adet-container">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                            </div>
                        </div>
                        <div class="hata-item">
                            <input type="checkbox" id="hata6" name="hatalar" value="Vuruk">
                            <label for="hata6">Vuruk</label>
                            <div class="hata-adet-container">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                            </div>
                        </div>
                        <div class="hata-item">
                            <input type="checkbox" id="hata7" name="hatalar" value="Boğum uzunluğu farklılığı">
                            <label for="hata7">Boğum uzunluğu farklılığı</label>
                            <div class="hata-adet-container">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                            </div>
                        </div>
                        <div class="hata-item">
                            <input type="checkbox" id="hata8" name="hatalar" value="Boğum yamukluğu">
                            <label for="hata8">Boğum yamukluğu</label>
                            <div class="hata-adet-container">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                            </div>
                        </div>
                        <div class="hata-item">
                            <input type="checkbox" id="hata9" name="hatalar" value="Çizik ürün">
                            <label for="hata9">Çizik ürün</label>
                            <div class="hata-adet-container">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                            </div>
                        </div>
                        <div class="hata-item">
                            <input type="checkbox" id="hata10" name="hatalar" value="Temizlenememiş ürün">
                            <label for="hata10">Temizlenememiş ürün</label>
                            <div class="hata-adet-container">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                            </div>
                        </div>
                        <div class="hata-item">
                            <input type="checkbox" id="hata11" name="hatalar" value="Bilyeli ürün">
                            <label for="hata11">Bilyeli ürün</label>
                            <div class="hata-adet-container">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                            </div>
                        </div>
                        <div class="hata-item">
                            <input type="checkbox" id="hataDiger" name="hatalar" value="Diğer">
                            <label for="hataDiger">Diğer</label>
                            <div class="hata-adet-container">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                            </div>
                        </div>
                    </div>
                    <div id="digerHataDetay" style="display: none; margin-top: 15px;">
                        <label for="digerHataAciklama" style="display: block; margin-bottom: 5px; font-weight: bold;">Diğer Hata Açıklaması:</label>
                        <input type="text" id="digerHataAciklama" placeholder="Hata detayını yazın..." style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 6px;">
                    </div>
                </div>

                <button type="submit" class="btn">💾 Kalite Kontrol Kaydını Kaydet</button>
            </form>
            <div id="kaliteAlert"></div>

            <!-- Kalite Kontrol Kayıtları Tablosu -->
            <div id="kaliteKayitlari">
                <h3>📋 Kalite Kontrol Kayıtları</h3>
                <div id="kaliteKayitlariListesi"></div>
            </div>
        </div>

        <!-- Sipariş Hazırlığı Tab -->
        <div id="siparis-hazirlik" class="tab-content">
            <h2>📋 Sipariş Hazırlığı</h2>
            <!-- Sipariş Ekleme Formu -->
            <form id="siparisEkleForm">
                <h3>➕ Yeni Sipariş Ekle</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="hazirlikTarih">📅 Tarih</label>
                        <input type="date" id="hazirlikTarih" required>
                    </div>
                    <div class="form-group">
                        <label for="hazirlikOperator">👤 Operatör</label>
                        <select id="hazirlikOperator" required>
                            <option value="">Operatör seçin</option>
                            <option value="Esat">Esat</option>
                            <option value="Ahmet">Ahmet</option>
                            <option value="Emre">Emre</option>
                            <option value="Gökay">Gökay</option>
                            <option value="Berke">Berke</option>
                            <option value="Melisa">Melisa</option>
                            <option value="Evrim">Evrim</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="hazirlikSiparisNo">🏷️ Sipariş No</label>
                        <input type="text" id="hazirlikSiparisNo" placeholder="Sipariş numarası" required>
                    </div>
                    <div class="form-group">
                        <label for="urunKoduSiparis">📦 Ürün Kodu</label>
                        <input type="text" id="urunKoduSiparis" placeholder="Ürün kodu" required>
                    </div>
                    <div class="form-group">
                        <label for="siparisAdet">📊 Sipariş Adedi</label>
                        <input type="number" id="siparisAdet" min="1" placeholder="Toplam adet" required>
                    </div>
                </div>
                <button type="submit" class="btn">➕ Sipariş Ekle</button>
            </form>
            <div id="siparisEkleAlert"></div>

            <!-- Siparişler Listesi -->
            <div id="siparislerContainer">
                <h3>📋 Mevcut Siparişler</h3>
                <div id="siparislerListesi"></div>
            </div>
        </div>

        <!-- Stok Yönetimi Tab -->
        <div id="stok" class="tab-content">
            <h2>📦 Stok Yönetimi</h2>
            <!-- Stok Ekleme Formu -->
            <form id="stokForm">
                <h3>➕ Stok Ekle/Güncelle</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="stokMalzemeTuru">🔧 Malzeme Türü</label>
                        <select id="stokMalzemeTuru" required>
                            <option value="">Malzeme türünü seçin</option>
                            <option value="izolasyon">İzolasyon</option>
                            <option value="koli">Koli</option>
                            <option value="kutu">Kutu</option>
                            <option value="poset">Poşet</option>
                            <option value="tapa">Tapa</option>
                            <option value="etiket">Etiket</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="stokUrunAdi">📦 Ürün Adı</label>
                        <input type="text" id="stokUrunAdi" placeholder="Ürün adını yazın" required>
                    </div>
                    <div class="form-group">
                        <label for="stokOlculeri">📏 Ölçüler (İsteğe Bağlı)</label>
                        <input type="text" id="stokOlculeri" placeholder="Örn: 25x15x10 cm">
                    </div>
                    <div class="form-group">
                        <label for="stokMevcut">📊 Mevcut Adet</label>
                        <input type="number" id="stokMevcut" min="0" placeholder="Mevcut adet" required>
                    </div>
                    <div class="form-group">
                        <label for="stokEkleyen">👤 Verileri Ekleyen</label>
                        <select id="stokEkleyen" required>
                            <option value="">Kişi seçin</option>
                            <option value="Esat">Esat</option>
                            <option value="Ahmet">Ahmet</option>
                            <option value="Emre">Emre</option>
                            <option value="Gökay">Gökay</option>
                            <option value="Berke">Berke</option>
                            <option value="Melisa">Melisa</option>
                            <option value="Evrim">Evrim</option>
                        </select>
                    </div>
                </div>
                <div style="text-align: center; margin-top: 20px;">
                    <button type="submit" class="btn">💾 Stok Kaydet</button>
                    <button type="button" class="btn btn-success" onclick="temizleStokFormu()">🧹 Formu Temizle</button>
                </div>
            </form>
            <div id="stokAlert"></div>

            <!-- Stok Yönetim Butonları -->
            <div style="text-align: center; margin: 25px 0;">
                <button class="btn btn-success" onclick="tumStoklariYukle()">🔄 Stokları Yenile</button>
                <button class="btn btn-danger" onclick="tumStoklariSifirla()">🗑️ Tüm Stokları Sil</button>
            </div>

            <!-- Tüm Stoklar Özeti -->
            <div class="kaydedilmis-stoklar">
                <h3>📦 Tüm Stoklar Özeti</h3>
                <div id="stokOzeti"></div>
            </div>

            <!-- Stoklar Listesi -->
            <div id="stokListesiContainer">
                <h3>📋 Kayıtlı Stoklar</h3>
                <div id="stokListesi"></div>
            </div>
        </div>

        <!-- Temizlemeye Gidecek Ürünler Tab -->
        <div id="temizleme" class="tab-content">
            <h2>🧽 Temizlemeye Gidecek Ürünler</h2>
            <form id="temizlemeForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="temizlemeSiparisNo">🏷️ Sipariş No</label>
                        <input type="text" id="temizlemeSiparisNo" placeholder="Sipariş numarası" required>
                    </div>
                    <div class="form-group">
                        <label for="temizlemeUrunKodu">📦 Ürün Kodu</label>
                        <input type="text" id="temizlemeUrunKodu" placeholder="Ürün kodu" required>
                    </div>
                    <div class="form-group">
                        <label for="temizlemeSiparisAdet">📊 Sipariş Adeti</label>
                        <input type="number" id="temizlemeSiparisAdet" min="0" placeholder="Sipariş adeti" required>
                    </div>
                    <div class="form-group">
                        <label for="temizlemeGelenAdet">📦 Gelen Ürün Adeti</label>
                        <input type="number" id="temizlemeGelenAdet" min="0" placeholder="Gelen ürün adeti" required>
                    </div>
                    <div class="form-group">
                        <label for="temizlemeAdetKg">⚖️ Adet KG</label>
                        <input type="number" id="temizlemeAdetKg" step="0.01" min="0" placeholder="Adet kg" required>
                    </div>
                    <div class="form-group">
                        <label for="temizlemeToplamKg">⚖️ Toplam KG</label>
                        <input type="number" id="temizlemeToplamKg" step="0.01" min="0" placeholder="Toplam kg" required>
                    </div>
                    <div class="form-group">
                        <label for="temizlemeEkleyen">👤 Verileri Ekleyen</label>
                        <select id="temizlemeEkleyen" required>
                            <option value="">Kişi seçin</option>
                            <option value="Esat">Esat</option>
                            <option value="Ahmet">Ahmet</option>
                            <option value="Emre">Emre</option>
                            <option value="Gökay">Gökay</option>
                            <option value="Berke">Berke</option>
                            <option value="Melisa">Melisa</option>
                            <option value="Evrim">Evrim</option>
                        </select>
                    </div>
                </div>
                <button type="submit" class="btn">💾 Temizleme Kaydını Kaydet</button>
            </form>
            <div id="temizlemeAlert"></div>

            <div id="temizlemeListesi">
                <h3>📋 Temizlemeye Gidecek Ürünler Listesi</h3>
                <div id="temizlemeKayitlari"></div>
            </div>
        </div>

        <!-- Sevke Hazır Ürünler Tab -->
        <div id="sevke-hazir" class="tab-content">
            <h2>📤 Sevke Hazır Ürünler</h2>
            <form id="sevkeHazirForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="sevkeSiparisNo">🏷️ Sipariş No</label>
                        <input type="text" id="sevkeSiparisNo" placeholder="Sipariş numarası" required>
                    </div>
                    <div class="form-group">
                        <label for="sevkeUrunNo">📦 Ürün No</label>
                        <input type="text" id="sevkeUrunNo" placeholder="Ürün numarası" required>
                    </div>
                    <div class="form-group">
                        <label for="sevkeHazirAdet">📊 Sevke Hazır Ürün Adeti</label>
                        <input type="number" id="sevkeHazirAdet" min="0" placeholder="Sevke hazır adet" required>
                    </div>
                    <div class="form-group">
                        <label for="sevkeKoliAdet">📦 Koli Adeti</label>
                        <input type="number" id="sevkeKoliAdet" min="0" placeholder="Koli adeti" required>
                    </div>
                    <div class="form-group">
                        <label for="sevkeHazirEkleyen">👤 Verileri Ekleyen</label>
                        <select id="sevkeHazirEkleyen" required>
                            <option value="">Kişi seçin</option>
                            <option value="Esat">Esat</option>
                            <option value="Ahmet">Ahmet</option>
                            <option value="Emre">Emre</option>
                            <option value="Gökay">Gökay</option>
                            <option value="Berke">Berke</option>
                            <option value="Melisa">Melisa</option>
                            <option value="Evrim">Evrim</option>
                        </select>
                    </div>
                </div>
                <button type="submit" class="btn">💾 Sevke Hazır Kaydını Kaydet</button>
            </form>
            <div id="sevkeHazirAlert"></div>

            <div id="sevkeHazirListesi">
                <h3>📋 Sevke Hazır Ürünler Listesi</h3>
                <div id="sevkeHazirKayitlari"></div>
            </div>
        </div>

        <!-- Sevk Edilen Ürünler Tab -->
        <div id="sevk-edilen" class="tab-content">
            <h2>🚚 Sevk Edilen Ürün Listesi</h2>
            <form id="sevkEdilenForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="sevkSiparisNo">🏷️ Sipariş No</label>
                        <input type="text" id="sevkSiparisNo" placeholder="Sipariş numarası" required>
                    </div>
                    <div class="form-group">
                        <label for="sevkUrunTuru">📦 Ürün Türü</label>
                        <input type="text" id="sevkUrunTuru" placeholder="Ürün türü" required>
                    </div>
                    <div class="form-group">
                        <label for="sevkUrunNo">📦 Ürün No</label>
                        <input type="text" id="sevkUrunNo" placeholder="Ürün numarası" required>
                    </div>
                    <div class="form-group">
                        <label for="sevkTeslimTarih">📅 Teslim Edilen Tarih</label>
                        <input type="date" id="sevkTeslimTarih" required>
                    </div>
                    <div class="form-group">
                        <label for="sevkTeslimAdet">📊 Teslim Edilen Adet</label>
                        <input type="number" id="sevkTeslimAdet" min="0" placeholder="Teslim edilen adet" required>
                    </div>
                    <div class="form-group">
                        <label for="sevkTeslimAlan">👤 Teslim Alan</label>
                        <input type="text" id="sevkTeslimAlan" placeholder="Teslim alan kişi" required>
                    </div>
                    <div class="form-group">
                        <label for="sevkDepoIrsaliye">📋 Depo Giriş İrsaliyesi</label>
                        <input type="text" id="sevkDepoIrsaliye" placeholder="İrsaliye numarası" required>
                    </div>
                    <div class="form-group">
                        <label for="sevkEdilenEkleyen">👤 Verileri Ekleyen</label>
                        <select id="sevkEdilenEkleyen" required>
                            <option value="">Kişi seçin</option>
                            <option value="Esat">Esat</option>
                            <option value="Ahmet">Ahmet</option>
                            <option value="Emre">Emre</option>
                            <option value="Gökay">Gökay</option>
                            <option value="Berke">Berke</option>
                            <option value="Melisa">Melisa</option>
                            <option value="Evrim">Evrim</option>
                        </select>
                    </div>
                </div>
                <button type="submit" class="btn">💾 Sevk Kaydını Kaydet</button>
            </form>
            <div id="sevkEdilenAlert"></div>

            <div id="sevkEdilenListesi">
                <h3>📋 Sevk Edilen Ürünler Listesi</h3>
                <div id="sevkEdilenKayitlari"></div>
            </div>
        </div>

        <!-- Yarı Mamül Stok Tab -->
        <div id="yari-mamul" class="tab-content">
            <h2>🔧 Yarı Mamül Stok</h2>
            <form id="yariMamulForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="yariMamulUrunAdi">📦 Ürün Adı</label>
                        <input type="text" id="yariMamulUrunAdi" placeholder="Ürün adını yazın" required>
                    </div>
                    <div class="form-group">
                        <label for="yariMamulAdet">📊 Adeti</label>
                        <input type="number" id="yariMamulAdet" min="0" placeholder="Adet" required>
                    </div>
                    <div class="form-group">
                        <label for="yariMamulHangiParca">🔧 Hangi Parça</label>
                        <input type="text" id="yariMamulHangiParca" placeholder="Parça bilgisi" required>
                    </div>
                    <div class="form-group">
                        <label for="yariMamulNot">📝 Not</label>
                        <textarea id="yariMamulNot" rows="3" placeholder="Not yazın..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="yariMamulEkleyen">👤 Verileri Ekleyen</label>
                        <select id="yariMamulEkleyen" required>
                            <option value="">Kişi seçin</option>
                            <option value="Esat">Esat</option>
                            <option value="Ahmet">Ahmet</option>
                            <option value="Emre">Emre</option>
                            <option value="Gökay">Gökay</option>
                            <option value="Berke">Berke</option>
                            <option value="Melisa">Melisa</option>
                            <option value="Evrim">Evrim</option>
                        </select>
                    </div>
                </div>
                <button type="submit" class="btn">💾 Yarı Mamül Kaydını Kaydet</button>
            </form>
            <div id="yariMamulAlert"></div>

            <div id="yariMamulListesi">
                <h3>📋 Yarı Mamül Stok Listesi</h3>
                <div id="yariMamulKayitlari"></div>
            </div>
        </div>

        <!-- Günlük Performans Tab -->
        <div id="gunluk-performans" class="tab-content">
            <h2>⚡ Günlük Performans Takibi</h2>
            <form id="performansForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="performansTarih">📅 Tarih</label>
                        <input type="date" id="performansTarih" required>
                    </div>
                    <div class="form-group">
                        <label for="performansCalisan">👤 Çalışan Adı</label>
                        <select id="performansCalisan" required>
                            <option value="">Çalışan seçin</option>
                            <option value="Esat">Esat</option>
                            <option value="Ahmet">Ahmet</option>
                            <option value="Emre">Emre</option>
                            <option value="Gökay">Gökay</option>
                            <option value="Berke">Berke</option>
                            <option value="Melisa">Melisa</option>
                            <option value="Evrim">Evrim</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="performansEkleyen">👤 Verileri Ekleyen</label>
                        <select id="performansEkleyen" required>
                            <option value="">Kişi seçin</option>
                            <option value="Esat">Esat</option>
                            <option value="Ahmet">Ahmet</option>
                            <option value="Emre">Emre</option>
                            <option value="Gökay">Gökay</option>
                            <option value="Berke">Berke</option>
                            <option value="Melisa">Melisa</option>
                            <option value="Evrim">Evrim</option>
                        </select>
                    </div>
                </div>

                <div class="hata-container">
                    <h3>🏭 İşlem Performansları</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <h4>📦 Kutu Hazırlığı</h4>
                            <input type="text" id="kutuHazirlikUrun" placeholder="Ürün adı">
                            <input type="number" id="kutuHazirlikAdet" placeholder="Adet" min="0">
                            <input type="number" id="kutuHazirlikSure" placeholder="Süre (dk)" min="0">
                        </div>
                        <div class="form-group">
                            <h4>📋 Koli Hazırlama</h4>
                            <input type="text" id="koliHazirlamaUrun" placeholder="Ürün adı">
                            <input type="number" id="koliHazirlamaAdet" placeholder="Adet" min="0">
                            <input type="number" id="koliHazirlamaSure" placeholder="Süre (dk)" min="0">
                        </div>
                        <div class="form-group">
                            <h4>🔧 İzolasyon</h4>
                            <input type="text" id="izolasyonUrunPerf" placeholder="Ürün adı">
                            <input type="number" id="izolasyonAdetPerf" placeholder="Adet" min="0">
                            <input type="number" id="izolasyonSure" placeholder="Süre (dk)" min="0">
                        </div>
                        <div class="form-group">
                            <h4>🔍 Kalite Kontrol</h4>
                            <input type="text" id="kaliteKontrolUrun" placeholder="Ürün adı">
                            <input type="number" id="kaliteKontrolAdet" placeholder="Adet" min="0">
                            <input type="number" id="kaliteKontrolSure" placeholder="Süre (dk)" min="0">
                        </div>
                        <div class="form-group">
                            <h4>🛍️ Poşetleme</h4>
                            <input type="text" id="posetlemeUrunPerf" placeholder="Ürün adı">
                            <input type="number" id="posetlemeAdetPerf" placeholder="Adet" min="0">
                            <input type="number" id="posetlemeSure" placeholder="Süre (dk)" min="0">
                        </div>
                        <div class="form-group">
                            <h4>📦 Ürün Kutulama</h4>
                            <input type="text" id="urunKutulamaUrun" placeholder="Ürün adı">
                            <input type="number" id="urunKutulamaAdet" placeholder="Adet" min="0">
                            <input type="number" id="urunKutulamaSure" placeholder="Süre (dk)" min="0">
                        </div>
                        <div class="form-group">
                            <h4>🔩 Ek Parça</h4>
                            <input type="text" id="ekParcaUrunPerf" placeholder="Ürün adı">
                            <input type="number" id="ekParcaAdetPerf" placeholder="Adet" min="0">
                            <input type="number" id="ekParcaSure" placeholder="Süre (dk)" min="0">
                        </div>
                    </div>
                </div>

                <button type="submit" class="btn">💾 Performans Kaydını Kaydet</button>
            </form>
            <div id="performansAlert"></div>

            <!-- Son Performans Kayıtları -->
            <div id="performansKayitlariContainer">
                <h3>📊 Son Performans Kayıtları</h3>
                <div id="performansKayitlariListesi"></div>
            </div>
        </div>

        <!-- İstatistikler Tab -->
        <div id="istatistikler" class="tab-content">
            <h2>📈 İstatistikler</h2>
            <div class="stats-grid">
                <div class="stat-card">
                    <h3 id="toplamKaliteKayit">0</h3>
                    <p>Toplam Kalite Kontrol</p>
                </div>
                <div class="stat-card">
                    <h3 id="toplamSiparisKayit">0</h3>
                    <p>Toplam Sipariş</p>
                </div>
                <div class="stat-card">
                    <h3 id="toplamPerformansKayit">0</h3>
                    <p>Toplam Performans</p>
                </div>
                <div class="stat-card">
                    <h3 id="tamamlananSiparis">0</h3>
                    <p>Tamamlanan Sipariş</p>
                </div>
                <div class="stat-card">
                    <h3 id="toplamHataAdet">0</h3>
                    <p>Toplam Hatalı Ürün</p>
                </div>
                <div class="stat-card">
                    <h3 id="basariOrani">0%</h3>
                    <p>Başarı Oranı</p>
                </div>
            </div>

            <div style="background: white; padding: 25px; border-radius: 10px; border: 2px solid #e9ecef; margin-bottom: 20px;">
                <h4 style="color: #2c3e50; margin-bottom: 15px; text-align: center; background: linear-gradient(135deg, #3498db, #2980b9); color: white; padding: 12px; border-radius: 6px;">📊 Hata İstatistikleri</h4>
                <div id="hataIstatistikleri"></div>
            </div>

            <div style="background: white; padding: 25px; border-radius: 10px; border: 2px solid #e9ecef; margin-bottom: 20px;">
                <h4 style="color: #2c3e50; margin-bottom: 15px; text-align: center; background: linear-gradient(135deg, #3498db, #2980b9); color: white; padding: 12px; border-radius: 6px;">⏱️ Performans İstatistikleri</h4>
                <div id="performansIstatistikleri"></div>
            </div>

            <div style="background: white; padding: 25px; border-radius: 10px; border: 2px solid #e9ecef; margin-bottom: 20px;">
                <h4 style="color: #2c3e50; margin-bottom: 15px; text-align: center; background: linear-gradient(135deg, #3498db, #2980b9); color: white; padding: 12px; border-radius: 6px;">👥 Çalışan Bazlı İstatistikler</h4>
                <div id="calisanIstatistikleri"></div>
            </div>
        </div>

        <!-- Veri Görüntüle Tab -->
        <div id="veri-goruntule" class="tab-content">
            <h2>📊 Veri Görüntüle</h2>
            <div class="form-grid" style="margin-bottom: 20px;">
                <div class="form-group">
                    <label for="veriTuru">🔍 Veri Türü</label>
                    <select id="veriTuru" onchange="loadVeriTablosu()">
                        <option value="kalite">Kalite Kontrol Verileri</option>
                        <option value="siparis">Sipariş Hazırlık Verileri</option>
                        <option value="performans">Performans Verileri</option>
                        <option value="stok">Stok Verileri</option>
                        <option value="temizleme">Temizleme Verileri</option>
                        <option value="sevkeHazir">Sevke Hazır Verileri</option>
                        <option value="sevkEdilen">Sevk Edilen Verileri</option>
                        <option value="yariMamul">Yarı Mamül Stok Verileri</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="tarihFiltre">📅 Tarih Filtresi</label>
                    <select id="tarihFiltre" onchange="loadVeriTablosu()">
                        <option value="hepsi">Tüm Tarihler</option>
                        <option value="bugun">Bugün</option>
                        <option value="bu-hafta">Bu Hafta</option>
                        <option value="bu-ay">Bu Ay</option>
                    </select>
                </div>
            </div>
            <div id="veriTablosuContainer"></div>
            <div style="margin-top: 20px; text-align: center;">
                <button class="btn" onclick="exportCurrentData()">📥 Görüntülenen Verileri Excel'e Aktar</button>
            </div>
        </div>

        <!-- Raporlar Tab -->
        <div id="raporlar" class="tab-content">
            <h2>📋 Raporlar</h2>
            <div class="stats-grid">
                <div class="stat-card">
                    <h3 id="toplamKayit">0</h3>
                    <p>Toplam Kalite Kontrol Kaydı</p>
                </div>
                <div class="stat-card">
                    <h3 id="toplamSiparis">0</h3>
                    <p>Sipariş Hazırlık Kaydı</p>
                </div>
                <div class="stat-card">
                    <h3 id="toplamPerformans">0</h3>
                    <p>Performans Kaydı</p>
                </div>
                <div class="stat-card">
                    <h3 id="stokSayisi">0</h3>
                    <p>Stok Kalemi</p>
                </div>
            </div>

            <div style="margin-top: 30px;">
                <button class="btn" onclick="exportToExcel('kalite')">📥 Kalite Verilerini Excel'e Aktar</button>
                <button class="btn btn-success" onclick="exportToExcel('performans')">📥 Performans Verilerini Excel'e Aktar</button>
                <button class="btn" onclick="exportToExcel('siparis')">📥 Sipariş Verilerini Excel'e Aktar</button>
                <button class="btn btn-danger" onclick="exportToExcel('hepsi')">📥 Tüm Verileri Excel'e Aktar</button>
            </div>
        </div>

        <!-- Ayarlar Tab -->
        <div id="ayarlar" class="tab-content">
            <h2>⚙️ Sistem Ayarları</h2>
            <div class="form-grid">
                <div class="form-group">
                    <label>💾 Veri Yedekleme</label>
                    <button class="btn" onclick="exportAllData()">Tüm Verileri Yedekle (JSON)</button>
                </div>
                <div class="form-group">
                    <label>📤 Veri Geri Yükleme</label>
                    <input type="file" id="importFile" accept=".json" onchange="importData()">
                </div>
                <div class="form-group">
                    <label>🗑️ Veri Temizleme</label>
                    <button class="btn btn-danger" onclick="clearAllData()">Tüm Verileri Temizle</button>
                </div>
            </div>
        </div>

        <!-- Modal for Editing -->
        <div id="editModal" style="display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5);">
            <div style="background-color: white; margin: 5% auto; padding: 20px; border-radius: 10px; width: 90%; max-width: 800px; max-height: 80vh; overflow-y: auto;">
                <span style="color: #aaa; float: right; font-size: 28px; font-weight: bold; cursor: pointer;" onclick="document.getElementById('editModal').style.display='none'">&times;</span>
                <h3>✏️ Düzenle</h3>
                <div id="editFormContainer"></div>
            </div>
        </div>
    </div>

    <script>
        <script>
    // Firebase konfigürasyonu
    const firebaseConfig = {
            apiKey: "AIzaSyDJYEEnWdlfzCVFg-w_IIWE5QbNFzN9hqA",
            authDomain: "akgkalitekontrol.firebaseapp.com",
            databaseURL: "https://akgkalitekontrol-default-rtdb.firebaseio.com",
            projectId: "akgkalitekontrol",
            storageBucket: "akgkalitekontrol.firebasestorage.app",
            messagingSenderId: "315960243910",
            appId: "1:315960243910:web:bb97b559d7d6648e5fc9c7",
    };

    // Firebase'i başlat
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // Firebase yardımcı fonksiyonları
    async function saveToFirebase(collection, data) {
        try {
            if (data.id) {
                // Güncelleme
                await db.collection(collection).doc(data.id.toString()).set(data);
            } else {
                // Yeni kayıt
                await db.collection(collection).add(data);
            }
            console.log(`${collection} başarıyla Firebase'e kaydedildi`);
        } catch (error) {
            console.error(`Firebase kaydetme hatası (${collection}):`, error);
            // Hata durumunda localStorage'a kaydet
            let localData = JSON.parse(localStorage.getItem(collection + 'Failed') || '[]');
            localData.push(data);
            localStorage.setItem(collection + 'Failed', JSON.stringify(localData));
        }
    }

    async function loadFromFirebase(collection) {
        try {
            const snapshot = await db.collection(collection).orderBy('id', 'desc').get();
            const data = [];
            snapshot.forEach(doc => {
                data.push({ id: doc.id, ...doc.data() });
            });
            return data;
        } catch (error) {
            console.error(`Firebase yükleme hatası (${collection}):`, error);
            // Hata durumunda localStorage'dan yükle
            return JSON.parse(localStorage.getItem(collection) || '[]');
        }
    }

    async function deleteFromFirebase(collection, id) {
        try {
            await db.collection(collection).doc(id.toString()).delete();
            console.log(`${collection} kaydı Firebase'den silindi`);
        } catch (error) {
            console.error(`Firebase silme hatası (${collection}):`, error);
        }
    }

    // Çevrimdışı durumu kontrol et
    let isOnline = navigator.onLine;
    window.addEventListener('online', () => {
        isOnline = true;
        console.log('İnternet bağlantısı yeniden kuruldu');
        syncFailedData();
    });
    window.addEventListener('offline', () => {
        isOnline = false;
        console.log('İnternet bağlantısı kesildi - localStorage kullanılacak');
    });

    // Başarısız kayıtları senkronize et
    async function syncFailedData() {
        const collections = ['kaliteKayitlari', 'siparisHazirlikKayitlari', 'performansKayitlari', 
                           'stokKayitlari', 'temizlemeKayitlari', 'sevkeHazirKayitlari', 
                           'sevkEdilenKayitlari', 'yariMamulKayitlari'];
        
        for (const collection of collections) {
            const failedData = JSON.parse(localStorage.getItem(collection + 'Failed') || '[]');
            if (failedData.length > 0) {
                for (const data of failedData) {
                    await saveToFirebase(collection, data);
                }
                localStorage.removeItem(collection + 'Failed');
                console.log(`${collection} başarısız kayıtları senkronize edildi`);
            }
        }
    }

    // Global değişkenler (mevcut kodunuz)
    let kaliteKayitlari = [];
    let siparisHazirlikKayitlari = [];
    let performansKayitlari = [];
    let stokKayitlari = [];
    let temizlemeKayitlari = [];
    let sevkeHazirKayitlari = [];
    let sevkEdilenKayitlari = [];
    let yariMamulKayitlari = [];

    // Sayfa yüklendiğinde Firebase'den veri yükle
    document.addEventListener('DOMContentLoaded', async function() {
        // Mevcut kodunuzdaki başlangıç işlemleri
        const now = new Date();
        const nowString = now.toISOString().slice(0, 16);
        const today = now.toISOString().slice(0, 10);
        document.getElementById('tarih').value = nowString;
        document.getElementById('hazirlikTarih').value = today;
        document.getElementById('performansTarih').value = today;
        document.getElementById('sevkTeslimTarih').value = today;

        // Firebase'den verileri yükle
        await loadAllDataFromFirebase();
        
        // Mevcut fonksiyonlarınızı çağır
        loadStats();
        loadStokListesi();
        loadKaliteKayitlari();
        loadSiparislerListesi();
        loadIstatistikler();
        loadVeriTablosu();
        tumStoklariOzetGoster();
        loadTemizlemeKayitlari();
        loadSevkeHazirKayitlari();
        loadSevkEdilenKayitlari();
        loadYariMamulKayitlari();

        // Event listener'lar (mevcut kodunuz)
        document.getElementById('stokForm').addEventListener('submit', stokEkleGuncelle);
        document.getElementById('hataDiger').addEventListener('change', function() {
            const digerDetay = document.getElementById('digerHataDetay');
            digerDetay.style.display = this.checked ? 'block' : 'none';
        });
        document.getElementById('temizlemeForm').addEventListener('submit', temizlemeEkle);
        document.getElementById('sevkeHazirForm').addEventListener('submit', sevkeHazirEkle);
        document.getElementById('sevkEdilenForm').addEventListener('submit', sevkEdilenEkle);
        document.getElementById('yariMamulForm').addEventListener('submit', yariMamulEkle);
    });

    // Firebase'den tüm verileri yükle
    async function loadAllDataFromFirebase() {
        try {
            kaliteKayitlari = await loadFromFirebase('kaliteKayitlari');
            siparisHazirlikKayitlari = await loadFromFirebase('siparisHazirlikKayitlari');
            performansKayitlari = await loadFromFirebase('performansKayitlari');
            stokKayitlari = await loadFromFirebase('stokKayitlari');
            temizlemeKayitlari = await loadFromFirebase('temizlemeKayitlari');
            sevkeHazirKayitlari = await loadFromFirebase('sevkeHazirKayitlari');
            sevkEdilenKayitlari = await loadFromFirebase('sevkEdilenKayitlari');
            yariMamulKayitlari = await loadFromFirebase('yariMamulKayitlari');
            
            // localStorage'a da kaydet (çevrimdışı kullanım için)
            localStorage.setItem('kaliteKayitlari', JSON.stringify(kaliteKayitlari));
            localStorage.setItem('siparisHazirlikKayitlari', JSON.stringify(siparisHazirlikKayitlari));
            localStorage.setItem('performansKayitlari', JSON.stringify(performansKayitlari));
            localStorage.setItem('stokKayitlari', JSON.stringify(stokKayitlari));
            localStorage.setItem('temizlemeKayitlari', JSON.stringify(temizlemeKayitlari));
            localStorage.setItem('sevkeHazirKayitlari', JSON.stringify(sevkeHazirKayitlari));
            localStorage.setItem('sevkEdilenKayitlari', JSON.stringify(sevkEdilenKayitlari));
            localStorage.setItem('yariMamulKayitlari', JSON.stringify(yariMamulKayitlari));
            
        } catch (error) {
            console.error('Firebase veri yükleme hatası:', error);
            // Hata durumunda localStorage'dan yükle
            kaliteKayitlari = JSON.parse(localStorage.getItem('kaliteKayitlari') || '[]');
            siparisHazirlikKayitlari = JSON.parse(localStorage.getItem('siparisHazirlikKayitlari') || '[]');
            performansKayitlari = JSON.parse(localStorage.getItem('performansKayitlari') || '[]');
            stokKayitlari = JSON.parse(localStorage.getItem('stokKayitlari') || '[]');
            temizlemeKayitlari = JSON.parse(localStorage.getItem('temizlemeKayitlari') || '[]');
            sevkeHazirKayitlari = JSON.parse(localStorage.getItem('sevkeHazirKayitlari') || '[]');
            sevkEdilenKayitlari = JSON.parse(localStorage.getItem('sevkEdilenKayitlari') || '[]');
            yariMamulKayitlari = JSON.parse(localStorage.getItem('yariMamulKayitlari') || '[]');
        }
    }

    // Mevcut fonksiyonlarınızı güncelleyin (sadece kaydetme kısımlarına Firebase ekleyin)

    // Kalite kontrol form submit (güncellendi)
    document.getElementById('kaliteForm').addEventListener('submit', async function(e) {
        e.preventDefault();
        const formData = {
            id: Date.now(),
            tarih: document.getElementById('tarih').value,
            operator: document.getElementById('operator').value,
            urunKodu: document.getElementById('urunKodu').value.trim(),
            toplamAdet: parseInt(document.getElementById('toplamAdet').value),
            siparisNo: document.getElementById('siparisNo').value.trim(),
            hatalar: []
        };

        // Hata verilerini topla (mevcut kodunuz)
        const hataCheckboxes = document.querySelectorAll('input[name="hatalar"]:checked');
        hataCheckboxes.forEach(checkbox => {
            const hataItem = checkbox.closest('.hata-item');
            const hataAdetInputs = hataItem.querySelectorAll('.hata-adet');
            const iskartaAdet = parseInt(hataAdetInputs[0].value) || 0;
            const geriGidenAdet = parseInt(hataAdetInputs[1].value) || 0;
            if (iskartaAdet > 0 || geriGidenAdet > 0) {
                let hataTuru = checkbox.value;
                if (hataTuru === 'Diğer') {
                    const digerAciklama = document.getElementById('digerHataAciklama').value.trim();
                    if (digerAciklama) {
                        hataTuru = `Diğer: ${digerAciklama}`;
                    }
                }
                formData.hatalar.push({
                    tur: hataTuru,
                    iskartaAdet: iskartaAdet,
                    geriGidenAdet: geriGidenAdet
                });
            }
        });

        if (formData.hatalar.length === 0) {
            showAlert('kaliteAlert', 'Lütfen en az bir hata türü seçin ve adetlerini girin!', 'error');
            return;
        }

        // Firebase'e kaydet
        await saveToFirebase('kaliteKayitlari', formData);
        
        // Local array'e ekle
        kaliteKayitlari.push(formData);
        
        // localStorage'a kaydet
        localStorage.setItem('kaliteKayitlari', JSON.stringify(kaliteKayitlari));

        // Form temizle (mevcut kodunuz)
        document.getElementById('kaliteForm').reset();
        const now = new Date().toISOString().slice(0, 16);
        document.getElementById('tarih').value = now;
        document.getElementById('digerHataDetay').style.display = 'none';

        loadKaliteKayitlari();
        loadStats();
        showAlert('kaliteAlert', 'Kalite kontrol kaydı başarıyla kaydedildi!', 'success');
    });

    // Diğer form submit fonksiyonlarınızı da benzer şekilde güncelleyin
    // Örnek: Sipariş ekleme (güncellendi)
    document.getElementById('siparisEkleForm').addEventListener('submit', async function(e) {
        e.preventDefault();
        const formData = {
            id: Date.now(),
            tarih: document.getElementById('hazirlikTarih').value,
            operator: document.getElementById('hazirlikOperator').value,
            siparisNo: document.getElementById('hazirlikSiparisNo').value.trim(),
            urunKodu: document.getElementById('urunKoduSiparis').value.trim(),
            siparisAdet: parseInt(document.getElementById('siparisAdet').value),
            durum: 'hazirlanıyor',
            olusturmaTarihi: new Date().toISOString(),
            checkboxDurum: {
                koli: false,
                kutu: false,
                izolasyon: false,
                etiket: false,
                posetMevcut: false,
                tapaMevcut: false
            }
        };

        await saveToFirebase('siparisHazirlikKayitlari', formData);
        siparisHazirlikKayitlari.push(formData);
        localStorage.setItem('siparisHazirlikKayitlari', JSON.stringify(siparisHazirlikKayitlari));

        document.getElementById('siparisEkleForm').reset();
        const today = new Date().toISOString().slice(0, 10);
        document.getElementById('hazirlikTarih').value = today;
        
        loadSiparislerListesi();
        loadStats();
        showAlert('siparisEkleAlert', 'Sipariş başarıyla eklendi!', 'success');
    });

    // Performans form (güncellendi)
    document.getElementById('performansForm').addEventListener('submit', async function(e) {
        e.preventDefault();
        const performansData = {
            id: Date.now(),
            tarih: document.getElementById('performansTarih').value,
            calisan: document.getElementById('performansCalisan').value,
            ekleyen: document.getElementById('performansEkleyen').value,
            islemler: []
        };

        // İşlem verilerini topla (mevcut kodunuz)
        const islemler = [
            { ad: 'Kutu Hazırlığı', urun: 'kutuHazirlikUrun', adet: 'kutuHazirlikAdet', sure: 'kutuHazirlikSure' },
            { ad: 'Koli Hazırlama', urun: 'koliHazirlamaUrun', adet: 'koliHazirlamaAdet', sure: 'koliHazirlamaSure' },
            { ad: 'İzolasyon', urun: 'izolasyonUrunPerf', adet: 'izolasyonAdetPerf', sure: 'izolasyonSure' },
            { ad: 'Kalite Kontrol', urun: 'kaliteKontrolUrun', adet: 'kaliteKontrolAdet', sure: 'kaliteKontrolSure' },
            { ad: 'Poşetleme', urun: 'posetlemeUrunPerf', adet: 'posetlemeAdetPerf', sure: 'posetlemeSure' },
            { ad: 'Ürün Kutulama', urun: 'urunKutulamaUrun', adet: 'urunKutulamaAdet', sure: 'urunKutulamaSure' },
            { ad: 'Ek Parça', urun: 'ekParcaUrunPerf', adet: 'ekParcaAdetPerf', sure: 'ekParcaSure' }
        ];
        
        islemler.forEach(islem => {
            const urun = document.getElementById(islem.urun).value.trim();
            const adet = parseInt(document.getElementById(islem.adet).value) || 0;
            const sure = parseInt(document.getElementById(islem.sure).value) || 0;
            if (urun && adet > 0 && sure > 0) {
                performansData.islemler.push({
                    ad: islem.ad,
                    urun: urun,
                    adet: adet,
                    sure: sure,
                    hiz: Math.round((adet / sure) * 60 * 100) / 100
                });
            }
        });

        if (performansData.islemler.length === 0) {
            showAlert('performansAlert', 'Lütfen en az bir işlem performansı girin!', 'error');
            return;
        }

        await saveToFirebase('performansKayitlari', performansData);
        performansKayitlari.push(performansData);
        localStorage.setItem('performansKayitlari', JSON.stringify(performansKayitlari));

        document.getElementById('performansForm').reset();
        const today = new Date().toISOString().slice(0, 10);
        document.getElementById('performansTarih').value = today;
        
        loadPerformansKayitlari();
        loadStats();
        showAlert('performansAlert', 'Performans kaydı başarıyla kaydedildi!', 'success');
    });

    // Silme fonksiyonlarını güncelleyin
    async function kaliteKaydiSil(id) {
        if (confirm('Bu kalite kontrol kaydını silmek istediğinizden emin misiniz?')) {
            await deleteFromFirebase('kaliteKayitlari', id);
            kaliteKayitlari = kaliteKayitlari.filter(k => k.id !== id);
            localStorage.setItem('kaliteKayitlari', JSON.stringify(kaliteKayitlari));
            loadKaliteKayitlari();
            loadStats();
            showAlert('kaliteAlert', 'Kalite kontrol kaydı silindi!', 'success');
        }
    }

    async function performansKaydiSil(id) {
        if (confirm('Bu performans kaydını silmek istediğinizden emin misiniz?')) {
            await deleteFromFirebase('performansKayitlari', id);
            performansKayitlari = performansKayitlari.filter(k => k.id !== id);
            localStorage.setItem('performansKayitlari', JSON.stringify(performansKayitlari));
            loadPerformansKayitlari();
            loadStats();
            showAlert('performansAlert', 'Performans kaydı silindi!', 'success');
        }
    }

    // Stok ekleme/güncelleme (güncellendi)
    async function stokEkleGuncelle(e) {
        if (e) e.preventDefault();
        const malzemeTuru = document.getElementById('stokMalzemeTuru').value;
        const urunAdi = document.getElementById('stokUrunAdi').value.trim();
        const olculeri = document.getElementById('stokOlculeri').value.trim();
        const mevcutAdet = parseInt(document.getElementById('stokMevcut').value) || 0;
        const ekleyen = document.getElementById('stokEkleyen').value;

        if (!malzemeTuru || !urunAdi || !ekleyen) {
            showAlert('stokAlert', 'Lütfen malzeme türü, ürün adı ve ekleyen kişiyi giriniz!', 'error');
            return;
        }

        const existingIndex = stokKayitlari.findIndex(stok =>
            stok.malzemeTuru === malzemeTuru &&
            stok.urunAdi.toLowerCase() === urunAdi.toLowerCase() &&
            stok.olculeri === olculeri
        );

        const yeniStok = {
            id: existingIndex !== -1 ? stokKayitlari[existingIndex].id : Date.now(),
            malzemeTuru: malzemeTuru,
            urunAdi: urunAdi,
            olculeri: olculeri,
            mevcutAdet: mevcutAdet,
            ekleyen: ekleyen,
            sonGuncelleme: new Date().toISOString()
        };

        await saveToFirebase('stokKayitlari', yeniStok);

        if (existingIndex !== -1) {
            stokKayitlari[existingIndex] = yeniStok;
            showAlert('stokAlert', 'Stok başarıyla güncellendi!', 'success');
        } else {
            stokKayitlari.push(yeniStok);
            showAlert('stokAlert', 'Stok başarıyla eklendi!', 'success');
        }

        localStorage.setItem('stokKayitlari', JSON.stringify(stokKayitlari));
        loadStokListesi();
        tumStoklariOzetGoster();
        temizleStokFormu();
    }

    // Checkbox güncelleme (güncellendi)
    async function updateCheckbox(siparisId, checkboxType, isChecked) {
        const siparis = siparisHazirlikKayitlari.find(s => s.id === siparisId);
        if (siparis) {
            if (!siparis.checkboxDurum) {
                siparis.checkboxDurum = {};
            }
            siparis.checkboxDurum[checkboxType] = isChecked;
            
            await saveToFirebase('siparisHazirlikKayitlari', siparis);
            localStorage.setItem('siparisHazirlikKayitlari', JSON.stringify(siparisHazirlikKayitlari));
        }
    }

    // Temizleme ekleme (güncellendi)
    async function temizlemeEkle(e) {
        e.preventDefault();
        const formData = {
            id: Date.now(),
            siparisNo: document.getElementById('temizlemeSiparisNo').value.trim(),
            urunKodu: document.getElementById('temizlemeUrunKodu').value.trim(),
            siparisAdet: parseInt(document.getElementById('temizlemeSiparisAdet').value) || 0,
            gelenAdet: parseInt(document.getElementById('temizlemeGelenAdet').value) || 0,
            adetKg: parseFloat(document.getElementById('temizlemeAdetKg').value) || 0,
            toplamKg: parseFloat(document.getElementById('temizlemeToplamKg').value) || 0,
            ekleyen: document.getElementById('temizlemeEkleyen').value,
            tarih: new Date().toISOString()
        };

        await saveToFirebase('temizlemeKayitlari', formData);
        temizlemeKayitlari.push(formData);
        localStorage.setItem('temizlemeKayitlari', JSON.stringify(temizlemeKayitlari));
        
        document.getElementById('temizlemeForm').reset();
        loadTemizlemeKayitlari();
        showAlert('temizlemeAlert', 'Temizleme kaydı başarıyla eklendi!', 'success');
    }

    // Benzer şekilde diğer ekleme fonksiyonlarınızı da güncelleyin...
    // (sevkeHazirEkle, sevkEdilenEkle, yariMamulEkle)

    // Bağlantı durumu göstergesi ekleme
    function addConnectionIndicator() {
        const indicator = document.createElement('div');
        indicator.id = 'connectionIndicator';
        indicator.style.cssText = `
            position: fixed;
            top: 10px;
            right: 10px;
            padding: 5px 10px;
            border-radius: 15px;
            color: white;
            font-size: 12px;
            font-weight: bold;
            z-index: 1000;
            transition: all 0.3s ease;
        `;
        document.body.appendChild(indicator);
        
        function updateIndicator() {
            if (isOnline) {
                indicator.textContent = '🟢 Çevrimiçi - Firebase Aktif';
                indicator.style.backgroundColor = '#27ae60';
            } else {
                indicator.textContent = '🔴 Çevrimdışı - Yerel Kayıt';
                indicator.style.backgroundColor = '#e74c3c';
            }
        }
        
        updateIndicator();
        window.addEventListener('online', updateIndicator);
        window.addEventListener('offline', updateIndicator);
    }

    // Sayfa yüklendiğinde bağlantı göstergesini ekle
    document.addEventListener('DOMContentLoaded', function() {
        addConnectionIndicator();
    });

    // Mevcut kodunuzun geri kalanı değişmeden kalacak...
    // (Tüm diğer fonksiyonlarınız aynen kalır)
        // Global değişkenler
        let kaliteKayitlari = JSON.parse(localStorage.getItem('kaliteKayitlari') || '[]');
        let siparisHazirlikKayitlari = JSON.parse(localStorage.getItem('siparisHazirlikKayitlari') || '[]');
        let performansKayitlari = JSON.parse(localStorage.getItem('performansKayitlari') || '[]');
        let stokKayitlari = JSON.parse(localStorage.getItem('stokKayitlari') || '[]');
        let temizlemeKayitlari = JSON.parse(localStorage.getItem('temizlemeKayitlari') || '[]');
        let sevkeHazirKayitlari = JSON.parse(localStorage.getItem('sevkeHazirKayitlari') || '[]');
        let sevkEdilenKayitlari = JSON.parse(localStorage.getItem('sevkEdilenKayitlari') || '[]');
        let yariMamulKayitlari = JSON.parse(localStorage.getItem('yariMamulKayitlari') || '[]');

        // Sayfa yüklendiğinde
        document.addEventListener('DOMContentLoaded', function() {
            const now = new Date();
            const nowString = now.toISOString().slice(0, 16);
            const today = now.toISOString().slice(0, 10);

            document.getElementById('tarih').value = nowString;
            document.getElementById('hazirlikTarih').value = today;
            document.getElementById('performansTarih').value = today;
            document.getElementById('sevkTeslimTarih').value = today;

            loadStats();
            loadStokListesi();
            loadKaliteKayitlari();
            loadSiparislerListesi();
            loadIstatistikler();
            loadVeriTablosu();
            tumStoklariOzetGoster();
            loadTemizlemeKayitlari();
            loadSevkeHazirKayitlari();
            loadSevkEdilenKayitlari();
            loadYariMamulKayitlari();

            // Stok formu için event listener
            document.getElementById('stokForm').addEventListener('submit', stokEkleGuncelle);

            // Diğer hata checkbox'ı için listener
            document.getElementById('hataDiger').addEventListener('change', function() {
                const digerDetay = document.getElementById('digerHataDetay');
                digerDetay.style.display = this.checked ? 'block' : 'none';
            });

            // Yeni form listeners
            document.getElementById('temizlemeForm').addEventListener('submit', temizlemeEkle);
            document.getElementById('sevkeHazirForm').addEventListener('submit', sevkeHazirEkle);
            document.getElementById('sevkEdilenForm').addEventListener('submit', sevkEdilenEkle);
            document.getElementById('yariMamulForm').addEventListener('submit', yariMamulEkle);
        });

        // Temizleme kayıtları fonksiyonları
        function temizlemeEkle(e) {
            e.preventDefault();
            const formData = {
                id: Date.now(),
                siparisNo: document.getElementById('temizlemeSiparisNo').value.trim(),
                urunKodu: document.getElementById('temizlemeUrunKodu').value.trim(),
                siparisAdet: parseInt(document.getElementById('temizlemeSiparisAdet').value) || 0,
                gelenAdet: parseInt(document.getElementById('temizlemeGelenAdet').value) || 0,
                adetKg: parseFloat(document.getElementById('temizlemeAdetKg').value) || 0,
                toplamKg: parseFloat(document.getElementById('temizlemeToplamKg').value) || 0,
                ekleyen: document.getElementById('temizlemeEkleyen').value,
                tarih: new Date().toISOString()
            };

            temizlemeKayitlari.push(formData);
            localStorage.setItem('temizlemeKayitlari', JSON.stringify(temizlemeKayitlari));
            
            document.getElementById('temizlemeForm').reset();
            loadTemizlemeKayitlari();
            showAlert('temizlemeAlert', 'Temizleme kaydı başarıyla eklendi!', 'success');
        }

        function loadTemizlemeKayitlari() {
            const container = document.getElementById('temizlemeKayitlari');
            if (!container) return;

            if (temizlemeKayitlari.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #666; padding: 20px;">Henüz temizleme kaydı bulunmuyor.</p>';
                return;
            }

            let html = '';
            temizlemeKayitlari.slice().reverse().forEach(kayit => {
                html += `
                    <div class="kayit-item">
                        <div class="kayit-header">
                            <div>
                                <strong>🏷️ ${kayit.siparisNo} - 📦 ${kayit.urunKodu}</strong>
                            </div>
                            <div>
                                <button class="btn-edit" onclick="temizlemeEdit(${kayit.id})">✏️</button>
                                <button class="btn-delete" onclick="temizlemeSil(${kayit.id})" style="margin-left: 5px;">🗑️</button>
                            </div>
                        </div>
                        <div class="kayit-details">
                            <div><strong>📊 Sipariş Adeti:</strong> ${kayit.siparisAdet}</div>
                            <div><strong>📦 Gelen Adet:</strong> ${kayit.gelenAdet}</div>
                            <div><strong>⚖️ Adet KG:</strong> ${kayit.adetKg}</div>
                            <div><strong>⚖️ Toplam KG:</strong> ${kayit.toplamKg}</div>
                            <div><strong>👤 Ekleyen:</strong> ${kayit.ekleyen}</div>
                            <div><strong>📅 Tarih:</strong> ${new Date(kayit.tarih).toLocaleString('tr-TR')}</div>
                        </div>
                    </div>
                `;
            });
            container.innerHTML = html;
        }

        function temizlemeEdit(id) {
            const kayit = temizlemeKayitlari.find(k => k.id === id);
            if (!kayit) return;

            const modal = document.getElementById('editModal');
            const container = document.getElementById('editFormContainer');
            
            container.innerHTML = `
                <form id="editTemizlemeForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>🏷️ Sipariş No</label>
                            <input type="text" id="editTemizlemeSiparisNo" value="${kayit.siparisNo}" required>
                        </div>
                        <div class="form-group">
                            <label>📦 Ürün Kodu</label>
                            <input type="text" id="editTemizlemeUrunKodu" value="${kayit.urunKodu}" required>
                        </div>
                        <div class="form-group">
                            <label>📊 Sipariş Adeti</label>
                            <input type="number" id="editTemizlemeSiparisAdet" value="${kayit.siparisAdet}" min="0" required>
                        </div>
                        <div class="form-group">
                            <label>📦 Gelen Adet</label>
                            <input type="number" id="editTemizlemeGelenAdet" value="${kayit.gelenAdet}" min="0" required>
                        </div>
                        <div class="form-group">
                            <label>⚖️ Adet KG</label>
                            <input type="number" id="editTemizlemeAdetKg" value="${kayit.adetKg}" step="0.01" min="0" required>
                        </div>
                        <div class="form-group">
                            <label>⚖️ Toplam KG</label>
                            <input type="number" id="editTemizlemeToplamKg" value="${kayit.toplamKg}" step="0.01" min="0" required>
                        </div>
                    </div>
                    <div style="margin-top: 20px; text-align: center;">
                        <button type="submit" class="btn">💾 Güncelle</button>
                        <button type="button" class="btn btn-danger" onclick="document.getElementById('editModal').style.display='none'" style="margin-left: 10px;">❌ İptal</button>
                    </div>
                </form>
            `;

            modal.style.display = 'block';

            document.getElementById('editTemizlemeForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                kayit.siparisNo = document.getElementById('editTemizlemeSiparisNo').value.trim();
                kayit.urunKodu = document.getElementById('editTemizlemeUrunKodu').value.trim();
                kayit.siparisAdet = parseInt(document.getElementById('editTemizlemeSiparisAdet').value) || 0;
                kayit.gelenAdet = parseInt(document.getElementById('editTemizlemeGelenAdet').value) || 0;
                kayit.adetKg = parseFloat(document.getElementById('editTemizlemeAdetKg').value) || 0;
                kayit.toplamKg = parseFloat(document.getElementById('editTemizlemeToplamKg').value) || 0;
                kayit.guncellemeTarihi = new Date().toISOString();

                localStorage.setItem('temizlemeKayitlari', JSON.stringify(temizlemeKayitlari));
                loadTemizlemeKayitlari();
                modal.style.display = 'none';
                showAlert('temizlemeAlert', 'Temizleme kaydı başarıyla güncellendi!', 'success');
            });
        }

        function temizlemeSil(id) {
            if (confirm('Bu temizleme kaydını silmek istediğinizden emin misiniz?')) {
                temizlemeKayitlari = temizlemeKayitlari.filter(k => k.id !== id);
                localStorage.setItem('temizlemeKayitlari', JSON.stringify(temizlemeKayitlari));
                loadTemizlemeKayitlari();
                showAlert('temizlemeAlert', 'Temizleme kaydı silindi!', 'success');
            }
        }

        // Sevke Hazır kayıtları fonksiyonları
        function sevkeHazirEkle(e) {
            e.preventDefault();
            const formData = {
                id: Date.now(),
                siparisNo: document.getElementById('sevkeSiparisNo').value.trim(),
                urunNo: document.getElementById('sevkeUrunNo').value.trim(),
                sevkeHazirAdet: parseInt(document.getElementById('sevkeHazirAdet').value) || 0,
                koliAdet: parseInt(document.getElementById('sevkeKoliAdet').value) || 0,
                ekleyen: document.getElementById('sevkeHazirEkleyen').value,
                tarih: new Date().toISOString()
            };

            sevkeHazirKayitlari.push(formData);
            localStorage.setItem('sevkeHazirKayitlari', JSON.stringify(sevkeHazirKayitlari));
            
            document.getElementById('sevkeHazirForm').reset();
            loadSevkeHazirKayitlari();
            showAlert('sevkeHazirAlert', 'Sevke hazır kaydı başarıyla eklendi!', 'success');
        }

        function loadSevkeHazirKayitlari() {
            const container = document.getElementById('sevkeHazirKayitlari');
            if (!container) return;

            if (sevkeHazirKayitlari.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #666; padding: 20px;">Henüz sevke hazır kayıt bulunmuyor.</p>';
                return;
            }

            let html = '';
            sevkeHazirKayitlari.slice().reverse().forEach(kayit => {
                html += `
                    <div class="kayit-item">
                        <div class="kayit-header">
                            <div>
                                <strong>🏷️ ${kayit.siparisNo} - 📦 ${kayit.urunNo}</strong>
                            </div>
                            <div>
                                <button class="btn-edit" onclick="sevkeHazirEdit(${kayit.id})">✏️</button>
                                <button class="btn-delete" onclick="sevkeHazirSil(${kayit.id})" style="margin-left: 5px;">🗑️</button>
                            </div>
                        </div>
                        <div class="kayit-details">
                            <div><strong>📊 Sevke Hazır Adet:</strong> ${kayit.sevkeHazirAdet}</div>
                            <div><strong>📦 Koli Adeti:</strong> ${kayit.koliAdet}</div>
                            <div><strong>👤 Ekleyen:</strong> ${kayit.ekleyen}</div>
                            <div><strong>📅 Tarih:</strong> ${new Date(kayit.tarih).toLocaleString('tr-TR')}</div>
                        </div>
                    </div>
                `;
            });
            container.innerHTML = html;
        }

        function sevkeHazirEdit(id) {
            const kayit = sevkeHazirKayitlari.find(k => k.id === id);
            if (!kayit) return;

            const modal = document.getElementById('editModal');
            const container = document.getElementById('editFormContainer');
            
            container.innerHTML = `
                <form id="editSevkeHazirForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>🏷️ Sipariş No</label>
                            <input type="text" id="editSevkeSiparisNo" value="${kayit.siparisNo}" required>
                        </div>
                        <div class="form-group">
                            <label>📦 Ürün No</label>
                            <input type="text" id="editSevkeUrunNo" value="${kayit.urunNo}" required>
                        </div>
                        <div class="form-group">
                            <label>📊 Sevke Hazır Adet</label>
                            <input type="number" id="editSevkeHazirAdet" value="${kayit.sevkeHazirAdet}" min="0" required>
                        </div>
                        <div class="form-group">
                            <label>📦 Koli Adeti</label>
                            <input type="number" id="editSevkeKoliAdet" value="${kayit.koliAdet}" min="0" required>
                        </div>
                    </div>
                    <div style="margin-top: 20px; text-align: center;">
                        <button type="submit" class="btn">💾 Güncelle</button>
                        <button type="button" class="btn btn-danger" onclick="document.getElementById('editModal').style.display='none'" style="margin-left: 10px;">❌ İptal</button>
                    </div>
                </form>
            `;

            modal.style.display = 'block';

            document.getElementById('editSevkeHazirForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                kayit.siparisNo = document.getElementById('editSevkeSiparisNo').value.trim();
                kayit.urunNo = document.getElementById('editSevkeUrunNo').value.trim();
                kayit.sevkeHazirAdet = parseInt(document.getElementById('editSevkeHazirAdet').value) || 0;
                kayit.koliAdet = parseInt(document.getElementById('editSevkeKoliAdet').value) || 0;
                kayit.guncellemeTarihi = new Date().toISOString();

                localStorage.setItem('sevkeHazirKayitlari', JSON.stringify(sevkeHazirKayitlari));
                loadSevkeHazirKayitlari();
                modal.style.display = 'none';
                showAlert('sevkeHazirAlert', 'Sevke hazır kaydı başarıyla güncellendi!', 'success');
            });
        }

        function sevkeHazirSil(id) {
            if (confirm('Bu sevke hazır kaydını silmek istediğinizden emin misiniz?')) {
                sevkeHazirKayitlari = sevkeHazirKayitlari.filter(k => k.id !== id);
                localStorage.setItem('sevkeHazirKayitlari', JSON.stringify(sevkeHazirKayitlari));
                loadSevkeHazirKayitlari();
                showAlert('sevkeHazirAlert', 'Sevke hazır kaydı silindi!', 'success');
            }
        }

        // Sevk Edilen kayıtları fonksiyonları
        function sevkEdilenEkle(e) {
            e.preventDefault();
            const formData = {
                id: Date.now(),
                siparisNo: document.getElementById('sevkSiparisNo').value.trim(),
                urunTuru: document.getElementById('sevkUrunTuru').value.trim(),
                urunNo: document.getElementById('sevkUrunNo').value.trim(),
                teslimTarih: document.getElementById('sevkTeslimTarih').value,
                teslimAdet: parseInt(document.getElementById('sevkTeslimAdet').value) || 0,
                teslimAlan: document.getElementById('sevkTeslimAlan').value.trim(),
                depoIrsaliye: document.getElementById('sevkDepoIrsaliye').value.trim(),
                ekleyen: document.getElementById('sevkEdilenEkleyen').value,
                tarih: new Date().toISOString()
            };

            sevkEdilenKayitlari.push(formData);
            localStorage.setItem('sevkEdilenKayitlari', JSON.stringify(sevkEdilenKayitlari));
            
            document.getElementById('sevkEdilenForm').reset();
            const today = new Date().toISOString().slice(0, 10);
            document.getElementById('sevkTeslimTarih').value = today;
            
            loadSevkEdilenKayitlari();
            showAlert('sevkEdilenAlert', 'Sevk edilen kaydı başarıyla eklendi!', 'success');
        }

        function loadSevkEdilenKayitlari() {
            const container = document.getElementById('sevkEdilenKayitlari');
            if (!container) return;

            if (sevkEdilenKayitlari.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #666; padding: 20px;">Henüz sevk edilen kayıt bulunmuyor.</p>';
                return;
            }

            let html = '';
            sevkEdilenKayitlari.slice().reverse().forEach(kayit => {
                html += `
                    <div class="kayit-item">
                        <div class="kayit-header">
                            <div>
                                <strong>🏷️ ${kayit.siparisNo} - ${kayit.urunTuru} (${kayit.urunNo})</strong>
                            </div>
                            <div>
                                <button class="btn-edit" onclick="sevkEdilenEdit(${kayit.id})">✏️</button>
                                <button class="btn-delete" onclick="sevkEdilenSil(${kayit.id})" style="margin-left: 5px;">🗑️</button>
                            </div>
                        </div>
                        <div class="kayit-details">
                            <div><strong>📅 Teslim Tarihi:</strong> ${new Date(kayit.teslimTarih).toLocaleDateString('tr-TR')}</div>
                            <div><strong>📊 Teslim Adeti:</strong> ${kayit.teslimAdet}</div>
                            <div><strong>👤 Teslim Alan:</strong> ${kayit.teslimAlan}</div>
                            <div><strong>📋 Depo İrsaliye:</strong> ${kayit.depoIrsaliye}</div>
                            <div><strong>👤 Ekleyen:</strong> ${kayit.ekleyen}</div>
                            <div><strong>📅 Kayıt Tarihi:</strong> ${new Date(kayit.tarih).toLocaleString('tr-TR')}</div>
                        </div>
                    </div>
                `;
            });
            container.innerHTML = html;
        }

        function sevkEdilenEdit(id) {
            const kayit = sevkEdilenKayitlari.find(k => k.id === id);
            if (!kayit) return;

            const modal = document.getElementById('editModal');
            const container = document.getElementById('editFormContainer');
            
            container.innerHTML = `
                <form id="editSevkEdilenForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>🏷️ Sipariş No</label>
                            <input type="text" id="editSevkSiparisNo" value="${kayit.siparisNo}" required>
                        </div>
                        <div class="form-group">
                            <label>📦 Ürün Türü</label>
                            <input type="text" id="editSevkUrunTuru" value="${kayit.urunTuru}" required>
                        </div>
                        <div class="form-group">
                            <label>📦 Ürün No</label>
                            <input type="text" id="editSevkUrunNo" value="${kayit.urunNo}" required>
                        </div>
                        <div class="form-group">
                            <label>📅 Teslim Tarihi</label>
                            <input type="date" id="editSevkTeslimTarih" value="${kayit.teslimTarih}" required>
                        </div>
                        <div class="form-group">
                            <label>📊 Teslim Adeti</label>
                            <input type="number" id="editSevkTeslimAdet" value="${kayit.teslimAdet}" min="0" required>
                        </div>
                        <div class="form-group">
                            <label>👤 Teslim Alan</label>
                            <input type="text" id="editSevkTeslimAlan" value="${kayit.teslimAlan}" required>
                        </div>
                        <div class="form-group">
                            <label>📋 Depo İrsaliye</label>
                            <input type="text" id="editSevkDepoIrsaliye" value="${kayit.depoIrsaliye}" required>
                        </div>
                    </div>
                    <div style="margin-top: 20px; text-align: center;">
                        <button type="submit" class="btn">💾 Güncelle</button>
                        <button type="button" class="btn btn-danger" onclick="document.getElementById('editModal').style.display='none'" style="margin-left: 10px;">❌ İptal</button>
                    </div>
                </form>
            `;

            modal.style.display = 'block';

            document.getElementById('editSevkEdilenForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                kayit.siparisNo = document.getElementById('editSevkSiparisNo').value.trim();
                kayit.urunTuru = document.getElementById('editSevkUrunTuru').value.trim();
                kayit.urunNo = document.getElementById('editSevkUrunNo').value.trim();
                kayit.teslimTarih = document.getElementById('editSevkTeslimTarih').value;
                kayit.teslimAdet = parseInt(document.getElementById('editSevkTeslimAdet').value) || 0;
                kayit.teslimAlan = document.getElementById('editSevkTeslimAlan').value.trim();
                kayit.depoIrsaliye = document.getElementById('editSevkDepoIrsaliye').value.trim();
                kayit.guncellemeTarihi = new Date().toISOString();

                localStorage.setItem('sevkEdilenKayitlari', JSON.stringify(sevkEdilenKayitlari));
                loadSevkEdilenKayitlari();
                modal.style.display = 'none';
                showAlert('sevkEdilenAlert', 'Sevk edilen kaydı başarıyla güncellendi!', 'success');
            });
        }

        function sevkEdilenSil(id) {
            if (confirm('Bu sevk edilen kaydını silmek istediğinizden emin misiniz?')) {
                sevkEdilenKayitlari = sevkEdilenKayitlari.filter(k => k.id !== id);
                localStorage.setItem('sevkEdilenKayitlari', JSON.stringify(sevkEdilenKayitlari));
                loadSevkEdilenKayitlari();
                showAlert('sevkEdilenAlert', 'Sevk edilen kaydı silindi!', 'success');
            }
        }

        // Yarı Mamül kayıtları fonksiyonları
        function yariMamulEkle(e) {
            e.preventDefault();
            const formData = {
                id: Date.now(),
                urunAdi: document.getElementById('yariMamulUrunAdi').value.trim(),
                adet: parseInt(document.getElementById('yariMamulAdet').value) || 0,
                hangiParca: document.getElementById('yariMamulHangiParca').value.trim(),
                not: document.getElementById('yariMamulNot').value.trim(),
                ekleyen: document.getElementById('yariMamulEkleyen').value,
                tarih: new Date().toISOString()
            };

            yariMamulKayitlari.push(formData);
            localStorage.setItem('yariMamulKayitlari', JSON.stringify(yariMamulKayitlari));
            
            document.getElementById('yariMamulForm').reset();
            loadYariMamulKayitlari();
            showAlert('yariMamulAlert', 'Yarı mamül kaydı başarıyla eklendi!', 'success');
        }

        function loadYariMamulKayitlari() {
            const container = document.getElementById('yariMamulKayitlari');
            if (!container) return;

            if (yariMamulKayitlari.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #666; padding: 20px;">Henüz yarı mamül kayıt bulunmuyor.</p>';
                return;
            }

            let html = '';
            yariMamulKayitlari.slice().reverse().forEach(kayit => {
                html += `
                    <div class="kayit-item">
                        <div class="kayit-header">
                            <div>
                                <strong>📦 ${kayit.urunAdi} - 🔧 ${kayit.hangiParca}</strong>
                            </div>
                            <div>
                                <button class="btn-edit" onclick="yariMamulEdit(${kayit.id})">✏️</button>
                                <button class="btn-delete" onclick="yariMamulSil(${kayit.id})" style="margin-left: 5px;">🗑️</button>
                            </div>
                        </div>
                        <div class="kayit-details">
                            <div><strong>📊 Adet:</strong> ${kayit.adet}</div>
                            <div><strong>📝 Not:</strong> ${kayit.not || 'Yok'}</div>
                            <div><strong>👤 Ekleyen:</strong> ${kayit.ekleyen}</div>
                            <div><strong>📅 Tarih:</strong> ${new Date(kayit.tarih).toLocaleString('tr-TR')}</div>
                        </div>
                    </div>
                `;
            });
            container.innerHTML = html;
        }

        function yariMamulEdit(id) {
            const kayit = yariMamulKayitlari.find(k => k.id === id);
            if (!kayit) return;

            const modal = document.getElementById('editModal');
            const container = document.getElementById('editFormContainer');
            
            container.innerHTML = `
                <form id="editYariMamulForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>📦 Ürün Adı</label>
                            <input type="text" id="editYariMamulUrunAdi" value="${kayit.urunAdi}" required>
                        </div>
                        <div class="form-group">
                            <label>📊 Adet</label>
                            <input type="number" id="editYariMamulAdet" value="${kayit.adet}" min="0" required>
                        </div>
                        <div class="form-group">
                            <label>🔧 Hangi Parça</label>
                            <input type="text" id="editYariMamulHangiParca" value="${kayit.hangiParca}" required>
                        </div>
                        <div class="form-group">
                            <label>📝 Not</label>
                            <textarea id="editYariMamulNot" rows="3">${kayit.not}</textarea>
                        </div>
                    </div>
                    <div style="margin-top: 20px; text-align: center;">
                        <button type="submit" class="btn">💾 Güncelle</button>
                        <button type="button" class="btn btn-danger" onclick="document.getElementById('editModal').style.display='none'" style="margin-left: 10px;">❌ İptal</button>
                    </div>
                </form>
            `;

            modal.style.display = 'block';

            document.getElementById('editYariMamulForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                kayit.urunAdi = document.getElementById('editYariMamulUrunAdi').value.trim();
                kayit.adet = parseInt(document.getElementById('editYariMamulAdet').value) || 0;
                kayit.hangiParca = document.getElementById('editYariMamulHangiParca').value.trim();
                kayit.not = document.getElementById('editYariMamulNot').value.trim();
                kayit.guncellemeTarihi = new Date().toISOString();

                localStorage.setItem('yariMamulKayitlari', JSON.stringify(yariMamulKayitlari));
                loadYariMamulKayitlari();
                modal.style.display = 'none';
                showAlert('yariMamulAlert', 'Yarı mamül kaydı başarıyla güncellendi!', 'success');
            });
        }

        function yariMamulSil(id) {
            if (confirm('Bu yarı mamül kaydını silmek istediğinizden emin misiniz?')) {
                yariMamulKayitlari = yariMamulKayitlari.filter(k => k.id !== id);
                localStorage.setItem('yariMamulKayitlari', JSON.stringify(yariMamulKayitlari));
                loadYariMamulKayitlari();
                showAlert('yariMamulAlert', 'Yarı mamül kaydı silindi!', 'success');
            }
        }

        // Kalite kontrol kaydı silme fonksiyonu
        function kaliteKaydiSil(id) {
            if (confirm('Bu kalite kontrol kaydını silmek istediğinizden emin misiniz?')) {
                kaliteKayitlari = kaliteKayitlari.filter(k => k.id !== id);
                localStorage.setItem('kaliteKayitlari', JSON.stringify(kaliteKayitlari));
                loadKaliteKayitlari();
                loadStats();
                showAlert('kaliteAlert', 'Kalite kontrol kaydı silindi!', 'success');
            }
        }

        // Performans kaydı silme fonksiyonu
        function performansKaydiSil(id) {
            if (confirm('Bu performans kaydını silmek istediğinizden emin misiniz?')) {
                performansKayitlari = performansKayitlari.filter(k => k.id !== id);
                localStorage.setItem('performansKayitlari', JSON.stringify(performansKayitlari));
                loadPerformansKayitlari();
                loadStats();
                showAlert('performansAlert', 'Performans kaydı silindi!', 'success');
            }
        }

        // Kalite kayıtlarını tablo formatında yükle
        function loadKaliteKayitlari() {
            const container = document.getElementById('kaliteKayitlariListesi');
            if (!container) return;

            if (kaliteKayitlari.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #666; padding: 20px;">Henüz kalite kontrol kaydı bulunmuyor.</p>';
                return;
            }

            // Hata türlerini topla (dinamik sütunlar için)
            const tumHataTurleri = new Set();
            kaliteKayitlari.forEach(kayit => {
                kayit.hatalar.forEach(hata => {
                    tumHataTurleri.add(hata.tur);
                });
            });

            let html = '<div style="overflow-x: auto; background: white; border-radius: 8px; border: 2px solid #e9ecef; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">';
            html += '<table style="width: 100%; border-collapse: collapse; font-size: 14px;">';

            // Tablo başlığı
            html += `
                <thead style="background: linear-gradient(135deg, #3498db, #2980b9); color: white;">
                    <tr>
                        <th style="padding: 12px 8px; border: 1px solid #2980b9; text-align: center; white-space: nowrap;">📅 Tarih/Saat</th>
                        <th style="padding: 12px 8px; border: 1px solid #2980b9; text-align: center; white-space: nowrap;">👤 Operatör</th>
                        <th style="padding: 12px 8px; border: 1px solid #2980b9; text-align: center; white-space: nowrap;">📦 Ürün Kodu</th>
                        <th style="padding: 12px 8px; border: 1px solid #2980b9; text-align: center; white-space: nowrap;">📊 Toplam Adet</th>
                        <th style="padding: 12px 8px; border: 1px solid #2980b9; text-align: center; white-space: nowrap;">🏷️ Sipariş No</th>
                        <th style="padding: 12px 8px; border: 1px solid #2980b9; text-align: center; white-space: nowrap; background: #e74c3c;">🗑️ Toplam İskarta</th>
                        <th style="padding: 12px 8px; border: 1px solid #2980b9; text-align: center; white-space: nowrap; background: #f39c12;">↩️ Toplam Geri Dönen</th>
                        <th style="padding: 12px 8px; border: 1px solid #2980b9; text-align: center; white-space: nowrap; background: #e74c3c;">🚫 İşlem</th>
            `;

            // Hata türü sütunları
            Array.from(tumHataTurleri).forEach(hataTuru => {
                html += `<th style="padding: 12px 8px; border: 1px solid #2980b9; text-align: center; white-space: nowrap; background: #8e44ad; font-size: 12px;">🚫 ${hataTuru}</th>`;
            });

            html += '</tr></thead><tbody>';

            // Veri satırları (en son kayıt üstte)
            kaliteKayitlari.slice().reverse().forEach((kayit, index) => {
                const toplamIskarta = kayit.hatalar.reduce((total, hata) => total + hata.iskartaAdet, 0);
                const toplamGeriDonen = kayit.hatalar.reduce((total, hata) => total + hata.geriGidenAdet, 0);

                html += `<tr style="background: ${index % 2 === 0 ? '#f8f9fa' : 'white'}; border-bottom: 1px solid #dee2e6;">`;
                html += `<td style="padding: 10px 8px; border: 1px solid #dee2e6; text-align: center; white-space: nowrap; font-size: 12px;">${new Date(kayit.tarih).toLocaleString('tr-TR')}</td>`;
                html += `<td style="padding: 10px 8px; border: 1px solid #dee2e6; text-align: center; font-weight: 600;">${kayit.operator}</td>`;
                html += `<td style="padding: 10px 8px; border: 1px solid #dee2e6; text-align: center; font-weight: 600; color: #2c3e50;">${kayit.urunKodu}</td>`;
                html += `<td style="padding: 10px 8px; border: 1px solid #dee2e6; text-align: center; font-weight: bold; color: #27ae60;">${kayit.toplamAdet}</td>`;
                html += `<td style="padding: 10px 8px; border: 1px solid #dee2e6; text-align: center;">${kayit.siparisNo}</td>`;
                html += `<td style="padding: 10px 8px; border: 1px solid #dee2e6; text-align: center; font-weight: bold; color: ${toplamIskarta > 0 ? '#e74c3c' : '#27ae60'}; background: ${toplamIskarta > 0 ? '#fdf2f2' : '#f0f9f0'};">${toplamIskarta}</td>`;
                html += `<td style="padding: 10px 8px; border: 1px solid #dee2e6; text-align: center; font-weight: bold; color: ${toplamGeriDonen > 0 ? '#f39c12' : '#27ae60'}; background: ${toplamGeriDonen > 0 ? '#fef9e7' : '#f0f9f0'};">${toplamGeriDonen}</td>`;
                html += `<td style="padding: 10px 8px; border: 1px solid #dee2e6; text-align: center;"><button onclick="kaliteKaydiSil(${kayit.id})" style="background: #e74c3c; color: white; border: none; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px;">🗑️ Sil</button></td>`;

                // Her hata türü için veri
                Array.from(tumHataTurleri).forEach(hataTuru => {
                    const hataVeri = kayit.hatalar.find(h => h.tur === hataTuru);
                    if (hataVeri) {
                        const toplamHata = hataVeri.iskartaAdet + hataVeri.geriGidenAdet;
                        html += `<td style="padding: 10px 8px; border: 1px solid #dee2e6; text-align: center; font-size: 11px; ${toplamHata > 0 ? 'background: #fff2f2; color: #721c24; font-weight: bold;' : 'color: #666;'}">
                            ${toplamHata > 0 ? `İ:${hataVeri.iskartaAdet} G:${hataVeri.geriGidenAdet}` : '-'}
                        </td>`;
                    } else {
                        html += `<td style="padding: 10px 8px; border: 1px solid #dee2e6; text-align: center; color: #999;">-</td>`;
                    }
                });

                html += '</tr>';
            });

            html += '</tbody></table></div>';

            // Özet bilgi
            const toplamKayit = kaliteKayitlari.length;
            const genelToplamIskarta = kaliteKayitlari.reduce((total, kayit) => 
                total + kayit.hatalar.reduce((hataTotal, hata) => hataTotal + hata.iskartaAdet, 0), 0);
            const genelToplamGeriDonen = kaliteKayitlari.reduce((total, kayit) => 
                total + kayit.hatalar.reduce((hataTotal, hata) => hataTotal + hata.geriGidenAdet, 0), 0);
            const genelToplamUretim = kaliteKayitlari.reduce((total, kayit) => total + kayit.toplamAdet, 0);

            html += `
                <div style="margin-top: 15px; padding: 15px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 8px; color: white;">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; text-align: center;">
                        <div><strong style="font-size: 1.2em;">${toplamKayit}</strong><br><small>Toplam Kayıt</small></div>
                        <div><strong style="font-size: 1.2em;">${genelToplamUretim}</strong><br><small>Toplam Üretim</small></div>
                        <div><strong style="font-size: 1.2em; color: #ffcccb;">${genelToplamIskarta}</strong><br><small>Toplam İskarta</small></div>
                        <div><strong style="font-size: 1.2em; color: #ffe4b5;">${genelToplamGeriDonen}</strong><br><small>Toplam Geri Dönen</small></div>
                        <div><strong style="font-size: 1.2em; color: #90ee90;">${genelToplamUretim > 0 ? Math.round((1 - (genelToplamIskarta + genelToplamGeriDonen)/genelToplamUretim) * 100) : 0}%</strong><br><small>Başarı Oranı</small></div>
                    </div>
                </div>
            `;

            container.innerHTML = html;
        }

        // Stok ekleme/güncelleme fonksiyonu
        function stokEkleGuncelle(e) {
            if (e) e.preventDefault();

            const malzemeTuru = document.getElementById('stokMalzemeTuru').value;
            const urunAdi = document.getElementById('stokUrunAdi').value.trim();
            const olculeri = document.getElementById('stokOlculeri').value.trim();
            const mevcutAdet = parseInt(document.getElementById('stokMevcut').value) || 0;
            const ekleyen = document.getElementById('stokEkleyen').value;

            if (!malzemeTuru || !urunAdi || !ekleyen) {
                showAlert('stokAlert', 'Lütfen malzeme türü, ürün adı ve ekleyen kişiyi giriniz!', 'error');
                return;
            }

            // Aynı ürün var mı kontrol et
            const existingIndex = stokKayitlari.findIndex(stok => 
                stok.malzemeTuru === malzemeTuru && 
                stok.urunAdi.toLowerCase() === urunAdi.toLowerCase() && 
                stok.olculeri === olculeri
            );

            const yeniStok = {
                id: existingIndex !== -1 ? stokKayitlari[existingIndex].id : Date.now(),
                malzemeTuru: malzemeTuru,
                urunAdi: urunAdi,
                olculeri: olculeri,
                mevcutAdet: mevcutAdet,
                ekleyen: ekleyen,
                sonGuncelleme: new Date().toISOString()
            };

            if (existingIndex !== -1) {
                stokKayitlari[existingIndex] = yeniStok;
                showAlert('stokAlert', 'Stok başarıyla güncellendi!', 'success');
            } else {
                stokKayitlari.push(yeniStok);
                showAlert('stokAlert', 'Stok başarıyla eklendi!', 'success');
            }

            localStorage.setItem('stokKayitlari', JSON.stringify(stokKayitlari));
            loadStokListesi();
            tumStoklariOzetGoster();
            temizleStokFormu();
        }

        // Stok formu temizle
        function temizleStokFormu() {
            document.getElementById('stokForm').reset();
        }

        // Stok listesi göster
        function loadStokListesi() {
            const container = document.getElementById('stokListesi');
            if (!container) return;

            if (stokKayitlari.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #666; padding: 20px;">Henüz stok kaydı bulunmuyor.</p>';
                return;
            }

            let html = '';
            stokKayitlari.forEach(stok => {
                html += `
                    <div class="stok-kayit-item">
                        <div class="stok-header">
                            <h4>📦 ${stok.urunAdi}</h4>
                            <span style="background: #3498db; color: white; padding: 5px 10px; border-radius: 15px; font-size: 12px; font-weight: bold;">
                                ${stok.malzemeTuru.toUpperCase()}
                            </span>
                        </div>
                        <div class="stok-bilgi">
                            <div class="stok-bilgi-item">
                                <span><strong>📏 Ölçüler:</strong></span>
                                <span>${stok.olculeri || 'Belirtilmemiş'}</span>
                            </div>
                            <div class="stok-bilgi-item">
                                <span><strong>📊 Mevcut Adet:</strong></span>
                                <span style="font-weight: bold; color: ${stok.mevcutAdet > 0 ? '#27ae60' : '#e74c3c'};">
                                    ${stok.mevcutAdet}
                                </span>
                            </div>
                            <div class="stok-bilgi-item">
                                <span><strong>👤 Ekleyen:</strong></span>
                                <span>${stok.ekleyen}</span>
                            </div>
                            <div class="stok-bilgi-item">
                                <span><strong>🕒 Son Güncelleme:</strong></span>
                                <span>${new Date(stok.sonGuncelleme).toLocaleString('tr-TR')}</span>
                            </div>
                        </div>
                        <div class="stok-kontrol">
                            <button class="stok-btn-small minus" onclick="stokAzalt(${stok.id})">-</button>
                            <div class="stok-adet-display">${stok.mevcutAdet}</div>
                            <button class="stok-btn-small" onclick="stokArttir(${stok.id})">+</button>
                            <input type="number" class="stok-adet-input" id="adet-${stok.id}" placeholder="Adet" min="0">
                            <button class="btn" style="margin-left: 10px; padding: 5px 10px;" onclick="stokGuncelle(${stok.id})">Güncelle</button>
                        </div>
                        <div class="stok-actions">
                            <button class="btn-edit" onclick="stokDuzenle(${stok.id})">✏️ Düzenle</button>
                            <button class="btn-delete" onclick="stokSil(${stok.id})">🗑️ Sil</button>
                        </div>
                    </div>
                `;
            });
            container.innerHTML = html;
        }

        // Stok miktarı arttır
        function stokArttir(id) {
            const stok = stokKayitlari.find(s => s.id === id);
            if (stok) {
                stok.mevcutAdet++;
                stok.sonGuncelleme = new Date().toISOString();
                localStorage.setItem('stokKayitlari', JSON.stringify(stokKayitlari));
                loadStokListesi();
                tumStoklariOzetGoster();
            }
        }

        // Stok miktarı azalt
        function stokAzalt(id) {
            const stok = stokKayitlari.find(s => s.id === id);
            if (stok && stok.mevcutAdet > 0) {
                stok.mevcutAdet--;
                stok.sonGuncelleme = new Date().toISOString();
                localStorage.setItem('stokKayitlari', JSON.stringify(stokKayitlari));
                loadStokListesi();
                tumStoklariOzetGoster();
            }
        }

        // Stok güncelle
        function stokGuncelle(id) {
            const input = document.getElementById(`adet-${id}`);
            const yeniAdet = parseInt(input.value);

            if (isNaN(yeniAdet) || yeniAdet < 0) {
                alert('Lütfen geçerli bir adet giriniz!');
                return;
            }

            const stok = stokKayitlari.find(s => s.id === id);
            if (stok) {
                stok.mevcutAdet = yeniAdet;
                stok.sonGuncelleme = new Date().toISOString();
                localStorage.setItem('stokKayitlari', JSON.stringify(stokKayitlari));
                loadStokListesi();
                tumStoklariOzetGoster();
                showAlert('stokAlert', 'Stok başarıyla güncellendi!', 'success');
            }
        }

        // Stok düzenle
        function stokDuzenle(id) {
            const stok = stokKayitlari.find(s => s.id === id);
            if (stok) {
                document.getElementById('stokMalzemeTuru').value = stok.malzemeTuru;
                document.getElementById('stokUrunAdi').value = stok.urunAdi;
                document.getElementById('stokOlculeri').value = stok.olculeri;
                document.getElementById('stokMevcut').value = stok.mevcutAdet;
                document.getElementById('stokEkleyen').value = stok.ekleyen;

                // Form'un en üstüne scroll
                document.getElementById('stokForm').scrollIntoView({ behavior: 'smooth' });
            }
        }

        // Stok sil
        function stokSil(id) {
            if (confirm('Bu stok kaydını silmek istediğinizden emin misiniz?')) {
                stokKayitlari = stokKayitlari.filter(s => s.id !== id);
                localStorage.setItem('stokKayitlari', JSON.stringify(stokKayitlari));
                loadStokListesi();
                tumStoklariOzetGoster();
                showAlert('stokAlert', 'Stok kaydı silindi!', 'success');
            }
        }

        // Tüm stokları yükle
        function tumStoklariYukle() {
            loadStokListesi();
            tumStoklariOzetGoster();
            showAlert('stokAlert', 'Stoklar yenilendi!', 'success');
        }

        // Tüm stokları sıfırla
        function tumStoklariSifirla() {
            if (confirm('Tüm stok kayıtlarını silmek istediğinizden emin misiniz? Bu işlem geri alınamaz!')) {
                stokKayitlari = [];
                localStorage.setItem('stokKayitlari', JSON.stringify(stokKayitlari));
                loadStokListesi();
                tumStoklariOzetGoster();
                showAlert('stokAlert', 'Tüm stok kayıtları silindi!', 'success');
            }
        }

        // Tüm stokların özetini göster (sadece stok yönetimi sayfasında)
        function tumStoklariOzetGoster() {
            const container = document.getElementById('stokOzeti');
            if (!container) return;

            if (stokKayitlari.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #666;">Henüz stok kaydı bulunmuyor.</p>';
                return;
            }

            // Malzeme türlerine göre grupla
            const stokGruplari = {};
            stokKayitlari.forEach(stok => {
                if (!stokGruplari[stok.malzemeTuru]) {
                    stokGruplari[stok.malzemeTuru] = [];
                }
                stokGruplari[stok.malzemeTuru].push(stok);
            });

            let html = '';
            Object.keys(stokGruplari).forEach(tur => {
                const turStoklar = stokGruplari[tur];
                const toplamAdet = turStoklar.reduce((total, stok) => total + stok.mevcutAdet, 0);

                html += `
                    <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px; border: 2px solid #e9ecef;">
                        <h4 style="color: #2c3e50; margin-bottom: 10px; text-transform: uppercase; background: #3498db; color: white; padding: 8px; border-radius: 4px; text-align: center;">
                            📦 ${tur} (Toplam: ${toplamAdet} adet)
                        </h4>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px;">
                `;

                turStoklar.forEach(stok => {
                    html += `
                        <div style="display: flex; justify-content: space-between; padding: 8px; background: #f8f9fa; border-radius: 4px; border-left: 4px solid ${stok.mevcutAdet > 0 ? '#27ae60' : '#e74c3c'};">
                            <span style="font-weight: 600;">${stok.urunAdi}</span>
                            <span style="font-weight: bold; color: ${stok.mevcutAdet > 0 ? '#27ae60' : '#e74c3c'};">${stok.mevcutAdet}</span>
                        </div>
                    `;
                });

                html += '</div></div>';
            });

            container.innerHTML = html;
        }

        // Tab değiştirme
        function showTab(tabName) {
            // Tüm tab content'leri gizle
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(content => content.classList.remove('active'));

            // Tüm tab butonlarının active class'ını kaldır
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => tab.classList.remove('active'));

            // Seçilen tab'i göster
            document.getElementById(tabName).classList.add('active');

            // Tıklanan tab butonuna active class ekle
            event.target.classList.add('active');

            // Stok özetini yenile (sadece stok sayfasında)
            if (tabName === 'stok') {
                tumStoklariOzetGoster();
            }

            // Tab değiştiğinde ilgili verileri yükle
            if (tabName === 'istatistikler') {
                loadIstatistikler();
            } else if (tabName === 'veri-goruntule') {
                loadVeriTablosu();
            } else if (tabName === 'raporlar') {
                loadStats();
            } else if (tabName === 'temizleme') {
                loadTemizlemeKayitlari();
            } else if (tabName === 'sevke-hazir') {
                loadSevkeHazirKayitlari();
            } else if (tabName === 'sevk-edilen') {
                loadSevkEdilenKayitlari();
            } else if (tabName === 'yari-mamul') {
                loadYariMamulKayitlari();
            }
        }

        // Alert gösterme fonksiyonu
        function showAlert(containerId, message, type) {
            const container = document.getElementById(containerId);
            if (!container) return;

            const alertClass = type === 'success' ? 'alert-success' : 'alert-error';
            container.innerHTML = `<div class="alert ${alertClass}">${message}</div>`;
            setTimeout(() => {
                container.innerHTML = '';
            }, 5000);
        }

        // Kalite kontrol form submit
        document.getElementById('kaliteForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const formData = {
                id: Date.now(),
                tarih: document.getElementById('tarih').value,
                operator: document.getElementById('operator').value,
                urunKodu: document.getElementById('urunKodu').value.trim(),
                toplamAdet: parseInt(document.getElementById('toplamAdet').value),
                siparisNo: document.getElementById('siparisNo').value.trim(),
                hatalar: []
            };

            // Seçili hataları topla
            const hataCheckboxes = document.querySelectorAll('input[name="hatalar"]:checked');
            hataCheckboxes.forEach(checkbox => {
                const hataItem = checkbox.closest('.hata-item');
                const hataAdetInputs = hataItem.querySelectorAll('.hata-adet');
                const iskartaAdet = parseInt(hataAdetInputs[0].value) || 0;
                const geriGidenAdet = parseInt(hataAdetInputs[1].value) || 0;

                if (iskartaAdet > 0 || geriGidenAdet > 0) {
                    let hataTuru = checkbox.value;
                    // Diğer seçenegi için açıklama ekle
                    if (hataTuru === 'Diğer') {
                        const digerAciklama = document.getElementById('digerHataAciklama').value.trim();
                        if (digerAciklama) {
                            hataTuru = `Diğer: ${digerAciklama}`;
                        }
                    }

                    formData.hatalar.push({
                        tur: hataTuru,
                        iskartaAdet: iskartaAdet,
                        geriGidenAdet: geriGidenAdet
                    });
                }
            });

            if (formData.hatalar.length === 0) {
                showAlert('kaliteAlert', 'Lütfen en az bir hata türü seçin ve adetlerini girin!', 'error');
                return;
            }

            // Kaydet
            kaliteKayitlari.push(formData);
            localStorage.setItem('kaliteKayitlari', JSON.stringify(kaliteKayitlari));

            // Form temizle
            document.getElementById('kaliteForm').reset();
            const now = new Date().toISOString().slice(0, 16);
            document.getElementById('tarih').value = now;

            // Diğer hata detay alanını gizle
            document.getElementById('digerHataDetay').style.display = 'none';

            // Veri listesini güncelle
            loadKaliteKayitlari();
            loadStats();
            showAlert('kaliteAlert', 'Kalite kontrol kaydı başarıyla kaydedildi!', 'success');
        });

        // Sipariş ekleme form submit
        document.getElementById('siparisEkleForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const formData = {
                id: Date.now(),
                tarih: document.getElementById('hazirlikTarih').value,
                operator: document.getElementById('hazirlikOperator').value,
                siparisNo: document.getElementById('hazirlikSiparisNo').value.trim(),
                urunKodu: document.getElementById('urunKoduSiparis').value.trim(),
                siparisAdet: parseInt(document.getElementById('siparisAdet').value),
                durum: 'hazirlanıyor',
                olusturmaTarihi: new Date().toISOString(),
                checkboxDurum: {
                    koli: false,
                    kutu: false,
                    izolasyon: false,
                    etiket: false,
                    posetMevcut: false,
                    tapaMevcut: false
                }
            };

            siparisHazirlikKayitlari.push(formData);
            localStorage.setItem('siparisHazirlikKayitlari', JSON.stringify(siparisHazirlikKayitlari));

            // Form temizle
            document.getElementById('siparisEkleForm').reset();
            const today = new Date().toISOString().slice(0, 10);
            document.getElementById('hazirlikTarih').value = today;

            loadSiparislerListesi();
            loadStats();
            showAlert('siparisEkleAlert', 'Sipariş başarıyla eklendi!', 'success');
        });

        // Siparişleri listele
        function loadSiparislerListesi() {
            const container = document.getElementById('siparislerListesi');
            if (!container) return;

            if (siparisHazirlikKayitlari.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #666; padding: 20px;">Henüz sipariş kaydı bulunmuyor.</p>';
                return;
            }

            let html = '';
            siparisHazirlikKayitlari.slice().reverse().forEach(siparis => {
                const durumRenk = siparis.durum === 'tamamlandı' ? '#27ae60' : siparis.durum === 'hazirlanıyor' ? '#f39c12' : '#e74c3c';
                const durumIcon = siparis.durum === 'tamamlandı' ? '✅' : siparis.durum === 'hazirlanıyor' ? '🔄' : '⏸️';

                html += `
                    <div class="kayit-item">
                        <div class="kayit-header">
                            <div>
                                <strong>🏷️ ${siparis.siparisNo} - 📦 ${siparis.urunKodu}</strong>
                                <span style="margin-left: 15px; background: ${durumRenk}; color: white; padding: 3px 8px; border-radius: 12px; font-size: 12px;">
                                    ${durumIcon} ${siparis.durum.toUpperCase()}
                                </span>
                            </div>
                            <div>
                                <button class="btn-edit" onclick="siparisEdit(${siparis.id})">✏️</button>
                                <button class="btn-delete" onclick="siparisSil(${siparis.id})" style="margin-left: 5px;">🗑️</button>
                            </div>
                        </div>
                        <div class="kayit-details">
                            <div><strong>📅 Tarih:</strong> ${new Date(siparis.tarih).toLocaleDateString('tr-TR')}</div>
                            <div><strong>👤 Operatör:</strong> ${siparis.operator}</div>
                            <div><strong>📊 Adet:</strong> ${siparis.siparisAdet}</div>
                            <div><strong>🕒 Oluşturulma:</strong> ${new Date(siparis.olusturmaTarihi).toLocaleString('tr-TR')}</div>
                        </div>
                        <!-- Checkbox'lar -->
                        <div class="siparis-checkbox-container">
                            <h4 style="margin-bottom: 10px; color: #2c3e50;">📋 Paketleme Kontrol Listesi:</h4>
                            <div class="siparis-checkboxes">
                                <label class="checkbox-item">
                                    <input type="checkbox" ${siparis.checkboxDurum?.koli ? 'checked' : ''} onchange="updateCheckbox(${siparis.id}, 'koli', this.checked)">
                                    ☐ Koli
                                </label>
                                <label class="checkbox-item">
                                    <input type="checkbox" ${siparis.checkboxDurum?.kutu ? 'checked' : ''} onchange="updateCheckbox(${siparis.id}, 'kutu', this.checked)">
                                    ☐ Kutu
                                </label>
                                <label class="checkbox-item">
                                    <input type="checkbox" ${siparis.checkboxDurum?.izolasyon ? 'checked' : ''} onchange="updateCheckbox(${siparis.id}, 'izolasyon', this.checked)">
                                    ☐ İzolasyon
                                </label>
                                <label class="checkbox-item">
                                    <input type="checkbox" ${siparis.checkboxDurum?.etiket ? 'checked' : ''} onchange="updateCheckbox(${siparis.id}, 'etiket', this.checked)">
                                    ☐ Etiket
                                </label>
                                <label class="checkbox-item">
                                    <input type="checkbox" ${siparis.checkboxDurum?.posetMevcut ? 'checked' : ''} onchange="updateCheckbox(${siparis.id}, 'posetMevcut', this.checked)">
                                    ☐ Poşet Mevcut
                                </label>
                                <label class="checkbox-item">
                                    <input type="checkbox" ${siparis.checkboxDurum?.tapaMevcut ? 'checked' : ''} onchange="updateCheckbox(${siparis.id}, 'tapaMevcut', this.checked)">
                                    ☐ Tapa Mevcut
                                </label>
                            </div>
                        </div>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        // Checkbox durumu güncelle
        function updateCheckbox(siparisId, checkboxType, isChecked) {
            const siparis = siparisHazirlikKayitlari.find(s => s.id === siparisId);
            if (siparis) {
                if (!siparis.checkboxDurum) {
                    siparis.checkboxDurum = {};
                }
                siparis.checkboxDurum[checkboxType] = isChecked;
                localStorage.setItem('siparisHazirlikKayitlari', JSON.stringify(siparisHazirlikKayitlari));
            }
        }

        // Sipariş edit
        function siparisEdit(id) {
            const siparis = siparisHazirlikKayitlari.find(s => s.id === id);
            if (!siparis) return;

            const modal = document.getElementById('editModal');
            const container = document.getElementById('editFormContainer');

            container.innerHTML = `
                <form id="editSiparisForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>📅 Tarih</label>
                            <input type="date" id="editTarih" value="${siparis.tarih}" required>
                        </div>
                        <div class="form-group">
                            <label>👤 Operatör</label>
                            <select id="editOperator" required>
                                <option value="Esat" ${siparis.operator === 'Esat' ? 'selected' : ''}>Esat</option>
                                <option value="Ahmet" ${siparis.operator === 'Ahmet' ? 'selected' : ''}>Ahmet</option>
                                <option value="Emre" ${siparis.operator === 'Emre' ? 'selected' : ''}>Emre</option>
                                <option value="Gökay" ${siparis.operator === 'Gökay' ? 'selected' : ''}>Gökay</option>
                                <option value="Berke" ${siparis.operator === 'Berke' ? 'selected' : ''}>Berke</option>
                                <option value="Melisa" ${siparis.operator === 'Melisa' ? 'selected' : ''}>Melisa</option>
                                <option value="Evrim" ${siparis.operator === 'Evrim' ? 'selected' : ''}>Evrim</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>🏷️ Sipariş No</label>
                            <input type="text" id="editSiparisNo" value="${siparis.siparisNo}" required>
                        </div>
                        <div class="form-group">
                            <label>📦 Ürün Kodu</label>
                            <input type="text" id="editUrunKodu" value="${siparis.urunKodu}" required>
                        </div>
                        <div class="form-group">
                            <label>📊 Sipariş Adedi</label>
                            <input type="number" id="editSiparisAdet" value="${siparis.siparisAdet}" min="1" required>
                        </div>
                        <div class="form-group">
                            <label>📋 Durum</label>
                            <select id="editDurum" required>
                                <option value="hazirlanıyor" ${siparis.durum === 'hazirlanıyor' ? 'selected' : ''}>🔄 Hazırlanıyor</option>
                                <option value="tamamlandı" ${siparis.durum === 'tamamlandı' ? 'selected' : ''}>✅ Tamamlandı</option>
                                <option value="beklemede" ${siparis.durum === 'beklemede' ? 'selected' : ''}>⏸️ Beklemede</option>
                            </select>
                        </div>
                    </div>
                    <div style="margin-top: 20px; text-align: center;">
                        <button type="submit" class="btn">💾 Güncelle</button>
                        <button type="button" class="btn btn-danger" onclick="document.getElementById('editModal').style.display='none'" style="margin-left: 10px;">❌ İptal</button>
                    </div>
                </form>
            `;

            modal.style.display = 'block';

            document.getElementById('editSiparisForm').addEventListener('submit', function(e) {
                e.preventDefault();

                siparis.tarih = document.getElementById('editTarih').value;
                siparis.operator = document.getElementById('editOperator').value;
                siparis.siparisNo = document.getElementById('editSiparisNo').value.trim();
                siparis.urunKodu = document.getElementById('editUrunKodu').value.trim();
                siparis.siparisAdet = parseInt(document.getElementById('editSiparisAdet').value);
                siparis.durum = document.getElementById('editDurum').value;
                siparis.guncellemeTarihi = new Date().toISOString();

                localStorage.setItem('siparisHazirlikKayitlari', JSON.stringify(siparisHazirlikKayitlari));
                loadSiparislerListesi();
                loadStats();
                modal.style.display = 'none';
                showAlert('siparisEkleAlert', 'Sipariş başarıyla güncellendi!', 'success');
            });
        }

        // Sipariş sil
        function siparisSil(id) {
            if (confirm('Bu siparişi silmek istediğinizden emin misiniz?')) {
                siparisHazirlikKayitlari = siparisHazirlikKayitlari.filter(s => s.id !== id);
                localStorage.setItem('siparisHazirlikKayitlari', JSON.stringify(siparisHazirlikKayitlari));
                loadSiparislerListesi();
                loadStats();
                showAlert('siparisEkleAlert', 'Sipariş silindi!', 'success');
            }
        }

        // Performans form submit
        document.getElementById('performansForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const performansData = {
                id: Date.now(),
                tarih: document.getElementById('performansTarih').value,
                calisan: document.getElementById('performansCalisan').value,
                ekleyen: document.getElementById('performansEkleyen').value,
                islemler: []
            };

            // İşlem verilerini topla
            const islemler = [
                { ad: 'Kutu Hazırlığı', urun: 'kutuHazirlikUrun', adet: 'kutuHazirlikAdet', sure: 'kutuHazirlikSure' },
                { ad: 'Koli Hazırlama', urun: 'koliHazirlamaUrun', adet: 'koliHazirlamaAdet', sure: 'koliHazirlamaSure' },
                { ad: 'İzolasyon', urun: 'izolasyonUrunPerf', adet: 'izolasyonAdetPerf', sure: 'izolasyonSure' },
                { ad: 'Kalite Kontrol', urun: 'kaliteKontrolUrun', adet: 'kaliteKontrolAdet', sure: 'kaliteKontrolSure' },
                { ad: 'Poşetleme', urun: 'posetlemeUrunPerf', adet: 'posetlemeAdetPerf', sure: 'posetlemeSure' },
                { ad: 'Ürün Kutulama', urun: 'urunKutulamaUrun', adet: 'urunKutulamaAdet', sure: 'urunKutulamaSure' },
                { ad: 'Ek Parça', urun: 'ekParcaUrunPerf', adet: 'ekParcaAdetPerf', sure: 'ekParcaSure' }
            ];

            islemler.forEach(islem => {
                const urun = document.getElementById(islem.urun).value.trim();
                const adet = parseInt(document.getElementById(islem.adet).value) || 0;
                const sure = parseInt(document.getElementById(islem.sure).value) || 0;

                if (urun && adet > 0 && sure > 0) {
                    performansData.islemler.push({
                        ad: islem.ad,
                        urun: urun,
                        adet: adet,
                        sure: sure,
                        hiz: Math.round((adet / sure) * 60 * 100) / 100 // adet/saat
                    });
                }
            });

            if (performansData.islemler.length === 0) {
                showAlert('performansAlert', 'Lütfen en az bir işlem performansı girin!', 'error');
                return;
            }

            performansKayitlari.push(performansData);
            localStorage.setItem('performansKayitlari', JSON.stringify(performansKayitlari));

            document.getElementById('performansForm').reset();
            const today = new Date().toISOString().slice(0, 10);
            document.getElementById('performansTarih').value = today;

            loadPerformansKayitlari();
            loadStats();
            showAlert('performansAlert', 'Performans kaydı başarıyla kaydedildi!', 'success');
        });

        // Performans kayıtlarını listele
        function loadPerformansKayitlari() {
            const container = document.getElementById('performansKayitlariListesi');
            if (!container) return;

            if (performansKayitlari.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #666; padding: 20px;">Henüz performans kaydı bulunmuyor.</p>';
                return;
            }

            let html = '';
            performansKayitlari.slice().reverse().forEach(kayit => {
                const toplamIslem = kayit.islemler.length;
                const ortalamaSure = kayit.islemler.reduce((total, islem) => total + islem.sure, 0) / toplamIslem;
                const toplamAdet = kayit.islemler.reduce((total, islem) => total + islem.adet, 0);

                html += `
                    <div class="kayit-item">
                        <div class="kayit-header">
                            <div>
                                <strong>👤 ${kayit.calisan} - 📅 ${new Date(kayit.tarih).toLocaleDateString('tr-TR')}</strong>
                                <span style="margin-left: 15px; background: #27ae60; color: white; padding: 3px 8px; border-radius: 12px; font-size: 12px;">
                                    📊 ${toplamIslem} İşlem
                                </span>
                            </div>
                            <div>
                                <button class="btn-delete" onclick="performansKaydiSil(${kayit.id})">🗑️</button>
                            </div>
                        </div>
                        <div style="margin-bottom: 15px; padding: 10px; background: #f8f9fa; border-radius: 6px;">
                            <strong>📈 Özet:</strong> Toplam ${toplamAdet} adet, ${Math.round(ortalamaSure)} dk ortalama süre
                            <br><strong>👤 Veri Ekleyen:</strong> ${kayit.ekleyen}
                        </div>
                        <div class="kayit-details">
                `;

                kayit.islemler.forEach(islem => {
                    html += `
                        <div style="background: white; padding: 10px; border-radius: 6px; border: 2px solid #e9ecef;">
                            <strong>${islem.ad}</strong><br>
                            🎯 ${islem.urun}<br>
                            📊 ${islem.adet} adet / ⏱️ ${islem.sure} dk<br>
                            <span style="color: #27ae60; font-weight: bold;">🚀 ${islem.hiz} adet/saat</span>
                        </div>
                    `;
                });

                html += '</div></div>';
            });

            container.innerHTML = html;
        }

        // İstatistikleri yükle
        function loadIstatistikler() {
            // Hata istatistikleri
            const hataIstatContainer = document.getElementById('hataIstatistikleri');
            if (hataIstatContainer) {
                const hataIstatistikleri = {};
                kaliteKayitlari.forEach(kayit => {
                    kayit.hatalar.forEach(hata => {
                        if (!hataIstatistikleri[hata.tur]) {
                            hataIstatistikleri[hata.tur] = { iskarta: 0, geriGiden: 0, toplam: 0 };
                        }
                        hataIstatistikleri[hata.tur].iskarta += hata.iskartaAdet;
                        hataIstatistikleri[hata.tur].geriGiden += hata.geriGidenAdet;
                        hataIstatistikleri[hata.tur].toplam += (hata.iskartaAdet + hata.geriGidenAdet);
                    });
                });

                let hataHtml = '';
                Object.keys(hataIstatistikleri).sort((a, b) => hataIstatistikleri[b].toplam - hataIstatistikleri[a].toplam).forEach(hataTuru => {
                    const hata = hataIstatistikleri[hataTuru];
                    hataHtml += `
                        <div style="display: flex; justify-content: space-between; padding: 10px; margin-bottom: 8px; background: #f8f9fa; border-radius: 6px; border-left: 4px solid #e74c3c;">
                            <span style="font-weight: 600;">${hataTuru}</span>
                            <span>İskarta: <strong>${hata.iskarta}</strong> | Geri Dönen: <strong>${hata.geriGiden}</strong> | <span style="color: #e74c3c; font-weight: bold;">Toplam: ${hata.toplam}</span></span>
                        </div>
                    `;
                });
                hataIstatContainer.innerHTML = hataHtml || '<p style="text-align: center; color: #666;">Henüz hata verisi yok.</p>';
            }

            // Performans istatistikleri
            const performansIstatContainer = document.getElementById('performansIstatistikleri');
            if (performansIstatContainer) {
                const performansIstatistikleri = {};
                performansKayitlari.forEach(kayit => {
                    kayit.islemler.forEach(islem => {
                        if (!performansIstatistikleri[islem.ad]) {
                            performansIstatistikleri[islem.ad] = { adet: 0, sure: 0, sayac: 0 };
                        }
                        performansIstatistikleri[islem.ad].adet += islem.adet;
                        performansIstatistikleri[islem.ad].sure += islem.sure;
                        performansIstatistikleri[islem.ad].sayac++;
                    });
                });

                let performansHtml = '';
                Object.keys(performansIstatistikleri).forEach(islemAdi => {
                    const islem = performansIstatistikleri[islemAdi];
                    const ortalamaSure = Math.round(islem.sure / islem.sayac);
                    const ortalamaHiz = Math.round((islem.adet / islem.sure) * 60 * 100) / 100;
                    performansHtml += `
                        <div style="display: flex; justify-content: space-between; padding: 10px; margin-bottom: 8px; background: #f8f9fa; border-radius: 6px; border-left: 4px solid #27ae60;">
                            <span style="font-weight: 600;">${islemAdi}</span>
                            <span>Toplam: <strong>${islem.adet} adet</strong> | Ortalama: <strong>${ortalamaSure} dk</strong> | <span style="color: #27ae60; font-weight: bold;">Hız: ${ortalamaHiz} adet/saat</span></span>
                        </div>
                    `;
                });
                performansIstatContainer.innerHTML = performansHtml || '<p style="text-align: center; color: #666;">Henüz performans verisi yok.</p>';
            }

            // Çalışan bazlı istatistikler
            const calisanIstatContainer = document.getElementById('calisanIstatistikleri');
            if (calisanIstatContainer) {
                const calisanIstatistikleri = {};

                // Kalite kontrol verilerinden çalışan istatistikleri
                kaliteKayitlari.forEach(kayit => {
                    if (!calisanIstatistikleri[kayit.operator]) {
                        calisanIstatistikleri[kayit.operator] = { kaliteKontrol: 0, performans: 0, toplamUretim: 0, toplamHata: 0 };
                    }
                    calisanIstatistikleri[kayit.operator].kaliteKontrol++;
                    calisanIstatistikleri[kayit.operator].toplamUretim += kayit.toplamAdet;
                    calisanIstatistikleri[kayit.operator].toplamHata += kayit.hatalar.reduce((total, hata) => total + hata.iskartaAdet + hata.geriGidenAdet, 0);
                });

                // Performans verilerinden çalışan istatistikleri
                performansKayitlari.forEach(kayit => {
                    if (!calisanIstatistikleri[kayit.calisan]) {
                        calisanIstatistikleri[kayit.calisan] = { kaliteKontrol: 0, performans: 0, toplamUretim: 0, toplamHata: 0 };
                    }
                    calisanIstatistikleri[kayit.calisan].performans++;
                });

                let calisanHtml = '';
                Object.keys(calisanIstatistikleri).forEach(calisanAdi => {
                    const calisan = calisanIstatistikleri[calisanAdi];
                    const basariOrani = calisan.toplamUretim > 0 ? Math.round((1 - calisan.toplamHata / calisan.toplamUretim) * 100) : 0;
                    calisanHtml += `
                        <div style="padding: 15px; margin-bottom: 10px; background: white; border-radius: 8px; border: 2px solid #e9ecef;">
                            <h5 style="color: #2c3e50; margin-bottom: 10px;">👤 ${calisanAdi}</h5>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 10px; font-size: 14px;">
                                <div>Kalite Kontrol: <strong>${calisan.kaliteKontrol}</strong></div>
                                <div>Performans: <strong>${calisan.performans}</strong></div>
                                <div>Üretim: <strong>${calisan.toplamUretim}</strong></div>
                                <div>Hatalı: <strong style="color: #e74c3c;">${calisan.toplamHata}</strong></div>
                                <div>Başarı: <strong style="color: #27ae60;">${basariOrani}%</strong></div>
                            </div>
                        </div>
                    `;
                });
                calisanIstatContainer.innerHTML = calisanHtml || '<p style="text-align: center; color: #666;">Henüz çalışan verisi yok.</p>';
            }
        }

        // Veri tablosunu yükle
        function loadVeriTablosu() {
            const veriTuru = document.getElementById('veriTuru').value;
            const tarihFiltre = document.getElementById('tarihFiltre').value;
            const container = document.getElementById('veriTablosuContainer');

            if (!container) return;

            let veri = [];
            let baslik = '';

            switch (veriTuru) {
                case 'kalite':
                    veri = kaliteKayitlari;
                    baslik = 'Kalite Kontrol Verileri';
                    break;
                case 'siparis':
                    veri = siparisHazirlikKayitlari;
                    baslik = 'Sipariş Hazırlık Verileri';
                    break;
                case 'performans':
                    veri = performansKayitlari;
                    baslik = 'Performans Verileri';
                    break;
                case 'stok':
                    veri = stokKayitlari;
                    baslik = 'Stok Verileri';
                    break;
                case 'temizleme':
                    veri = temizlemeKayitlari;
                    baslik = 'Temizleme Verileri';
                    break;
                case 'sevkeHazir':
                    veri = sevkeHazirKayitlari;
                    baslik = 'Sevke Hazır Verileri';
                    break;
                case 'sevkEdilen':
                    veri = sevkEdilenKayitlari;
                    baslik = 'Sevk Edilen Verileri';
                    break;
                case 'yariMamul':
                    veri = yariMamulKayitlari;
                    baslik = 'Yarı Mamül Stok Verileri';
                    break;
            }

            // Tarih filtresi uygula
            if (tarihFiltre !== 'hepsi') {
                const bugün = new Date();
                veri = veri.filter(kayit => {
                    const kayitTarihi = new Date(kayit.tarih || kayit.sonGuncelleme || kayit.olusturmaTarihi);
                    switch (tarihFiltre) {
                        case 'bugun':
                            return kayitTarihi.toDateString() === bugün.toDateString();
                        case 'bu-hafta':
                            const haftaOnce = new Date(bugün.getTime() - 7 * 24 * 60 * 60 * 1000);
                            return kayitTarihi >= haftaOnce;
                        case 'bu-ay':
                            return kayitTarihi.getMonth() === bugün.getMonth() && kayitTarihi.getFullYear() === bugün.getFullYear();
                        default:
                            return true;
                    }
                });
            }

            if (veri.length === 0) {
                container.innerHTML = `
                    <div style="background: white; padding: 25px; border-radius: 10px; text-align: center; color: #666;">
                        <h4>${baslik}</h4>
                        <p>Seçilen kriterlere uygun veri bulunamadı.</p>
                    </div>
                `;
                return;
            }

            let html = `
                <div style="background: white; padding: 25px; border-radius: 10px; border: 2px solid #e9ecef; margin-bottom: 20px;">
                    <h4 style="color: #2c3e50; margin-bottom: 20px; text-align: center; background: linear-gradient(135deg, #3498db, #2980b9); color: white; padding: 12px; border-radius: 6px;">
                        ${baslik} (${veri.length} kayıt)
                    </h4>
                    <div style="overflow-x: auto;">
                        <table style="width: 100%; border-collapse: collapse; font-size: 14px;">
            `;

            // Tablo başlığı ve içeriği veri türüne göre oluştur
            switch (veriTuru) {
                case 'kalite':
                    html += `
                        <thead style="background: #f8f9fa;">
                            <tr>
                                <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Tarih</th>
                                <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Operatör</th>
                                <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Ürün Kodu</th>
                                <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Toplam Adet</th>
                                <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Sipariş No</th>
                                <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Hata Sayısı</th>
                            </tr>
                        </thead>
                        <tbody>
                    `;
                    veri.forEach((kayit, index) => {
                        const toplamHata = kayit.hatalar.reduce((total, hata) => total + hata.iskartaAdet + hata.geriGidenAdet, 0);
                        html += `
                            <tr style="background: ${index % 2 === 0 ? '#f8f9fa' : 'white'};">
                                <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">${new Date(kayit.tarih).toLocaleString('tr-TR')}</td>
                                <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">${kayit.operator}</td>
                                <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">${kayit.urunKodu}</td>
                                <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">${kayit.toplamAdet}</td>
                                <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">${kayit.siparisNo}</td>
                                <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center; color: ${toplamHata > 0 ? '#e74c3c' : '#27ae60'}; font-weight: bold;">${toplamHata}</td>
                            </tr>
                        `;
                    });
                    break;

                case 'siparis':
                    html += `
                        <thead style="background: #f8f9fa;">
                            <tr>
                                <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Tarih</th>
                                <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Operatör</th>
                                <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Sipariş No</th>
                                <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Ürün Kodu</th>
                                <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Adet</th>
                                <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Durum</th>
                            </tr>
                        </thead>
                        <tbody>
                    `;
                    veri.forEach((kayit, index) => {
                        const durumRenk = kayit.durum === 'tamamlandı' ? '#27ae60' : kayit.durum === 'hazirlanıyor' ? '#f39c12' : '#e74c3c';
                        html += `
                            <tr style="background: ${index % 2 === 0 ? '#f8f9fa' : 'white'};">
                                <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">${new Date(kayit.tarih).toLocaleDateString('tr-TR')}</td>
                                <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">${kayit.operator}</td>
                                <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">${kayit.siparisNo}</td>
                                <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">${kayit.urunKodu}</td>
                                <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">${kayit.siparisAdet}</td>
                                <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center; color: ${durumRenk}; font-weight: bold;">${kayit.durum.toUpperCase()}</td>
                            </tr>
                        `;
                    });
                    break;

                case 'performans':
                    html += `
                        <thead style="background: #f8f9fa;">
                            <tr>
                                <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Tarih</th>
                                <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Çalışan</th>
                                <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">İşlem Sayısı</th>
                                <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Toplam Adet</th>
                                <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Toplam Süre (dk)</th>
                                <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Ekleyen</th>
                            </tr>
                        </thead>
                        <tbody>
                    `;
                    veri.forEach((kayit, index) => {
                        const toplamAdet = kayit.islemler.reduce((total, islem) => total + islem.adet, 0);
                        const toplamSure = kayit.islemler.reduce((total, islem) => total + islem.sure, 0);
                        html += `
                            <tr style="background: ${index % 2 === 0 ? '#f8f9fa' : 'white'};">
                                <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">${new Date(kayit.tarih).toLocaleDateString('tr-TR')}</td>
                                <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">${kayit.calisan}</td>
                                <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">${kayit.islemler.length}</td>
                                <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">${toplamAdet}</td>
                                <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">${toplamSure}</td>
                                <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">${kayit.ekleyen}</td>
                            </tr>
                        `;
                    });
                    break;

                case 'stok':
                    html += `
                        <thead style="background: #f8f9fa;">
                            <tr>
                                <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Malzeme Türü</th>
                                <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Ürün Adı</th>
                                <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Ölçüler</th>
                                <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Mevcut Adet</th>
                                <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Ekleyen</th>
                                <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Son Güncelleme</th>
                            </tr>
                        </thead>
                        <tbody>
                    `;
                    veri.forEach((kayit, index) => {
                        html += `
                            <tr style="background: ${index % 2 === 0 ? '#f8f9fa' : 'white'};">
                                <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">${kayit.malzemeTuru}</td>
                                <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">${kayit.urunAdi}</td>
                                <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">${kayit.olculeri || '-'}</td>
                                <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center; color: ${kayit.mevcutAdet > 0 ? '#27ae60' : '#e74c3c'}; font-weight: bold;">${kayit.mevcutAdet}</td>
                                <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">${kayit.ekleyen}</td>
                                <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">${new Date(kayit.sonGuncelleme).toLocaleString('tr-TR')}</td>
                            </tr>
                        `;
                    });
                    break;

                case 'temizleme':
                    html += `
                        <thead style="background: #f8f9fa;">
                            <tr>
                                <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Sipariş No</th>
                                <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Ürün Kodu</th>
                                <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Sipariş Adet</th>
                                <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Gelen Adet</th>
                                <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Adet KG</th>
                                <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Toplam KG</th>
                                <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Ekleyen</th>
                            </tr>
                        </thead>
                        <tbody>
                    `;
                    veri.forEach((kayit, index) => {
                        html += `
                            <tr style="background: ${index % 2 === 0 ? '#f8f9fa' : 'white'};">
                                <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">${kayit.siparisNo}</td>
                                <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">${kayit.urunKodu}</td>
                                <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">${kayit.siparisAdet}</td>
                                <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">${kayit.gelenAdet}</td>
                                <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">${kayit.adetKg}</td>
                                <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">${kayit.toplamKg}</td>
                                <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">${kayit.ekleyen}</td>
                            </tr>
                        `;
                    });
                    break;

                case 'sevkeHazir':
                    html += `
                        <thead style="background: #f8f9fa;">
                            <tr>
                                <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Sipariş No</th>
                                <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Ürün No</th>
                                <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Sevke Hazır Adet</th>
                                <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Koli Adeti</th>
                                <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Ekleyen</th>
                                <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Tarih</th>
                            </tr>
                        </thead>
                        <tbody>
                    `;
                    veri.forEach((kayit, index) => {
                        html += `
                            <tr style="background: ${index % 2 === 0 ? '#f8f9fa' : 'white'};">
                                <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">${kayit.siparisNo}</td>
                                <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">${kayit.urunNo}</td>
                                <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">${kayit.sevkeHazirAdet}</td>
                                <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">${kayit.koliAdet}</td>
                                <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">${kayit.ekleyen}</td>
                                <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">${new Date(kayit.tarih).toLocaleString('tr-TR')}</td>
                            </tr>
                        `;
                    });
                    break;

                case 'sevkEdilen':
                    html += `
                        <thead style="background: #f8f9fa;">
                            <tr>
                                <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Sipariş No</th>
                                <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Ürün Türü</th>
                                <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Ürün No</th>
                                <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Teslim Tarihi</th>
                                <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Teslim Adet</th>
                                <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Teslim Alan</th>
                                <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">İrsaliye</th>
                                <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Ekleyen</th>
                            </tr>
                        </thead>
                        <tbody>
                    `;
                    veri.forEach((kayit, index) => {
                        html += `
                            <tr style="background: ${index % 2 === 0 ? '#f8f9fa' : 'white'};">
                                <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">${kayit.siparisNo}</td>
                                <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">${kayit.urunTuru}</td>
                                <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">${kayit.urunNo}</td>
                                <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">${new Date(kayit.teslimTarih).toLocaleDateString('tr-TR')}</td>
                                <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">${kayit.teslimAdet}</td>
                                <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">${kayit.teslimAlan}</td>
                                <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">${kayit.depoIrsaliye}</td>
                                <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">${kayit.ekleyen}</td>
                            </tr>
                        `;
                    });
                    break;

                case 'yariMamul':
                    html += `
                        <thead style="background: #f8f9fa;">
                            <tr>
                                <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Ürün Adı</th>
                                <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Adet</th>
                                <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Hangi Parça</th>
                                <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Not</th>
                                <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Ekleyen</th>
                                <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Tarih</th>
                            </tr>
                        </thead>
                        <tbody>
                    `;
                    veri.forEach((kayit, index) => {
                        html += `
                            <tr style="background: ${index % 2 === 0 ? '#f8f9fa' : 'white'};">
                                <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">${kayit.urunAdi}</td>
                                <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">${kayit.adet}</td>
                                <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">${kayit.hangiParca}</td>
                                <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">${kayit.not || '-'}</td>
                                <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">${kayit.ekleyen}</td>
                                <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">${new Date(kayit.tarih).toLocaleString('tr-TR')}</td>
                            </tr>
                        `;
                    });
                    break;
            }

            html += '</tbody></table></div></div>';
            container.innerHTML = html;
        }

        // İstatistikleri yükle
        function loadStats() {
            document.getElementById('toplamKaliteKayit').textContent = kaliteKayitlari.length;
            document.getElementById('toplamSiparisKayit').textContent = siparisHazirlikKayitlari.length;
            document.getElementById('toplamPerformansKayit').textContent = performansKayitlari.length;

            const tamamlananSiparisCount = siparisHazirlikKayitlari.filter(s => s.durum === 'tamamlandı').length;
            document.getElementById('tamamlananSiparis').textContent = tamamlananSiparisCount;

            const toplamHataAdet = kaliteKayitlari.reduce((total, kayit) => {
                return total + kayit.hatalar.reduce((hataTotal, hata) => hataTotal + hata.iskartaAdet + hata.geriGidenAdet, 0);
            }, 0);
            document.getElementById('toplamHataAdet').textContent = toplamHataAdet;

            const toplamUretim = kaliteKayitlari.reduce((total, kayit) => total + kayit.toplamAdet, 0);
            const basariOrani = toplamUretim > 0 ? Math.round((1 - toplamHataAdet / toplamUretim) * 100) : 0;
            document.getElementById('basariOrani').textContent = basariOrani + '%';

            // Raporlar sayfası için
            if (document.getElementById('toplamKayit')) {
                document.getElementById('toplamKayit').textContent = kaliteKayitlari.length;
                document.getElementById('toplamSiparis').textContent = siparisHazirlikKayitlari.length;
                document.getElementById('toplamPerformans').textContent = performansKayitlari.length;
                document.getElementById('stokSayisi').textContent = stokKayitlari.length;
            }
        }

        // Excel'e veri aktarma
        function exportToExcel(tur) {
            let data = [];
            let filename = '';

            switch (tur) {
                case 'kalite':
                    data = kaliteKayitlari.map(kayit => ({
                        'Tarih': new Date(kayit.tarih).toLocaleString('tr-TR'),
                        'Operatör': kayit.operator,
                        'Ürün Kodu': kayit.urunKodu,
                        'Toplam Adet': kayit.toplamAdet,
                        'Sipariş No': kayit.siparisNo,
                        'Hata Sayısı': kayit.hatalar.reduce((total, hata) => total + hata.iskartaAdet + hata.geriGidenAdet, 0)
                    }));
                    filename = 'kalite_kontrol_verileri';
                    break;
                case 'performans':
                    data = performansKayitlari.map(kayit => ({
                        'Tarih': new Date(kayit.tarih).toLocaleDateString('tr-TR'),
                        'Çalışan': kayit.calisan,
                        'Ekleyen': kayit.ekleyen,
                        'İşlem Sayısı': kayit.islemler.length,
                        'Toplam Adet': kayit.islemler.reduce((total, islem) => total + islem.adet, 0),
                        'Toplam Süre (dk)': kayit.islemler.reduce((total, islem) => total + islem.sure, 0)
                    }));
                    filename = 'performans_verileri';
                    break;
                case 'siparis':
                    data = siparisHazirlikKayitlari.map(kayit => ({
                        'Tarih': new Date(kayit.tarih).toLocaleDateString('tr-TR'),
                        'Operatör': kayit.operator,
                        'Sipariş No': kayit.siparisNo,
                        'Ürün Kodu': kayit.urunKodu,
                        'Adet': kayit.siparisAdet,
                        'Durum': kayit.durum
                    }));
                    filename = 'siparis_verileri';
                    break;
                case 'hepsi':
                    // Tüm verileri tek Excel'de farklı sheet'lerde topla
                    const kaliteData = kaliteKayitlari.map(kayit => ({
                        'Tarih': new Date(kayit.tarih).toLocaleString('tr-TR'),
                        'Operatör': kayit.operator,
                        'Ürün Kodu': kayit.urunKodu,
                        'Toplam Adet': kayit.toplamAdet,
                        'Sipariş No': kayit.siparisNo,
                        'Hata Sayısı': kayit.hatalar.reduce((total, hata) => total + hata.iskartaAdet + hata.geriGidenAdet, 0)
                    }));
                    
                    const performansData = performansKayitlari.map(kayit => ({
                        'Tarih': new Date(kayit.tarih).toLocaleDateString('tr-TR'),
                        'Çalışan': kayit.calisan,
                        'Ekleyen': kayit.ekleyen,
                        'İşlem Sayısı': kayit.islemler.length,
                        'Toplam Adet': kayit.islemler.reduce((total, islem) => total + islem.adet, 0),
                        'Toplam Süre (dk)': kayit.islemler.reduce((total, islem) => total + islem.sure, 0)
                    }));

                    const siparisData = siparisHazirlikKayitlari.map(kayit => ({
                        'Tarih': new Date(kayit.tarih).toLocaleDateString('tr-TR'),
                        'Operatör': kayit.operator,
                        'Sipariş No': kayit.siparisNo,
                        'Ürün Kodu': kayit.urunKodu,
                        'Adet': kayit.siparisAdet,
                        'Durum': kayit.durum
                    }));

                    const stokData = stokKayitlari.map(kayit => ({
                        'Malzeme Türü': kayit.malzemeTuru,
                        'Ürün Adı': kayit.urunAdi,
                        'Ölçüler': kayit.olculeri || '-',
                        'Mevcut Adet': kayit.mevcutAdet,
                        'Ekleyen': kayit.ekleyen,
                        'Son Güncelleme': new Date(kayit.sonGuncelleme).toLocaleString('tr-TR')
                    }));

                    // Tüm verileri CSV formatında birleştir
                    let csvContent = "KALITE KONTROL VERİLERİ\n";
                    csvContent += convertToCSV(kaliteData) + "\n\n";
                    
                    csvContent += "PERFORMANS VERİLERİ\n";
                    csvContent += convertToCSV(performansData) + "\n\n";
                    
                    csvContent += "SİPARİŞ VERİLERİ\n";
                    csvContent += convertToCSV(siparisData) + "\n\n";
                    
                    csvContent += "STOK VERİLERİ\n";
                    csvContent += convertToCSV(stokData) + "\n\n";

                    downloadCSV(csvContent, 'tum_veriler.csv');
                    return;
            }

            if (data.length === 0) {
                alert('Aktarılacak veri bulunamadı!');
                return;
            }

            const csvContent = convertToCSV(data);
            downloadCSV(csvContent, `${filename}.csv`);
        }

        // CSV formatına dönüştür
        function convertToCSV(data) {
            if (data.length === 0) return '';

            const headers = Object.keys(data[0]);
            const csvRows = [];

            // Başlıkları ekle
            csvRows.push(headers.join(','));

            // Verileri ekle
            for (const row of data) {
                const values = headers.map(header => {
                    const value = row[header];
                    return `"${value}"`;
                });
                csvRows.push(values.join(','));
            }

            return csvRows.join('\n');
        }

        // CSV dosyasını indir
        function downloadCSV(csvContent, filename) {
            const blob = new Blob(['\ufeff' + csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', filename);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showAlert('exportAlert', `${filename} başarıyla indirildi!`, 'success');
        }

        // Tüm verileri yedekle (JSON formatında)
        function exportAllData() {
            const allData = {
                kaliteKayitlari: kaliteKayitlari,
                siparisHazirlikKayitlari: siparisHazirlikKayitlari,
                performansKayitlari: performansKayitlari,
                stokKayitlari: stokKayitlari,
                temizlemeKayitlari: temizlemeKayitlari,
                sevkeHazirKayitlari: sevkeHazirKayitlari,
                sevkEdilenKayitlari: sevkEdilenKayitlari,
                yariMamulKayitlari: yariMamulKayitlari,
                exportDate: new Date().toISOString()
            };

            const dataStr = JSON.stringify(allData, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = `uretim_sistemi_yedek_${new Date().toISOString().split('T')[0]}.json`;
            link.click();

            alert('Tüm veriler başarıyla yedeklendi!');
        }

        // Verileri geri yükle
        function importData() {
            const fileInput = document.getElementById('importFile');
            const file = fileInput.files[0];

            if (!file) {
                alert('Lütfen bir dosya seçin!');
                return;
            }

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const importedData = JSON.parse(e.target.result);
                    
                    if (confirm('Mevcut tüm veriler silinecek ve yedekten geri yüklenecek. Devam etmek istediğinizden emin misiniz?')) {
                        // Verileri geri yükle
                        kaliteKayitlari = importedData.kaliteKayitlari || [];
                        siparisHazirlikKayitlari = importedData.siparisHazirlikKayitlari || [];
                        performansKayitlari = importedData.performansKayitlari || [];
                        stokKayitlari = importedData.stokKayitlari || [];
                        temizlemeKayitlari = importedData.temizlemeKayitlari || [];
                        sevkeHazirKayitlari = importedData.sevkeHazirKayitlari || [];
                        sevkEdilenKayitlari = importedData.sevkEdilenKayitlari || [];
                        yariMamulKayitlari = importedData.yariMamulKayitlari || [];

                        // LocalStorage'a kaydet
                        localStorage.setItem('kaliteKayitlari', JSON.stringify(kaliteKayitlari));
                        localStorage.setItem('siparisHazirlikKayitlari', JSON.stringify(siparisHazirlikKayitlari));
                        localStorage.setItem('performansKayitlari', JSON.stringify(performansKayitlari));
                        localStorage.setItem('stokKayitlari', JSON.stringify(stokKayitlari));
                        localStorage.setItem('temizlemeKayitlari', JSON.stringify(temizlemeKayitlari));
                        localStorage.setItem('sevkeHazirKayitlari', JSON.stringify(sevkeHazirKayitlari));
                        localStorage.setItem('sevkEdilenKayitlari', JSON.stringify(sevkEdilenKayitlari));
                        localStorage.setItem('yariMamulKayitlari', JSON.stringify(yariMamulKayitlari));

                        // Sayfayı yenile
                        location.reload();
                        
                        alert('Veriler başarıyla geri yüklendi!');
                    }
                } catch (error) {
                    alert('Dosya formatı geçersiz! Lütfen geçerli bir yedek dosyası seçin.');
                    console.error('Import error:', error);
                }
            };

            reader.readAsText(file);
            fileInput.value = ''; // Input'u temizle
        }

        // Tüm verileri temizle
        function clearAllData() {
            if (confirm('TÜM VERİLER SİLİNECEK! Bu işlem geri alınamaz. Devam etmek istediğinizden emin misiniz?')) {
                if (confirm('SON UYARI: Bu işlem tüm kalite kontrol, sipariş, performans, stok ve diğer tüm verileri kalıcı olarak silecek. Gerçekten devam etmek istiyor musunuz?')) {
                    // Tüm verileri temizle
                    localStorage.clear();
                    
                    // Global değişkenleri sıfırla
                    kaliteKayitlari = [];
                    siparisHazirlikKayitlari = [];
                    performansKayitlari = [];
                    stokKayitlari = [];
                    temizlemeKayitlari = [];
                    sevkeHazirKayitlari = [];
                    sevkEdilenKayitlari = [];
                    yariMamulKayitlari = [];

                    // Sayfayı yenile
                    location.reload();
                    
                    alert('Tüm veriler başarıyla temizlendi!');
                }
            }
        }

        // Veri türü seçimi değiştiğinde tabloyu güncelle
        document.addEventListener('change', function(e) {
            if (e.target.id === 'veriTuru' || e.target.id === 'tarihFiltre') {
                loadVeriTablosu();
            }
        });

        // Modal kapatma için escape tuşu
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                document.getElementById('editModal').style.display = 'none';
            }
        });

        // Modal dışına tıklayınca kapat
        document.getElementById('editModal').addEventListener('click', function(e) {
            if (e.target === this) {
                this.style.display = 'none';
            }
        });

        // Form validation ve user experience iyileştirmeleri
        function validateForm(formId) {
            const form = document.getElementById(formId);
            const requiredFields = form.querySelectorAll('[required]');
            let isValid = true;

            requiredFields.forEach(field => {
                if (!field.value.trim()) {
                    field.style.borderColor = '#e74c3c';
                    isValid = false;
                } else {
                    field.style.borderColor = '#ddd';
                }
            });

            return isValid;
        }

        // Auto-save functionality (5 dakikada bir otomatik kaydet)
        setInterval(() => {
            const hasData = kaliteKayitlari.length > 0 || 
                          siparisHazirlikKayitlari.length > 0 || 
                          performansKayitlari.length > 0 || 
                          stokKayitlari.length > 0;
            
            if (hasData) {
                console.log('Auto-save: Veriler otomatik olarak kaydedildi.', new Date().toLocaleTimeString('tr-TR'));
            }
        }, 300000); // 5 dakika

        // Sayfa kapatılırken uyarı (eğer kaydedilmemiş veri varsa)
        window.addEventListener('beforeunload', function(e) {
            // Bu özellik artık pek çok tarayıcıda çalışmaz, ama yine de ekleyelim
            const hasUnsavedData = false; // Gerçek uygulamada bunu kontrol edebilirsiniz
            
            if (hasUnsavedData) {
                e.preventDefault();
                e.returnValue = '';
                return '';
            }
        });

        // Responsive table için yardımcı fonksiyon
        function makeTablesResponsive() {
            const tables = document.querySelectorAll('table');
            tables.forEach(table => {
                const wrapper = document.createElement('div');
                wrapper.style.overflowX = 'auto';
                table.parentNode.insertBefore(wrapper, table);
                wrapper.appendChild(table);
            });
        }

        // Dark mode toggle (opsiyonel)
        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
            const isDarkMode = document.body.classList.contains('dark-mode');
            localStorage.setItem('darkMode', isDarkMode.toString());
        }

        // Dark mode durumunu yükle
        document.addEventListener('DOMContentLoaded', function() {
            const isDarkMode = localStorage.getItem('darkMode') === 'true';
            if (isDarkMode) {
                document.body.classList.add('dark-mode');
            }
        });

        // Arama/filtreleme fonksiyonu
        function searchData(searchTerm, dataArray) {
            if (!searchTerm) return dataArray;
            
            return dataArray.filter(item => {
                const searchFields = Object.values(item).join(' ').toLowerCase();
                return searchFields.includes(searchTerm.toLowerCase());
            });
        }

        // Toplam hesaplama yardımcı fonksiyonu
        function calculateTotals() {
            const totals = {
                kaliteKayitlari: kaliteKayitlari.length,
                siparisHazirlikKayitlari: siparisHazirlikKayitlari.length,
                performansKayitlari: performansKayitlari.length,
                stokKayitlari: stokKayitlari.length,
                temizlemeKayitlari: temizlemeKayitlari.length,
                sevkeHazirKayitlari: sevkeHazirKayitlari.length,
                sevkEdilenKayitlari: sevkEdilenKayitlari.length,
                yariMamulKayitlari: yariMamulKayitlari.length,
                toplamUretim: kaliteKayitlari.reduce((total, kayit) => total + kayit.toplamAdet, 0),
                toplamHata: kaliteKayitlari.reduce((total, kayit) => 
                    total + kayit.hatalar.reduce((hataTotal, hata) => 
                        hataTotal + hata.iskartaAdet + hata.geriGidenAdet, 0), 0),
                tamamlananSiparisler: siparisHazirlikKayitlari.filter(s => s.durum === 'tamamlandı').length
            };

            totals.basariOrani = totals.toplamUretim > 0 ? 
                Math.round((1 - totals.toplamHata / totals.toplamUretim) * 100) : 0;

            return totals;
        }

        // Grafik gösterimi için basit chart oluşturma (Chart.js olmadan)
        function createSimpleChart(data, containerId) {
            const container = document.getElementById(containerId);
            if (!container) return;

            let html = '<div class="simple-chart">';
            const maxValue = Math.max(...data.values);
            
            data.labels.forEach((label, index) => {
                const value = data.values[index];
                const percentage = (value / maxValue) * 100;
                
                html += `
                    <div class="chart-bar" style="margin-bottom: 10px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                            <span style="font-weight: 600;">${label}</span>
                            <span style="font-weight: bold; color: #3498db;">${value}</span>
                        </div>
                        <div style="background: #ecf0f1; height: 20px; border-radius: 10px; overflow: hidden;">
                            <div style="background: linear-gradient(90deg, #3498db, #2980b9); height: 100%; width: ${percentage}%; border-radius: 10px; transition: width 0.3s ease;"></div>
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            container.innerHTML = html;
        }

        // Print özelliği
        function printReport(sectionId) {
            const printContent = document.getElementById(sectionId).innerHTML;
            const originalContent = document.body.innerHTML;
            
            document.body.innerHTML = `
                <html>
                <head>
                   <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
                    <title>Üretim Sistemi Raporu</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 20px; }
                        table { width: 100%; border-collapse: collapse; margin: 20px 0; }
                        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
                        th { background-color: #f8f9fa; }
                        .no-print { display: none; }
                    </style>
                </head>
                <body>
                    <h1>Üretim Sistemi Raporu</h1>
                    <p>Tarih: ${new Date().toLocaleString('tr-TR')}</p>
                    ${printContent}
                </body>
                </html>
            `;
            
            window.print();
            document.body.innerHTML = originalContent;
            
            // Event listener'ları yeniden yükle
            location.reload();
        }

        // Sistem durum kontrolü
        function checkSystemHealth() {
            const health = {
                localStorage: typeof(Storage) !== "undefined",
                dataIntegrity: true,
                lastBackup: localStorage.getItem('lastBackup') || 'Hiç yedeklenmemiş',
                totalRecords: calculateTotals()
            };

            // Veri bütünlüğü kontrolü
            try {
                JSON.parse(localStorage.getItem('kaliteKayitlari') || '[]');
                JSON.parse(localStorage.getItem('siparisHazirlikKayitlari') || '[]');
                JSON.parse(localStorage.getItem('performansKayitlari') || '[]');
            } catch (e) {
                health.dataIntegrity = false;
            }

            return health;
        }

        // Hata logları
        function logError(error, context) {
            const errorLog = {
                timestamp: new Date().toISOString(),
                error: error.toString(),
                context: context,
                userAgent: navigator.userAgent,
                url: window.location.href
            };

            // Local storage'da hata logları tut (maksimum 100 adet)
            let errorLogs = JSON.parse(localStorage.getItem('errorLogs') || '[]');
            errorLogs.unshift(errorLog);
            
            if (errorLogs.length > 100) {
                errorLogs = errorLogs.slice(0, 100);
            }
            
            localStorage.setItem('errorLogs', JSON.stringify(errorLogs));
            console.error('System Error:', errorLog);
        }

        // Global error handler
        window.addEventListener('error', function(e) {
            logError(e.error, 'Global Error Handler');
        });

        // Performans metrikleri
        function trackPerformance() {
            if (performance && performance.timing) {
                const perfData = performance.timing;
                const pageLoadTime = perfData.loadEventEnd - perfData.navigationStart;
                console.log(`Sayfa yükleme süresi: ${pageLoadTime}ms`);
            }
        }

        // Sayfa yüklendiğinde performans takibi
        window.addEventListener('load', trackPerformance);

        // Kullanıcı aktivite takibi (basit)
        let userActivity = {
            lastActive: Date.now(),
            sessionStart: Date.now(),
            actionsCount: 0
        };

        document.addEventListener('click', function() {
            userActivity.lastActive = Date.now();
            userActivity.actionsCount++;
        });

        document.addEventListener('keypress', function() {
            userActivity.lastActive = Date.now();
            userActivity.actionsCount++;
        });

        // Oturum süresi kontrolü (1 saat)
        setInterval(function() {
            const now = Date.now();
            const inactiveTime = now - userActivity.lastActive;
            
            if (inactiveTime > 3600000) { // 1 saat
                console.log('Kullanıcı uzun süredir aktif değil');
                // Burada oturum sonu işlemleri yapılabilir
            }
        }, 60000); // Her dakika kontrol et

        // Veri analizi fonksiyonları
        function getProductivityStats() {
            const now = new Date();
            const thisWeek = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
            const thisMonth = new Date(now.getFullYear(), now.getMonth(), 1);

            const weeklyData = kaliteKayitlari.filter(k => new Date(k.tarih) >= thisWeek);
            const monthlyData = kaliteKayitlari.filter(k => new Date(k.tarih) >= thisMonth);

            return {
                weekly: {
                    totalProduction: weeklyData.reduce((total, k) => total + k.toplamAdet, 0),
                    totalErrors: weeklyData.reduce((total, k) => total + k.hatalar.reduce((ht, h) => ht + h.iskartaAdet + h.geriGidenAdet, 0), 0),
                    recordCount: weeklyData.length
                },
                monthly: {
                    totalProduction: monthlyData.reduce((total, k) => total + k.toplamAdet, 0),
                    totalErrors: monthlyData.reduce((total, k) => total + k.hatalar.reduce((ht, h) => ht + h.iskartaAdet + h.geriGidenAdet, 0), 0),
                    recordCount: monthlyData.length
                }
            };
        }

        // Sistem bilgileri topla
        function getSystemInfo() {
            return {
                timestamp: new Date().toISOString(),
                userAgent: navigator.userAgent,
                screen: {
                    width: screen.width,
                    height: screen.height
                },
                window: {
                    width: window.innerWidth,
                    height: window.innerHeight
                },
                localStorage: {
                    available: typeof(Storage) !== "undefined",
                    used: JSON.stringify(localStorage).length,
                    keys: Object.keys(localStorage).length
                },
                performance: getProductivityStats(),
                health: checkSystemHealth()
            };
        }

        console.log('🏭 Üretim Takip Sistemi başarıyla yüklendi!');
        console.log('📊 Sistem Bilgileri:', getSystemInfo());
    </script>
</body>
</html>
