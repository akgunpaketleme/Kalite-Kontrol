<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AKG Kalite Kontrol ve Üretim Takip Sistemi</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 10px;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: white;
            padding: 30px;
            text-align: center;
        }
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
        .tabs {
            display: flex;
            background: #34495e;
            overflow-x: auto;
            padding: 0 20px;
        }
        .tab {
            padding: 12px 18px;
            cursor: pointer;
            color: rgba(255, 255, 255, 0.7);
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            white-space: nowrap;
            font-weight: 500;
            font-size: 0.9em;
        }
        .tab:hover {
            color: white;
            background: rgba(255, 255, 255, 0.1);
        }
        .tab.active {
            color: #3498db;
            border-bottom-color: #3498db;
            background: rgba(52, 152, 219, 0.1);
        }
        .tab-content {
            display: none;
            padding: 30px;
            animation: fadeIn 0.3s ease-in;
        }
        .tab-content.active {
            display: block;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }
        .form-group {
            display: flex;
            flex-direction: column;
        }
        .form-group label {
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
            font-size: 0.95em;
        }
        .form-group input,
        .form-group select {
            padding: 12px 15px;
            border: 2px solid #e0e6ed;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: white;
        }
        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }
        .hata-container {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border: 2px solid #e9ecef;
        }
        .hata-container h3 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.2em;
            text-align: center;
        }
        .hata-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 15px;
        }
        .hata-item {
            display: flex;
            align-items: center;
            background: white;
            padding: 15px;
            border-radius: 8px;
            border: 2px solid #e9ecef;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }
        .hata-item input[type="checkbox"] {
            margin-right: 12px;
            transform: scale(1.3);
        }
        .hata-item label {
            flex: 1;
            margin: 0;
            cursor: pointer;
            font-weight: 500;
            color: #2c3e50;
        }
        .hata-adet-container {
            display: flex;
            gap: 8px;
            margin-left: 10px;
        }
        .hata-adet {
            width: 70px;
            padding: 8px;
            border: 2px solid #ddd;
            border-radius: 6px;
            text-align: center;
            font-size: 14px;
            font-weight: 500;
        }
        .hata-adet:first-child {
            border-color: #e74c3c;
        }
        .hata-adet:last-child {
            border-color: #f39c12;
        }
        .btn {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin: 5px;
        }
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(52, 152, 219, 0.3);
        }
        .btn-success {
            background: linear-gradient(135deg, #27ae60, #219a52);
        }
        .btn-danger {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }
        .btn-edit {
            background: linear-gradient(135deg, #f39c12, #e67e22);
            padding: 8px 15px;
            font-size: 12px;
            margin: 2px;
        }
        .btn-delete {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            padding: 8px 15px;
            font-size: 12px;
            margin: 2px;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }
        .stat-card h3 {
            font-size: 2em;
            margin-bottom: 10px;
        }
        .stat-card p {
            opacity: 0.9;
            font-size: 0.9em;
        }
        .kayit-item {
            background: white;
            border: 1px solid #e0e6ed;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }
        .kayit-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            font-weight: 600;
            color: #2c3e50;
        }
        .kayit-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            font-size: 0.9em;
            color: #666;
        }
        .alert {
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            font-weight: 500;
        }
        .alert-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .alert-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .stok-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        .stok-item {
            background: white;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #e9ecef;
            text-align: center;
        }
        .stok-item h4 {
            color: #2c3e50;
            margin-bottom: 15px;
        }
        .stok-input {
            width: 100%;
            padding: 10px;
            border: 2px solid #3498db;
            border-radius: 6px;
            text-align: center;
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 10px;
        }
        .stok-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 10px;
        }
        .stok-btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
        }
        .stok-btn:hover {
            background: #2980b9;
        }
        .stok-btn.minus {
            background: #e74c3c;
        }
        .stok-btn.minus:hover {
            background: #c0392b;
        }
        .urun-input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin-bottom: 5px;
        }
        .performance-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .performance-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #e9ecef;
        }
        .performance-card h4 {
            color: #2c3e50;
            margin-bottom: 15px;
            text-align: center;
            background: #f8f9fa;
            padding: 10px;
            border-radius: 6px;
        }
        .siparis-item {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }
        .siparis-header {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .siparis-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
        }
        .siparis-malzeme {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border: 2px solid #dee2e6;
        }
        .siparis-malzeme h5 {
            margin-bottom: 15px;
            color: #2c3e50;
            text-align: center;
            font-size: 1.1em;
        }
        .malzeme-info {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 10px;
            align-items: center;
            margin-bottom: 10px;
        }
        .malzeme-adet {
            text-align: center;
            font-weight: bold;
            color: #2c3e50;
        }
        .checkbox-container {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        .checkbox-item {
            display: flex;
            align-items: center;
            font-size: 0.9em;
            padding: 5px 10px;
            border-radius: 4px;
        }
        .checkbox-item input[type="checkbox"] {
            margin-right: 8px;
            transform: scale(1.2);
        }
        .checkbox-item.hazir {
            background: #d4edda;
            border: 1px solid #27ae60;
        }
        .checkbox-item.mevcut {
            background: #e7f3ff;
            border: 1px solid #3498db;
        }
        .edit-form {
            display: none;
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-top: 15px;
            border: 2px solid #3498db;
        }
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }
        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 20px;
            border-radius: 10px;
            width: 90%;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
        }
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }
        .close:hover {
            color: black;
        }
        .istatistik-card {
            background: white;
            padding: 25px;
            border-radius: 10px;
            border: 2px solid #e9ecef;
            margin-bottom: 20px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }
        .istatistik-card h4 {
            color: #2c3e50;
            margin-bottom: 15px;
            text-align: center;
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            padding: 12px;
            border-radius: 6px;
            font-size: 1.2em;
        }
        .istatistik-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 15px;
            margin: 8px 0;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #3498db;
        }
        .istatistik-item strong {
            color: #2c3e50;
        }
        .istatistik-value {
            font-weight: bold;
            color: #27ae60;
        }
        .veri-tablosu {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            margin: 20px 0;
        }
        .veri-tablosu th {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: 600;
        }
        .veri-tablosu td {
            padding: 12px;
            border-bottom: 1px solid #e9ecef;
        }
        .veri-tablosu tr:hover {
            background: #f8f9fa;
        }
        .veri-tablosu tr:nth-child(even) {
            background: #f8f9fa;
        }
        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
            .hata-grid {
                grid-template-columns: 1fr;
            }
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            .tabs {
                padding: 0 10px;
            }
            .tab {
                padding: 10px 12px;
                font-size: 0.8em;
            }
            .container {
                margin: 5px;
                border-radius: 10px;
            }
            .tab-content {
                padding: 20px 15px;
            }
            .siparis-grid {
                grid-template-columns: 1fr;
            }
            .malzeme-info {
                grid-template-columns: 1fr;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🏭 AKG Kalite Kontrol ve Üretim Takip Sistemi</h1>
        </div>
        <div class="tabs">
            <div class="tab active" onclick="showTab('kalite-kontrol')">📝 Kalite Kontrol</div>
            <div class="tab" onclick="showTab('siparis-hazirlik')">📋 Sipariş Hazırlığı</div>
            <div class="tab" onclick="showTab('stok')">📦 Stok</div>
            <div class="tab" onclick="showTab('gunluk-performans')">⏱️ Günlük Performans</div>
            <div class="tab" onclick="showTab('istatistikler')">📈 İstatistikler</div>
            <div class="tab" onclick="showTab('veri-goruntule')">📊 Veri Görüntüle</div>
            <div class="tab" onclick="showTab('raporlar')">📋 Raporlar</div>
            <div class="tab" onclick="showTab('ayarlar')">⚙️ Ayarlar</div>
        </div>

        <!-- Kalite Kontrol Tab -->
        <div id="kalite-kontrol" class="tab-content active">
            <h2>🔍 Kalite Kontrol Formu</h2>
            <form id="kaliteForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="tarih">📅 Tarih/Saat</label>
                        <input type="datetime-local" id="tarih" required>
                    </div>
                    <div class="form-group">
                        <label for="operator">👤 Operatörün Adı</label>
                        <input type="text" id="operator" placeholder="Operatör adını yazın" required>
                    </div>
                    <div class="form-group">
                        <label for="urunKodu">📦 Ürün Kodu</label>
                        <input type="text" id="urunKodu" placeholder="Ürün kodunu girin" required>
                    </div>
                    <div class="form-group">
                        <label for="toplamAdet">📊 Toplam Adet</label>
                        <input type="number" id="toplamAdet" min="1" placeholder="Toplam ürün adedi" required>
                    </div>
                    <div class="form-group">
                        <label for="siparisNo">🏷️ Sipariş Numarası</label>
                        <input type="text" id="siparisNo" placeholder="Sipariş numarasını girin" required>
                    </div>
                </div>

                <div class="hata-container">
                    <h3>🚫 Hata Türleri ve Adetleri</h3>
                    <div style="display: flex; justify-content: flex-end; margin-bottom: 15px; gap: 8px; font-size: 12px; color: #666; font-weight: bold;">
                        <span style="color: #e74c3c; width: 70px; text-align: center;">İskarta</span>
                        <span style="color: #f39c12; width: 70px; text-align: center;">Geri Giden</span>
                    </div>
                    <div class="hata-grid">
                        <div class="hata-item">
                            <input type="checkbox" id="hata1" name="hatalar" value="Ağız yamukluğu">
                            <label for="hata1">Ağız yamukluğu</label>
                            <div class="hata-adet-container">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                            </div>
                        </div>
                        <div class="hata-item">
                            <input type="checkbox" id="hata2" name="hatalar" value="Yetersiz kaynak">
                            <label for="hata2">Yetersiz kaynak</label>
                            <div class="hata-adet-container">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                            </div>
                        </div>
                        <div class="hata-item">
                            <input type="checkbox" id="hata3" name="hatalar" value="Fazla kaynak">
                            <label for="hata3">Fazla kaynak</label>
                            <div class="hata-adet-container">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                            </div>
                        </div>
                        <div class="hata-item">
                            <input type="checkbox" id="hata4" name="hatalar" value="Bakır erimesi">
                            <label for="hata4">Bakır erimesi</label>
                            <div class="hata-adet-container">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                            </div>
                        </div>
                        <div class="hata-item">
                            <input type="checkbox" id="hata5" name="hatalar" value="Dışa kaynak akması">
                            <label for="hata5">Dışa kaynak akması</label>
                            <div class="hata-adet-container">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                            </div>
                        </div>
                        <div class="hata-item">
                            <input type="checkbox" id="hata6" name="hatalar" value="Vuruk">
                            <label for="hata6">Vuruk</label>
                            <div class="hata-adet-container">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                            </div>
                        </div>
                        <div class="hata-item">
                            <input type="checkbox" id="hata7" name="hatalar" value="Boğum uzunluğu farklılığı">
                            <label for="hata7">Boğum uzunluğu farklılığı</label>
                            <div class="hata-adet-container">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                            </div>
                        </div>
                        <div class="hata-item">
                            <input type="checkbox" id="hata8" name="hatalar" value="Boğum yamukluğu">
                            <label for="hata8">Boğum yamukluğu</label>
                            <div class="hata-adet-container">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                            </div>
                        </div>
                        <div class="hata-item">
                            <input type="checkbox" id="hata9" name="hatalar" value="Çizik ürün">
                            <label for="hata9">Çizik ürün</label>
                            <div class="hata-adet-container">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                            </div>
                        </div>
                        <div class="hata-item">
                            <input type="checkbox" id="hata10" name="hatalar" value="Temizlenememiş ürün">
                            <label for="hata10">Temizlenememiş ürün</label>
                            <div class="hata-adet-container">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                            </div>
                        </div>
                        <div class="hata-item">
                            <input type="checkbox" id="hata11" name="hatalar" value="Bilyeli ürün">
                            <label for="hata11">Bilyeli ürün</label>
                            <div class="hata-adet-container">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                            </div>
                        </div>
                        <div class="hata-item">
                            <input type="checkbox" id="hataDiger" name="hatalar" value="Diğer">
                            <label for="hataDiger">Diğer</label>
                            <div class="hata-adet-container">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                                <input type="number" class="hata-adet" placeholder="0" min="0">
                            </div>
                        </div>
                    </div>
                    
                    <div id="digerHataDetay" style="display: none; margin-top: 15px;">
                        <label for="digerHataAciklama" style="display: block; margin-bottom: 5px; font-weight: bold;">Diğer Hata Açıklaması:</label>
                        <input type="text" id="digerHataAciklama" placeholder="Hata detayını yazın..." style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 6px;">
                    </div>
                </div>

                <button type="submit" class="btn">💾 Kalite Kontrol Kaydını Kaydet</button>
            </form>
            <div id="kaliteAlert"></div>
            
            <div id="kaliteKayitlar">
                <h3>📋 Son Kalite Kontrol Kayıtları</h3>
                <div id="kaliteKayitlariListesi"></div>
            </div>
        </div>
        <!-- Sipariş Hazırlığı Tab -->
        <div id="siparis-hazirlik" class="tab-content">
            <h2>📋 Sipariş Hazırlığı</h2>
            
            <!-- Yeni Sipariş Ekleme Formu -->
            <form id="siparisEkleForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="hazirlikTarih">📅 Tarih</label>
                        <input type="date" id="hazirlikTarih" required>
                    </div>
                    <div class="form-group">
                        <label for="hazirlikOperator">👤 Hazırlayan</label>
                        <input type="text" id="hazirlikOperator" placeholder="Hazırlayan kişinin adı" required>
                    </div>
                    <div class="form-group">
                        <label for="hazirlikSiparisNo">🏷️ Sipariş No</label>
                        <input type="text" id="hazirlikSiparisNo" placeholder="Sipariş numarası" required>
                    </div>
                    <div class="form-group">
                        <label for="urunKoduSiparis">📦 Ürün Kodu</label>
                        <input type="text" id="urunKoduSiparis" placeholder="Ürün kodu (örn: 1509)" required>
                    </div>
                    <div class="form-group">
                        <label for="siparisAdet">📊 Sipariş Adedi</label>
                        <input type="number" id="siparisAdet" min="1" placeholder="Sipariş adedi (örn: 1000)" required>
                    </div>
                </div>
                <button type="submit" class="btn btn-success">➕ Sipariş Ekle</button>
            </form>
            <div id="siparisEkleAlert"></div>

            <hr style="margin: 30px 0; border: 1px solid #e9ecef;">

            <!-- Mevcut Siparişler -->
            <h3>📋 Mevcut Siparişler</h3>
            <div id="siparislerListesi"></div>

            <!-- Modal for Editing -->
            <div id="editModal" class="modal">
                <div class="modal-content">
                    <span class="close">&times;</span>
                    <h3>✏️ Sipariş Düzenle</h3>
                    <div id="editFormContainer"></div>
                </div>
            </div>
        </div>

        <!-- Stok Tab -->
        <div id="stok" class="tab-content">
            <h2>📦 Stok Takibi</h2>
            <div class="stok-grid">
                <div class="stok-item">
                    <h4>🔧 İzolasyon</h4>
                    <input type="text" class="urun-input" id="izolasyonUrun" placeholder="Ürün İsmi">
                    <input type="number" class="stok-input" id="stokIzolasyon" placeholder="0" min="0" readonly>
                    <div class="stok-controls">
                        <button class="stok-btn minus" onclick="changeStok('izolasyon', -1)">-</button>
                        <button class="stok-btn" onclick="changeStok('izolasyon', 1)">+</button>
                    </div>
                    <p>Mevcut Adet</p>
                </div>
                <div class="stok-item">
                    <h4>📦 Koli</h4>
                    <input type="text" class="urun-input" id="koliUrun" placeholder="Ürün İsmi">
                    <input type="number" class="stok-input" id="stokKoli" placeholder="0" min="0" readonly>
                    <div class="stok-controls">
                        <button class="stok-btn minus" onclick="changeStok('koli', -1)">-</button>
                        <button class="stok-btn" onclick="changeStok('koli', 1)">+</button>
                    </div>
                    <p>Mevcut Adet</p>
                </div>
                <div class="stok-item">
                    <h4>📦 Kutu</h4>
                    <input type="text" class="urun-input" id="kutuUrun" placeholder="Ürün İsmi">
                    <input type="number" class="stok-input" id="stokKutu" placeholder="0" min="0" readonly>
                    <div class="stok-controls">
                        <button class="stok-btn minus" onclick="changeStok('kutu', -1)">-</button>
                        <button class="stok-btn" onclick="changeStok('kutu', 1)">+</button>
                    </div>
                    <p>Mevcut Adet</p>
                </div>
                <div class="stok-item">
                    <h4>🛍️ Poşet</h4>
                    <input type="text" class="urun-input" id="posetUrun" placeholder="Ürün İsmi">
                    <input type="text" class="urun-input" id="posetOlculeriStok" placeholder="Poşet Ölçüleri">
                    <input type="number" class="stok-input" id="stokPoset" placeholder="0" min="0" readonly>
                    <div class="stok-controls">
                        <button class="stok-btn minus" onclick="changeStok('poset', -1)">-</button>
                        <button class="stok-btn" onclick="changeStok('poset', 1)">+</button>
                    </div>
                    <p>Mevcut Adet</p>
                </div>
                <div class="stok-item">
                    <h4>🔴 Tapa</h4>
                    <input type="text" class="urun-input" id="tapaUrun" placeholder="Ürün İsmi">
                    <input type="text" class="urun-input" id="tapaOlculeriStok" placeholder="Tapa Ölçüleri">
                    <input type="number" class="stok-input" id="stokTapa" placeholder="0" min="0" readonly>
                    <div class="stok-controls">
                        <button class="stok-btn minus" onclick="changeStok('tapa', -1)">-</button>
                        <button class="stok-btn" onclick="changeStok('tapa', 1)">+</button>
                    </div>
                    <p>Mevcut Adet</p>
                </div>
                <div class="stok-item">
                    <h4>🏷️ Etiket</h4>
                    <input type="text" class="urun-input" id="etiketUrun" placeholder="Ürün İsmi">
                    <input type="number" class="stok-input" id="stokEtiket" placeholder="0" min="0" readonly>
                    <div class="stok-controls">
                        <button class="stok-btn minus" onclick="changeStok('etiket', -1)">-</button>
                        <button class="stok-btn" onclick="changeStok('etiket', 1)">+</button>
                    </div>
                    <p>Mevcut Adet</p>
                </div>
            </div>
            <div style="margin-top: 30px; text-align: center;">
                <button class="btn" onclick="saveStok()">💾 Stok Bilgilerini Kaydet</button>
                <button class="btn btn-success" onclick="loadStok()" style="margin-left: 10px;">🔄 Stok Bilgilerini Yükle</button>
                <button class="btn btn-danger" onclick="resetAllStok()" style="margin-left: 10px;">🗑️ Tüm Stokları Sıfırla</button>
            </div>
            <div id="stokAlert"></div>
        </div>

        <!-- Günlük Performans Tab -->
        <div id="gunluk-performans" class="tab-content">
            <h2>⏱️ Günlük Çalışan Performansı</h2>
            <form id="performansForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="performansTarih">📅 Tarih</label>
                        <input type="date" id="performansTarih" required>
                    </div>
                    <div class="form-group">
                        <label for="performansCalisan">👤 Çalışan Adı</label>
                        <input type="text" id="performansCalisan" placeholder="Çalışan adını yazın" required>
                    </div>
                </div>

                <div class="performance-grid">
                    <div class="performance-card">
                        <h4>📦 Kutu Hazırlığı</h4>
                        <div class="form-group">
                            <label>Ürün İsmi:</label>
                            <input type="text" id="kutuHazirlikUrun" placeholder="Ürün İsmi">
                        </div>
                        <div class="form-group">
                            <label>Adet:</label>
                            <input type="number" id="kutuHazirlikAdet" min="0" placeholder="0">
                        </div>
                        <div class="form-group">
                            <label>Süre (dakika):</label>
                            <input type="number" id="kutuHazirlikSure" min="0" placeholder="0">
                        </div>
                    </div>

                    <div class="performance-card">
                        <h4>📦 Koli Hazırlama</h4>
                        <div class="form-group">
                            <label>Ürün İsmi:</label>
                            <input type="text" id="koliHazirlamaUrun" placeholder="Ürün İsmi">
                        </div>
                        <div class="form-group">
                            <label>Adet:</label>
                            <input type="number" id="koliHazirlamaAdet" min="0" placeholder="0">
                        </div>
                        <div class="form-group">
                            <label>Süre (dakika):</label>
                            <input type="number" id="koliHazirlamaSure" min="0" placeholder="0">
                        </div>
                    </div>

                    <div class="performance-card">
                        <h4>🔧 İzolasyon Bantlama</h4>
                        <div class="form-group">
                            <label>Ürün İsmi:</label>
                            <input type="text" id="izolasyonUrunPerf" placeholder="Ürün İsmi">
                        </div>
                        <div class="form-group">
                            <label>Adet:</label>
                            <input type="number" id="izolasyonAdetPerf" min="0" placeholder="0">
                        </div>
                        <div class="form-group">
                            <label>Süre (dakika):</label>
                            <input type="number" id="izolasyonSure" min="0" placeholder="0">
                        </div>
                    </div>

                    <div class="performance-card">
                        <h4>🔍 Kalite Kontrol</h4>
                        <div class="form-group">
                            <label>Ürün İsmi:</label>
                            <input type="text" id="kaliteKontrolUrun" placeholder="Ürün İsmi">
                        </div>
                        <div class="form-group">
                            <label>Adet:</label>
                            <input type="number" id="kaliteKontrolAdet" min="0" placeholder="0">
                        </div>
                        <div class="form-group">
                            <label>Süre (dakika):</label>
                            <input type="number" id="kaliteKontrolSure" min="0" placeholder="0">
                        </div>
                    </div>

                    <div class="performance-card">
                        <h4>🛍️ Poşetleme</h4>
                        <div class="form-group">
                            <label>Ürün İsmi:</label>
                            <input type="text" id="posetlemeUrunPerf" placeholder="Ürün İsmi">
                        </div>
                        <div class="form-group">
                            <label>Adet:</label>
                            <input type="number" id="posetlemeAdetPerf" min="0" placeholder="0">
                        </div>
                        <div class="form-group">
                            <label>Süre (dakika):</label>
                            <input type="number" id="posetlemeSure" min="0" placeholder="0">
                        </div>
                    </div>

                    <div class="performance-card">
                        <h4>📦 Ürün Kutulama</h4>
                        <div class="form-group">
                            <label>Ürün İsmi:</label>
                            <input type="text" id="urunKutulamaUrun" placeholder="Ürün İsmi">
                        </div>
                        <div class="form-group">
                            <label>Adet:</label>
                            <input type="number" id="urunKutulamaAdet" min="0" placeholder="0">
                        </div>
                        <div class="form-group">
                            <label>Süre (dakika):</label>
                            <input type="number" id="urunKutulamaSure" min="0" placeholder="0">
                        </div>
                    </div>

                    <div class="performance-card">
                        <h4>⚙️ Ek Parça Hazırlama</h4>
                        <div class="form-group">
                            <label>Ürün İsmi:</label>
                            <input type="text" id="ekParcaUrunPerf" placeholder="Ürün İsmi">
                        </div>
                        <div class="form-group">
                            <label>Adet:</label>
                            <input type="number" id="ekParcaAdetPerf" min="0" placeholder="0">
                        </div>
                        <div class="form-group">
                            <label>Süre (dakika):</label>
                            <input type="number" id="ekParcaSure" min="0" placeholder="0">
                        </div>
                    </div>
                </div>

                <button type="submit" class="btn">💾 Performans Kaydını Kaydet</button>
            </form>
            <div id="performansAlert"></div>

            <div id="performansKayitlar">
                <h3>📋 Son Performans Kayıtları</h3>
                <div id="performansKayitlariListesi"></div>
            </div>
        </div>

        <!-- İstatistikler Tab -->
        <div id="istatistikler" class="tab-content">
            <h2>📈 İstatistikler</h2>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <h3 id="toplamKaliteKayit">0</h3>
                    <p>Toplam Kalite Kontrol</p>
                </div>
                <div class="stat-card">
                    <h3 id="toplamSiparisKayit">0</h3>
                    <p>Toplam Sipariş</p>
                </div>
                <div class="stat-card">
                    <h3 id="toplamPerformansKayit">0</h3>
                    <p>Toplam Performans</p>
                </div>
                <div class="stat-card">
                    <h3 id="tamamlananSiparis">0</h3>
                    <p>Tamamlanan Sipariş</p>
                </div>
                <div class="stat-card">
                    <h3 id="toplamHataAdet">0</h3>
                    <p>Toplam Hatalı Ürün</p>
                </div>
                <div class="stat-card">
                    <h3 id="basariOrani">0%</h3>
                    <p>Başarı Oranı</p>
                </div>
            </div>

            <div class="istatistik-card">
                <h4>📊 Hata İstatistikleri</h4>
                <div id="hataIstatistikleri"></div>
            </div>

            <div class="istatistik-card">
                <h4>⏱️ Performans İstatistikleri</h4>
                <div id="performansIstatistikleri"></div>
            </div>

            <div class="istatistik-card">
                <h4>👥 Çalışan Bazlı İstatistikler</h4>
                <div id="calisanIstatistikleri"></div>
            </div>

            <div class="istatistik-card">
                <h4>📦 Ürün Bazlı İstatistikler</h4>
                <div id="urunIstatistikleri"></div>
            </div>

            <div class="istatistik-card">
                <h4>📈 Günlük Üretim Trendi</h4>
                <div id="gunlukTrend"></div>
            </div>
        </div>

        <!-- Veri Görüntüle Tab -->
        <div id="veri-goruntule" class="tab-content">
            <h2>📊 Veri Görüntüle</h2>
            
            <div class="form-grid" style="margin-bottom: 20px;">
                <div class="form-group">
                    <label for="veriTuru">🔍 Veri Türü</label>
                    <select id="veriTuru" onchange="loadVeriTablosu()">
                        <option value="kalite">Kalite Kontrol Verileri</option>
                        <option value="siparis">Sipariş Hazırlık Verileri</option>
                        <option value="performans">Performans Verileri</option>
                        <option value="stok">Stok Verileri</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="tarihFiltre">📅 Tarih Filtresi</label>
                    <select id="tarihFiltre" onchange="loadVeriTablosu()">
                        <option value="hepsi">Tüm Tarihler</option>
                        <option value="bugun">Bugün</option>
                        <option value="bu-hafta">Bu Hafta</option>
                        <option value="bu-ay">Bu Ay</option>
                    </select>
                </div>
            </div>
            
            <div id="veriTablosuContainer"></div>
            
            <div style="margin-top: 20px; text-align: center;">
                <button class="btn" onclick="exportCurrentData()">📥 Görüntülenen Verileri Excel'e Aktar</button>
            </div>
        </div>

        <!-- Raporlar Tab -->
        <div id="raporlar" class="tab-content">
            <h2>📋 Raporlar</h2>
            <div class="stats-grid" id="statsContainer">
                <div class="stat-card">
                    <h3 id="toplamKayit">0</h3>
                    <p>Toplam Kalite Kontrol Kaydı</p>
                </div>
                <div class="stat-card">
                    <h3 id="toplamSiparis">0</h3>
                    <p>Sipariş Hazırlık Kaydı</p>
                </div>
                <div class="stat-card">
                    <h3 id="toplamPerformans">0</h3>
                    <p>Performans Kaydı</p>
                </div>
                <div class="stat-card">
                    <h3 id="stokSayisi">0</h3>
                    <p>Stok Kalemi</p>
                </div>
            </div>
            
            <div style="margin-top: 30px;">
                <button class="btn" onclick="exportToExcel('kalite')">📥 Kalite Verilerini Excel'e Aktar</button>
                <button class="btn btn-success" onclick="exportToExcel('performans')">📥 Performans Verilerini Excel'e Aktar</button>
                <button class="btn" onclick="exportToExcel('siparis')">📥 Sipariş Verilerini Excel'e Aktar</button>
                <button class="btn btn-danger" onclick="exportToExcel('hepsi')">📥 Tüm Verileri Excel'e Aktar</button>
            </div>
        </div>

        <!-- Ayarlar Tab -->
        <div id="ayarlar" class="tab-content">
            <h2>⚙️ Sistem Ayarları</h2>
            <div class="form-grid">
                <div class="form-group">
                    <label>💾 Veri Yedekleme</label>
                    <button class="btn" onclick="exportAllData()">Tüm Verileri Yedekle (JSON)</button>
                </div>
                <div class="form-group">
                    <label>📤 Veri Geri Yükleme</label>
                    <input type="file" id="importFile" accept=".json" onchange="importData()">
                </div>
                <div class="form-group">
                    <label>🗑️ Veri Temizleme</label>
                    <button class="btn btn-danger" onclick="clearAllData()">Tüm Verileri Temizle</button>
                </div>
            </div>
        </div>
    </div>
    <script>
        // Global değişkenler
        let kaliteKayitlari = JSON.parse(localStorage.getItem('kaliteKayitlari') || '[]');
        let siparisHazirlikKayitlari = JSON.parse(localStorage.getItem('siparisHazirlikKayitlari') || '[]');
        let performansKayitlari = JSON.parse(localStorage.getItem('performansKayitlari') || '[]');
        let stokBilgileri = JSON.parse(localStorage.getItem('stokBilgileri') || '{}');

        // Sayfa yüklendiğinde
        document.addEventListener('DOMContentLoaded', function() {
            const now = new Date();
            const nowString = now.toISOString().slice(0, 16);
            const today = now.toISOString().slice(0, 10);
            
            document.getElementById('tarih').value = nowString;
            document.getElementById('hazirlikTarih').value = today;
            document.getElementById('performansTarih').value = today;
            
            loadStats();
            loadStok();
            loadKaliteKayitlari();
            loadSiparislerListesi();
            loadIstatistikler();
            loadVeriTablosu();

            // Diğer hata checkbox'ı için listener
            document.getElementById('hataDiger').addEventListener('change', function() {
                const digerDetay = document.getElementById('digerHataDetay');
                digerDetay.style.display = this.checked ? 'block' : 'none';
            });

            // Modal kapatma
            document.querySelector('.close').onclick = function() {
                document.getElementById('editModal').style.display = 'none';
            };

            window.onclick = function(event) {
                const modal = document.getElementById('editModal');
                if (event.target == modal) {
                    modal.style.display = 'none';
                }
            };
        });

        // Tab gösterme fonksiyonu
        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');

            if (tabName === 'raporlar') {
                loadStats();
            } else if (tabName === 'kalite-kontrol') {
                loadKaliteKayitlari();
            } else if (tabName === 'siparis-hazirlik') {
                loadSiparislerListesi();
            } else if (tabName === 'gunluk-performans') {
                loadPerformansKayitlari();
            } else if (tabName === 'istatistikler') {
                loadIstatistikler();
            } else if (tabName === 'veri-goruntule') {
                loadVeriTablosu();
            } else if (tabName === 'stok') {
                loadStok();
            }
        }

        // Kalite kontrol form gönderimi
        document.getElementById('kaliteForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = {
                id: Date.now(),
                tip: 'kalite',
                tarih: document.getElementById('tarih').value,
                operator: document.getElementById('operator').value,
                urunKodu: document.getElementById('urunKodu').value,
                toplamAdet: parseInt(document.getElementById('toplamAdet').value),
                siparisNo: document.getElementById('siparisNo').value,
                hatalar: []
            };

            // Tüm hataları topla
            document.querySelectorAll('input[name="hatalar"]:checked').forEach(checkbox => {
                const hataItem = checkbox.parentElement;
                const adetInputs = hataItem.querySelectorAll('.hata-adet');
                const iskartaAdet = parseInt(adetInputs[0].value) || 0;
                const geriGidenAdet = parseInt(adetInputs[1].value) || 0;
                
                if (iskartaAdet > 0 || geriGidenAdet > 0) {
                    let hataTur = checkbox.value;
                    if (hataTur === 'Diğer') {
                        const aciklama = document.getElementById('digerHataAciklama').value;
                        hataTur = 'Diğer: ' + aciklama;
                    }
                    
                    formData.hatalar.push({
                        tur: hataTur,
                        iskartaAdet: iskartaAdet,
                        geriGidenAdet: geriGidenAdet
                    });
                }
            });

            kaliteKayitlari.push(formData);
            localStorage.setItem('kaliteKayitlari', JSON.stringify(kaliteKayitlari));

            document.getElementById('kaliteForm').reset();
            document.getElementById('tarih').value = new Date().toISOString().slice(0, 16);
            document.getElementById('digerHataDetay').style.display = 'none';

            showAlert('kaliteAlert', 'Kalite kontrol kaydı başarıyla kaydedildi!', 'success');
            loadStats();
            loadKaliteKayitlari();
        });

        // Sipariş ekleme form gönderimi
        document.getElementById('siparisEkleForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = {
                id: Date.now(),
                tip: 'siparis-hazirlik',
                tarih: document.getElementById('hazirlikTarih').value,
                operator: document.getElementById('hazirlikOperator').value,
                siparisNo: document.getElementById('hazirlikSiparisNo').value,
                urunKodu: document.getElementById('urunKoduSiparis').value,
                siparisAdet: parseInt(document.getElementById('siparisAdet').value),
                malzemeler: {
                    kutu: { yapildi: 0, hazir: false, mevcut: false },
                    koli: { yapildi: 0, hazir: false, mevcut: false },
                    etiket: { yapildi: 0, hazir: false, mevcut: false },
                    poset: { yapildi: 0, hazir: false, mevcut: false },
                    tapa: { yapildi: 0, hazir: false, mevcut: false },
                    izolasyon: { yapildi: 0, hazir: false, mevcut: false }
                }
            };

            siparisHazirlikKayitlari.push(formData);
            localStorage.setItem('siparisHazirlikKayitlari', JSON.stringify(siparisHazirlikKayitlari));

            document.getElementById('siparisEkleForm').reset();
            document.getElementById('hazirlikTarih').value = new Date().toISOString().slice(0, 10);

            showAlert('siparisEkleAlert', 'Sipariş başarıyla eklendi!', 'success');
            loadStats();
            loadSiparislerListesi();
        });

        // Performans form gönderimi
        document.getElementById('performansForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = {
                id: Date.now(),
                tip: 'performans',
                tarih: document.getElementById('performansTarih').value,
                calisan: document.getElementById('performansCalisan').value,
                kutuHazirlik: {
                    urun: document.getElementById('kutuHazirlikUrun').value,
                    adet: parseInt(document.getElementById('kutuHazirlikAdet').value) || 0,
                    sure: parseInt(document.getElementById('kutuHazirlikSure').value) || 0
                },
                koliHazirlama: {
                    urun: document.getElementById('koliHazirlamaUrun').value,
                    adet: parseInt(document.getElementById('koliHazirlamaAdet').value) || 0,
                    sure: parseInt(document.getElementById('koliHazirlamaSure').value) || 0
                },
                izolasyon: {
                    urun: document.getElementById('izolasyonUrunPerf').value,
                    adet: parseInt(document.getElementById('izolasyonAdetPerf').value) || 0,
                    sure: parseInt(document.getElementById('izolasyonSure').value) || 0
                },
                kaliteKontrol: {
                    urun: document.getElementById('kaliteKontrolUrun').value,
                    adet: parseInt(document.getElementById('kaliteKontrolAdet').value) || 0,
                    sure: parseInt(document.getElementById('kaliteKontrolSure').value) || 0
                },
                posetleme: {
                    urun: document.getElementById('posetlemeUrunPerf').value,
                    adet: parseInt(document.getElementById('posetlemeAdetPerf').value) || 0,
                    sure: parseInt(document.getElementById('posetlemeSure').value) || 0
                },
                urunKutulama: {
                    urun: document.getElementById('urunKutulamaUrun').value,
                    adet: parseInt(document.getElementById('urunKutulamaAdet').value) || 0,
                    sure: parseInt(document.getElementById('urunKutulamaSure').value) || 0
                },
                ekParca: {
                    urun: document.getElementById('ekParcaUrunPerf').value,
                    adet: parseInt(document.getElementById('ekParcaAdetPerf').value) || 0,
                    sure: parseInt(document.getElementById('ekParcaSure').value) || 0
                }
            };

            performansKayitlari.push(formData);
            localStorage.setItem('performansKayitlari', JSON.stringify(performansKayitlari));

            document.getElementById('performansForm').reset();
            document.getElementById('performansTarih').value = new Date().toISOString().slice(0, 10);

            showAlert('performansAlert', 'Performans kaydı başarıyla kaydedildi!', 'success');
            loadStats();
            loadPerformansKayitlari();
        });

        // Stok değiştirme fonksiyonu
        function changeStok(malzeme, miktar) {
            const inputId = 'stok' + malzeme.charAt(0).toUpperCase() + malzeme.slice(1);
            const input = document.getElementById(inputId);
            const currentValue = parseInt(input.value) || 0;
            const newValue = Math.max(0, currentValue + miktar);
            input.value = newValue;
            
            // Otomatik kaydet
            saveStok();
        }

        // Stok kaydetme
        function saveStok() {
            stokBilgileri = {
                izolasyon: {
                    urun: document.getElementById('izolasyonUrun').value,
                    adet: parseInt(document.getElementById('stokIzolasyon').value) || 0
                },
                koli: {
                    urun: document.getElementById('koliUrun').value,
                    adet: parseInt(document.getElementById('stokKoli').value) || 0
                },
                kutu: {
                    urun: document.getElementById('kutuUrun').value,
                    adet: parseInt(document.getElementById('stokKutu').value) || 0
                },
                poset: {
                    urun: document.getElementById('posetUrun').value,
                    adet: parseInt(document.getElementById('stokPoset').value) || 0,
                    olculeri: document.getElementById('posetOlculeriStok').value
                },
                tapa: {
                    urun: document.getElementById('tapaUrun').value,
                    adet: parseInt(document.getElementById('stokTapa').value) || 0,
                    olculeri: document.getElementById('tapaOlculeriStok').value
                },
                etiket: {
                    urun: document.getElementById('etiketUrun').value,
                    adet: parseInt(document.getElementById('stokEtiket').value) || 0
                },
                sonGuncelleme: new Date().toISOString()
            };
            localStorage.setItem('stokBilgileri', JSON.stringify(stokBilgileri));
            showAlert('stokAlert', 'Stok bilgileri kaydedildi!', 'success');
        }

        // Stok yükleme
        function loadStok() {
            if (stokBilgileri.izolasyon) {
                document.getElementById('izolasyonUrun').value = stokBilgileri.izolasyon.urun || '';
                document.getElementById('stokIzolasyon').value = stokBilgileri.izolasyon.adet || 0;
            }
            if (stokBilgileri.koli) {
                document.getElementById('koliUrun').value = stokBilgileri.koli.urun || '';
                document.getElementById('stokKoli').value = stokBilgileri.koli.adet || 0;
            }
            if (stokBilgileri.kutu) {
                document.getElementById('kutuUrun').value = stokBilgileri.kutu.urun || '';
                document.getElementById('stokKutu').value = stokBilgileri.kutu.adet || 0;
            }
            if (stokBilgileri.poset) {
                document.getElementById('posetUrun').value = stokBilgileri.poset.urun || '';
                document.getElementById('stokPoset').value = stokBilgileri.poset.adet || 0;
                document.getElementById('posetOlculeriStok').value = stokBilgileri.poset.olculeri || '';
            }
            if (stokBilgileri.tapa) {
                document.getElementById('tapaUrun').value = stokBilgileri.tapa.urun || '';
                document.getElementById('stokTapa').value = stokBilgileri.tapa.adet || 0;
                document.getElementById('tapaOlculeriStok').value = stokBilgileri.tapa.olculeri || '';
            }
            if (stokBilgileri.etiket) {
                document.getElementById('etiketUrun').value = stokBilgileri.etiket.urun || '';
                document.getElementById('stokEtiket').value = stokBilgileri.etiket.adet || 0;
            }
        }

        // Tüm stokları sıfırlama
        function resetAllStok() {
            if (confirm('Tüm stok değerlerini sıfırlamak istediğinizden emin misiniz?')) {
                document.querySelectorAll('.stok-input').forEach(input => {
                    input.value = 0;
                });
                saveStok();
                showAlert('stokAlert', 'Tüm stok değerleri sıfırlandı!', 'success');
            }
        }

        // Siparişler listesini yükle
        function loadSiparislerListesi() {
            const container = document.getElementById('siparislerListesi');
            if (siparisHazirlikKayitlari.length === 0) {
                container.innerHTML = '<p>Henüz sipariş kaydı bulunmuyor.</p>';
                return;
            }

            container.innerHTML = siparisHazirlikKayitlari.map(siparis => `
                <div class="siparis-item">
                    <div class="siparis-header">
                        <div>
                            <h4>📋 Sipariş: ${siparis.siparisNo}</h4>
                            <p>📦 ${siparis.urunKodu} - ${siparis.siparisAdet} adet</p>
                        </div>
                        <div style="text-align: right;">
                            <span>📅 ${new Date(siparis.tarih).toLocaleDateString('tr-TR')}</span><br>
                            <span>👤 ${siparis.operator}</span>
                        </div>
                    </div>
                    <div class="siparis-grid">
                        ${Object.keys(siparis.malzemeler).map(malzeme => `
                            <div class="siparis-malzeme">
                                <h5>${getMalzemeIcon(malzeme)} ${getMalzemeAd(malzeme)}</h5>
                                <div class="malzeme-info">
                                    <div class="malzeme-adet">
                                        <input type="number" value="${siparis.malzemeler[malzeme].yapildi}" 
                                               onchange="updateMalzemeAdet(${siparis.id}, '${malzeme}', this.value)"
                                               style="width: 60px; padding: 5px; text-align: center; border: 1px solid #ddd; border-radius: 3px;">
                                        <br><small>Yapılan</small>
                                    </div>
                                    <div class="checkbox-container">
                                        <div class="checkbox-item hazir">
                                            <input type="checkbox" id="hazir_${siparis.id}_${malzeme}" 
                                                   ${siparis.malzemeler[malzeme].hazir ? 'checked' : ''}
                                                   onchange="updateSiparis(${siparis.id}, '${malzeme}', 'hazir', this.checked)">
                                            <label for="hazir_${siparis.id}_${malzeme}">✅ Hazır</label>
                                        </div>
                                        <div class="checkbox-item mevcut">
                                            <input type="checkbox" id="mevcut_${siparis.id}_${malzeme}" 
                                                   ${siparis.malzemeler[malzeme].mevcut ? 'checked' : ''}
                                                   onchange="updateSiparis(${siparis.id}, '${malzeme}', 'mevcut', this.checked)">
                                            <label for="mevcut_${siparis.id}_${malzeme}">📦 Mevcut</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    <div style="margin-top: 15px; text-align: center;">
                        <button class="btn-edit" onclick="editSiparis(${siparis.id})">✏️ Düzenle</button>
                        <button class="btn-delete" onclick="deleteSiparis(${siparis.id})">🗑️ Sil</button>
                        <span style="margin-left: 20px; padding: 8px 15px; border-radius: 15px; font-weight: bold; ${getSiparisStatus(siparis)}">
                            ${getSiparisStatusText(siparis)}
                        </span>
                    </div>
                </div>
            `).join('');
        }

        function getMalzemeIcon(malzeme) {
            const icons = {
                kutu: '📦',
                koli: '📦',
                etiket: '🏷️',
                poset: '🛍️',
                tapa: '🔴',
                izolasyon: '🔧'
            };
            return icons[malzeme] || '📦';
        }

        function getMalzemeAd(malzeme) {
            const adlar = {
                kutu: 'Kutu',
                koli: 'Koli',
                etiket: 'Etiket',
                poset: 'Poşet',
                tapa: 'Tapa',
                izolasyon: 'İzolasyon'
            };
            return adlar[malzeme] || malzeme;
        }

        function getSiparisStatus(siparis) {
            const tamamlanan = Object.values(siparis.malzemeler).filter(m => m.hazir).length;
            const toplam = Object.keys(siparis.malzemeler).length;
            
            if (tamamlanan === toplam) {
                return 'background: #d4edda; color: #155724; border: 1px solid #c3e6cb;';
            } else if (tamamlanan > 0) {
                return 'background: #fff3cd; color: #856404; border: 1px solid #ffeaa7;';
            } else {
                return 'background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb;';
            }
        }

        function getSiparisStatusText(siparis) {
            const tamamlanan = Object.values(siparis.malzemeler).filter(m => m.hazir).length;
            const toplam = Object.keys(siparis.malzemeler).length;
            
            if (tamamlanan === toplam) {
                return '✅ Tamamlandı';
            } else if (tamamlanan > 0) {
                return `🔄 Devam Ediyor (${tamamlanan}/${toplam})`;
            } else {
                return '⏳ Beklemede';
            }
        }

        // Malzeme adet güncelleme
        function updateMalzemeAdet(id, malzeme, adet) {
            const siparisIndex = siparisHazirlikKayitlari.findIndex(s => s.id === id);
            if (siparisIndex !== -1) {
                siparisHazirlikKayitlari[siparisIndex].malzemeler[malzeme].yapildi = parseInt(adet) || 0;
                localStorage.setItem('siparisHazirlikKayitlari', JSON.stringify(siparisHazirlikKayitlari));
            }
        }

        // Sipariş güncelleme
        function updateSiparis(id, malzeme, durum, deger) {
            const siparisIndex = siparisHazirlikKayitlari.findIndex(s => s.id === id);
            if (siparisIndex !== -1) {
                siparisHazirlikKayitlari[siparisIndex].malzemeler[malzeme][durum] = deger;
                localStorage.setItem('siparisHazirlikKayitlari', JSON.stringify(siparisHazirlikKayitlari));
                // Sayfa yenilemeden güncelle
                setTimeout(() => loadSiparislerListesi(), 100);
            }
        }

        // Sipariş düzenleme
        function editSiparis(id) {
            const siparis = siparisHazirlikKayitlari.find(s => s.id === id);
            if (!siparis) return;

            const modal = document.getElementById('editModal');
            const container = document.getElementById('editFormContainer');
            
            container.innerHTML = `
                <form id="editSiparisForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>📅 Tarih</label>
                            <input type="date" id="editTarih" value="${siparis.tarih}" required>
                        </div>
                        <div class="form-group">
                            <label>👤 Hazırlayan</label>
                            <input type="text" id="editOperator" value="${siparis.operator}" required>
                        </div>
                        <div class="form-group">
                            <label>🏷️ Sipariş No</label>
                            <input type="text" id="editSiparisNo" value="${siparis.siparisNo}" required>
                        </div>
                        <div class="form-group">
                            <label>📦 Ürün Kodu</label>
                            <input type="text" id="editUrunKodu" value="${siparis.urunKodu}" required>
                        </div>
                        <div class="form-group">
                            <label>📊 Sipariş Adedi</label>
                            <input type="number" id="editSiparisAdet" value="${siparis.siparisAdet}" min="1" required>
                        </div>
                    </div>
                    <div style="margin-top: 20px;">
                        <button type="submit" class="btn btn-success">💾 Güncelle</button>
                        <button type="button" class="btn" onclick="document.getElementById('editModal').style.display='none'">❌ İptal</button>
                    </div>
                </form>
            `;

            document.getElementById('editSiparisForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const siparisIndex = siparisHazirlikKayitlari.findIndex(s => s.id === id);
                if (siparisIndex !== -1) {
                    siparisHazirlikKayitlari[siparisIndex].tarih = document.getElementById('editTarih').value;
                    siparisHazirlikKayitlari[siparisIndex].operator = document.getElementById('editOperator').value;
                    siparisHazirlikKayitlari[siparisIndex].siparisNo = document.getElementById('editSiparisNo').value;
                    siparisHazirlikKayitlari[siparisIndex].urunKodu = document.getElementById('editUrunKodu').value;
                    siparisHazirlikKayitlari[siparisIndex].siparisAdet = parseInt(document.getElementById('editSiparisAdet').value);
                    
                    localStorage.setItem('siparisHazirlikKayitlari', JSON.stringify(siparisHazirlikKayitlari));
                    modal.style.display = 'none';
                    loadSiparislerListesi();
                    showAlert('siparisEkleAlert', 'Sipariş başarıyla güncellendi!', 'success');
                }
            });

            modal.style.display = 'block';
        }

        // Sipariş silme
        function deleteSiparis(id) {
            if (confirm('Bu siparişi silmek istediğinizden emin misiniz?')) {
                siparisHazirlikKayitlari = siparisHazirlikKayitlari.filter(s => s.id !== id);
                localStorage.setItem('siparisHazirlikKayitlari', JSON.stringify(siparisHazirlikKayitlari));
                loadSiparislerListesi();
                loadStats();
                showAlert('siparisEkleAlert', 'Sipariş başarıyla silindi!', 'success');
            }
        }

        // İstatistikleri yükle
        function loadIstatistikler() {
            // Temel sayılar
            document.getElementById('toplamKaliteKayit').textContent = kaliteKayitlari.length;
            document.getElementById('toplamSiparisKayit').textContent = siparisHazirlikKayitlari.length;
            document.getElementById('toplamPerformansKayit').textContent = performansKayitlari.length;
            
            // Tamamlanan siparişler
            const tamamlananSiparisler = siparisHazirlikKayitlari.filter(siparis => {
                return Object.values(siparis.malzemeler).every(malzeme => malzeme.hazir);
            }).length;
            document.getElementById('tamamlananSiparis').textContent = tamamlananSiparisler;

            // Toplam hatalı ürün
            let toplamHata = 0;
            kaliteKayitlari.forEach(kayit => {
                kayit.hatalar.forEach(hata => {
                    toplamHata += hata.iskartaAdet + hata.geriGidenAdet;
                });
            });
            document.getElementById('toplamHataAdet').textContent = toplamHata;

            // Başarı oranı
            const toplamUretim = kaliteKayitlari.reduce((total, kayit) => total + kayit.toplamAdet, 0);
            const basariOrani = toplamUretim > 0 ? Math.round(((toplamUretim - toplamHata) / toplamUretim) * 100) : 0;
            document.getElementById('basariOrani').textContent = basariOrani + '%';

            // Hata istatistikleri
            const hataStats = {};
            kaliteKayitlari.forEach(kayit => {
                kayit.hatalar.forEach(hata => {
                    if (!hataStats[hata.tur]) {
                        hataStats[hata.tur] = { iskarta: 0, geriGiden: 0 };
                    }
                    hataStats[hata.tur].iskarta += hata.iskartaAdet;
                    hataStats[hata.tur].geriGiden += hata.geriGidenAdet;
                });
            });

            const hataContainer = document.getElementById('hataIstatistikleri');
            hataContainer.innerHTML = Object.keys(hataStats).map(hataTur => `
                <div class="istatistik-item">
                    <strong>${hataTur}</strong>
                    <span class="istatistik-value">İskarta: ${hataStats[hataTur].iskarta}, Geri Giden: ${hataStats[hataTur].geriGiden}</span>
                </div>
            `).join('') || '<p style="text-align: center; color: #666;">Henüz hata kaydı bulunmuyor.</p>';

            // Performans istatistikleri
            const performansStats = {
                kutuHazirlik: { toplam: 0, sure: 0 },
                koliHazirlama: { toplam: 0, sure: 0 },
                izolasyon: { toplam: 0, sure: 0 },
                kaliteKontrol: { toplam: 0, sure: 0 }
            };

            performansKayitlari.forEach(kayit => {
                performansStats.kutuHazirlik.toplam += kayit.kutuHazirlik.adet;
                performansStats.kutuHazirlik.sure += kayit.kutuHazirlik.sure;
                performansStats.koliHazirlama.toplam += kayit.koliHazirlama.adet;
                performansStats.koliHazirlama.sure += kayit.koliHazirlama.sure;
                performansStats.izolasyon.toplam += kayit.izolasyon.adet;
                performansStats.izolasyon.sure += kayit.izolasyon.sure;
                performansStats.kaliteKontrol.toplam += kayit.kaliteKontrol.adet;
                performansStats.kaliteKontrol.sure += kayit.kaliteKontrol.sure;
            });

            const performansContainer = document.getElementById('performansIstatistikleri');
            performansContainer.innerHTML = `
                <div class="istatistik-item">
                    <strong>Kutu Hazırlık</strong>
                    <span class="istatistik-value">${performansStats.kutuHazirlik.toplam} adet, ${performansStats.kutuHazirlik.sure} dk</span>
                </div>
                <div class="istatistik-item">
                    <strong>Koli Hazırlama</strong>
                    <span class="istatistik-value">${performansStats.koliHazirlama.toplam} adet, ${performansStats.koliHazirlama.sure} dk</span>
                </div>
                <div class="istatistik-item">
                    <strong>İzolasyon</strong>
                    <span class="istatistik-value">${performansStats.izolasyon.toplam} adet, ${performansStats.izolasyon.sure} dk</span>
                </div>
                <div class="istatistik-item">
                    <strong>Kalite Kontrol</strong>
                    <span class="istatistik-value">${performansStats.kaliteKontrol.toplam} adet, ${performansStats.kaliteKontrol.sure} dk</span>
                </div>
            `;

            // Çalışan istatistikleri
            const calisanStats = {};
            performansKayitlari.forEach(kayit => {
                if (!calisanStats[kayit.calisan]) {
                    calisanStats[kayit.calisan] = { kayitSayisi: 0, toplamSure: 0 };
                }
                calisanStats[kayit.calisan].kayitSayisi++;
                calisanStats[kayit.calisan].toplamSure += 
                    kayit.kutuHazirlik.sure + kayit.koliHazirlama.sure + kayit.izolasyon.sure + kayit.kaliteKontrol.sure;
            });

            const calisanContainer = document.getElementById('calisanIstatistikleri');
            calisanContainer.innerHTML = Object.keys(calisanStats).map(calisan => `
                <div class="istatistik-item">
                    <strong>${calisan}</strong>
                    <span class="istatistik-value">${calisanStats[calisan].kayitSayisi} gün, ${calisanStats[calisan].toplamSure} dk toplam</span>
                </div>
            `).join('') || '<p style="text-align: center; color: #666;">Henüz çalışan performans kaydı bulunmuyor.</p>';

            // Ürün istatistikleri
            const urunStats = {};
            kaliteKayitlari.forEach(kayit => {
                if (!urunStats[kayit.urunKodu]) {
                    urunStats[kayit.urunKodu] = 0;
                }
                urunStats[kayit.urunKodu] += kayit.toplamAdet;
            });

            const urunContainer = document.getElementById('urunIstatistikleri');
            urunContainer.innerHTML = Object.keys(urunStats).map(urun => `
                <div class="istatistik-item">
                    <strong>Ürün ${urun}</strong>
                    <span class="istatistik-value">${urunStats[urun]} adet üretildi</span>
                </div>
            `).join('') || '<p style="text-align: center; color: #666;">Henüz ürün üretim kaydı bulunmuyor.</p>';

            // Günlük trend
            const gunlukUretim = {};
            kaliteKayitlari.forEach(kayit => {
                const tarih = kayit.tarih.split('T')[0];
                if (!gunlukUretim[tarih]) {
                    gunlukUretim[tarih] = 0;
                }
                gunlukUretim[tarih] += kayit.toplamAdet;
            });

            const trendContainer = document.getElementById('gunlukTrend');
            const sortedDates = Object.keys(gunlukUretim).sort().slice(-7); // Son 7 gün
            trendContainer.innerHTML = sortedDates.map(tarih => `
                <div class="istatistik-item">
                    <strong>${new Date(tarih).toLocaleDateString('tr-TR')}</strong>
                    <span class="istatistik-value">${gunlukUretim[tarih]} adet</span>
                </div>
            `).join('') || '<p style="text-align: center; color: #666;">Henüz günlük üretim verisi bulunmuyor.</p>';
        }

        // Veri tablosu yükleme
        function loadVeriTablosu() {
            const veriTuru = document.getElementById('veriTuru').value;
            const tarihFiltre = document.getElementById('tarihFiltre').value;
            const container = document.getElementById('veriTablosuContainer');
            
            let data = [];
            let headers = [];
            
            // Tarih filtreleme
            const now = new Date();
            const bugun = now.toISOString().split('T')[0];
            const buHaftaBasi = new Date(now.setDate(now.getDate() - now.getDay())).toISOString().split('T')[0];
            const buAyBasi = new Date(now.getFullYear(), now.getMonth(), 1).toISOString().split('T')[0];
            
            function tarihFiltrele(kayit) {
                const kayitTarih = kayit.tarih.split('T')[0];
                switch(tarihFiltre) {
                    case 'bugun': return kayitTarih === bugun;
                    case 'bu-hafta': return kayitTarih >= buHaftaBasi;
                    case 'bu-ay': return kayitTarih >= buAyBasi;
                    default: return true;
                }
            }
            
            switch(veriTuru) {
                case 'kalite':
                    data = kaliteKayitlari.filter(tarihFiltrele);
                    headers = ['Tarih', 'Operatör', 'Ürün Kodu', 'Toplam Adet', 'Sipariş No', 'Hata Sayısı'];
                    break;
                case 'siparis':
                    data = siparisHazirlikKayitlari.filter(tarihFiltrele);
                    headers = ['Tarih', 'Hazırlayan', 'Sipariş No', 'Ürün Kodu', 'Adet', 'Durum'];
                    break;
                case 'performans':
                    data = performansKayitlari.filter(tarihFiltrele);
 headers = ['Tarih', 'Çalışan', 'Kutu Hazırlık', 'Koli Hazırlama', 'İzolasyon', 'Kalite Kontrol', 'Toplam Süre'];
                    break;
                case 'stok':
                    data = [stokBilgileri];
                    headers = ['Malzeme', 'Ürün', 'Adet', 'Ölçüler', 'Son Güncelleme'];
                    break;
            }
            
            if (data.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #666; padding: 20px;">Seçilen kriterlere göre veri bulunamadı.</p>';
                return;
            }
            
            let tableHTML = `
                <table class="veri-tablosu">
                    <thead>
                        <tr>${headers.map(h => `<th>${h}</th>`).join('')}</tr>
                    </thead>
                    <tbody>
            `;
            
            if (veriTuru === 'stok') {
                // Stok verileri için özel format
                Object.keys(stokBilgileri).forEach(malzeme => {
                    if (malzeme !== 'sonGuncelleme' && stokBilgileri[malzeme]) {
                        const stok = stokBilgileri[malzeme];
                        tableHTML += `
                            <tr>
                                <td>${getMalzemeAd(malzeme)}</td>
                                <td>${stok.urun || '-'}</td>
                                <td>${stok.adet || 0}</td>
                                <td>${stok.olculeri || '-'}</td>
                                <td>${stokBilgileri.sonGuncelleme ? new Date(stokBilgileri.sonGuncelleme).toLocaleString('tr-TR') : '-'}</td>
                            </tr>
                        `;
                    }
                });
            } else {
                data.forEach(row => {
                    tableHTML += '<tr>';
                    switch(veriTuru) {
                        case 'kalite':
                            const toplamHata = row.hatalar.reduce((total, hata) => total + hata.iskartaAdet + hata.geriGidenAdet, 0);
                            tableHTML += `
                                <td>${new Date(row.tarih).toLocaleString('tr-TR')}</td>
                                <td>${row.operator}</td>
                                <td>${row.urunKodu}</td>
                                <td>${row.toplamAdet}</td>
                                <td>${row.siparisNo}</td>
                                <td>${toplamHata}</td>
                            `;
                            break;
                        case 'siparis':
                            const tamamlanan = Object.values(row.malzemeler).filter(m => m.hazir).length;
                            const toplam = Object.keys(row.malzemeler).length;
                            const durum = tamamlanan === toplam ? 'Tamamlandı' : `${tamamlanan}/${toplam}`;
                            tableHTML += `
                                <td>${new Date(row.tarih).toLocaleDateString('tr-TR')}</td>
                                <td>${row.operator}</td>
                                <td>${row.siparisNo}</td>
                                <td>${row.urunKodu}</td>
                                <td>${row.siparisAdet}</td>
                                <td>${durum}</td>
                            `;
                            break;
                        case 'performans':
                            const toplamSure = row.kutuHazirlik.sure + row.koliHazirlama.sure + row.izolasyon.sure + row.kaliteKontrol.sure;
                            tableHTML += `
                                <td>${new Date(row.tarih).toLocaleDateString('tr-TR')}</td>
                                <td>${row.calisan}</td>
                                <td>${row.kutuHazirlik.adet} adet (${row.kutuHazirlik.sure} dk)</td>
                                <td>${row.koliHazirlama.adet} adet (${row.koliHazirlama.sure} dk)</td>
                                <td>${row.izolasyon.adet} adet (${row.izolasyon.sure} dk)</td>
                                <td>${row.kaliteKontrol.adet} adet (${row.kaliteKontrol.sure} dk)</td>
                                <td>${toplamSure} dakika</td>
                            `;
                            break;
                    }
                    tableHTML += '</tr>';
                });
            }
            
            tableHTML += `
                    </tbody>
                </table>
            `;
            
            container.innerHTML = tableHTML;
        }

        // Kalite kayıtlarını yükle
        function loadKaliteKayitlari() {
            const container = document.getElementById('kaliteKayitlariListesi');
            if (kaliteKayitlari.length === 0) {
                container.innerHTML = '<p>Henüz kalite kontrol kaydı bulunmuyor.</p>';
                return;
            }

            const sonKayitlar = kaliteKayitlari.slice(-10).reverse(); // Son 10 kayıt
            container.innerHTML = sonKayitlar.map(kayit => {
                const toplamHata = kayit.hatalar.reduce((total, hata) => total + hata.iskartaAdet + hata.geriGidenAdet, 0);
                return `
                    <div class="kayit-item">
                        <div class="kayit-header">
                            <span>📦 ${kayit.urunKodu} - ${kayit.toplamAdet} adet</span>
                            <span>📅 ${new Date(kayit.tarih).toLocaleString('tr-TR')}</span>
                        </div>
                        <div class="kayit-details">
                            <div><strong>Operatör:</strong> ${kayit.operator}</div>
                            <div><strong>Sipariş No:</strong> ${kayit.siparisNo}</div>
                            <div><strong>Toplam Hata:</strong> ${toplamHata} adet</div>
                            <div><strong>Başarı Oranı:</strong> ${Math.round((1 - toplamHata/kayit.toplamAdet) * 100)}%</div>
                        </div>
                        ${kayit.hatalar.length > 0 ? `
                            <div style="margin-top: 10px;">
                                <strong>Hatalar:</strong><br>
                                ${kayit.hatalar.map(hata => 
                                    `<small>• ${hata.tur}: İskarta ${hata.iskartaAdet}, Geri Giden ${hata.geriGidenAdet}</small>`
                                ).join('<br>')}
                            </div>
                        ` : ''}
                    </div>
                `;
            }).join('');
        }

        // Performans kayıtlarını yükle
        function loadPerformansKayitlari() {
            const container = document.getElementById('performansKayitlariListesi');
            if (performansKayitlari.length === 0) {
                container.innerHTML = '<p>Henüz performans kaydı bulunmuyor.</p>';
                return;
            }

            const sonKayitlar = performansKayitlari.slice(-10).reverse(); // Son 10 kayıt
            container.innerHTML = sonKayitlar.map(kayit => {
                const toplamSure = kayit.kutuHazirlik.sure + kayit.koliHazirlama.sure + kayit.izolasyon.sure + kayit.kaliteKontrol.sure;
                const toplamAdet = kayit.kutuHazirlik.adet + kayit.koliHazirlama.adet + kayit.izolasyon.adet + kayit.kaliteKontrol.adet;
                return `
                    <div class="kayit-item">
                        <div class="kayit-header">
                            <span>👤 ${kayit.calisan}</span>
                            <span>📅 ${new Date(kayit.tarih).toLocaleDateString('tr-TR')}</span>
                        </div>
                        <div class="kayit-details">
                            <div><strong>Toplam İşlem:</strong> ${toplamAdet} adet</div>
                            <div><strong>Toplam Süre:</strong> ${toplamSure} dakika</div>
                            <div><strong>Ortalama Hız:</strong> ${toplamSure > 0 ? Math.round(toplamAdet/toplamSure*60) : 0} adet/saat</div>
                            <div><strong>En Yoğun İşlem:</strong> ${getEnYogunIslem(kayit)}</div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function getEnYogunIslem(kayit) {
            const islemler = [
                { ad: 'Kutu Hazırlık', adet: kayit.kutuHazirlik.adet },
                { ad: 'Koli Hazırlama', adet: kayit.koliHazirlama.adet },
                { ad: 'İzolasyon', adet: kayit.izolasyon.adet },
                { ad: 'Kalite Kontrol', adet: kayit.kaliteKontrol.adet }
            ];
            const enYogun = islemler.reduce((max, islem) => islem.adet > max.adet ? islem : max);
            return enYogun.adet > 0 ? enYogun.ad : 'Yok';
        }

        // Mevcut verileri dışa aktar
        function exportCurrentData() {
            const veriTuru = document.getElementById('veriTuru').value;
            let data, filename;
            
            switch(veriTuru) {
                case 'kalite':
                    data = kaliteKayitlari;
                    filename = 'kalite_kontrol_verileri';
                    break;
                case 'siparis':
                    data = siparisHazirlikKayitlari;
                    filename = 'siparis_hazirlik_verileri';
                    break;
                case 'performans':
                    data = performansKayitlari;
                    filename = 'performans_verileri';
                    break;
                case 'stok':
                    data = [stokBilgileri];
                    filename = 'stok_verileri';
                    break;
            }
            
            exportToExcel(veriTuru, filename);
        }

        // İstatistikleri yükle
        function loadStats() {
            document.getElementById('toplamKayit').textContent = kaliteKayitlari.length;
            document.getElementById('toplamSiparis').textContent = siparisHazirlikKayitlari.length;
            document.getElementById('toplamPerformans').textContent = performansKayitlari.length;
            document.getElementById('stokSayisi').textContent = Object.keys(stokBilgileri).filter(k => k !== 'sonGuncelleme').length;
        }

        // Alert gösterme
        function showAlert(containerId, message, type) {
            const container = document.getElementById(containerId);
            const alertClass = type === 'success' ? 'alert-success' : 'alert-error';
            container.innerHTML = `<div class="alert ${alertClass}">${message}</div>`;
            
            setTimeout(() => {
                container.innerHTML = '';
            }, 5000);
        }

        // Excel'e aktarma fonksiyonu
        function exportToExcel(type, customFilename) {
            let data, headers, filename;
            
            switch(type) {
                case 'kalite':
                    data = kaliteKayitlari.map(kayit => {
                        const toplamHata = kayit.hatalar.reduce((total, hata) => total + hata.iskartaAdet + hata.geriGidenAdet, 0);
                        return {
                            'Tarih': new Date(kayit.tarih).toLocaleString('tr-TR'),
                            'Operatör': kayit.operator,
                            'Ürün Kodu': kayit.urunKodu,
                            'Toplam Adet': kayit.toplamAdet,
                            'Sipariş No': kayit.siparisNo,
                            'Toplam Hata': toplamHata,
                            'Başarı Oranı': Math.round((1 - toplamHata/kayit.toplamAdet) * 100) + '%',
                            'Hatalar': kayit.hatalar.map(h => `${h.tur}: İ${h.iskartaAdet} G${h.geriGidenAdet}`).join('; ')
                        };
                    });
                    filename = customFilename || 'kalite_kontrol_verileri';
                    break;
                    
                case 'performans':
                    data = performansKayitlari.map(kayit => {
                        const toplamSure = kayit.kutuHazirlik.sure + kayit.koliHazirlama.sure + kayit.izolasyon.sure + kayit.kaliteKontrol.sure;
                        return {
                            'Tarih': new Date(kayit.tarih).toLocaleDateString('tr-TR'),
                            'Çalışan': kayit.calisan,
                            'Kutu Hazırlık Adet': kayit.kutuHazirlik.adet,
                            'Kutu Hazırlık Süre': kayit.kutuHazirlik.sure,
                            'Koli Hazırlama Adet': kayit.koliHazirlama.adet,
                            'Koli Hazırlama Süre': kayit.koliHazirlama.sure,
                            'İzolasyon Adet': kayit.izolasyon.adet,
                            'İzolasyon Süre': kayit.izolasyon.sure,
                            'Kalite Kontrol Adet': kayit.kaliteKontrol.adet,
                            'Kalite Kontrol Süre': kayit.kaliteKontrol.sure,
                            'Toplam Süre': toplamSure
                        };
                    });
                    filename = customFilename || 'performans_verileri';
                    break;
                    
                case 'siparis':
                    data = siparisHazirlikKayitlari.map(siparis => {
                        const tamamlanan = Object.values(siparis.malzemeler).filter(m => m.hazir).length;
                        const toplam = Object.keys(siparis.malzemeler).length;
                        return {
                            'Tarih': new Date(siparis.tarih).toLocaleDateString('tr-TR'),
                            'Hazırlayan': siparis.operator,
                            'Sipariş No': siparis.siparisNo,
                            'Ürün Kodu': siparis.urunKodu,
                            'Sipariş Adedi': siparis.siparisAdet,
                            'Tamamlanan/Toplam': `${tamamlanan}/${toplam}`,
                            'Durum': tamamlanan === toplam ? 'Tamamlandı' : 'Devam Ediyor',
                            'Kutu Yapılan': siparis.malzemeler.kutu.yapildi,
                            'Kutu Hazır': siparis.malzemeler.kutu.hazir ? 'Evet' : 'Hayır',
                            'Koli Yapılan': siparis.malzemeler.koli.yapildi,
                            'Koli Hazır': siparis.malzemeler.koli.hazir ? 'Evet' : 'Hayır',
                            'İzolasyon Yapılan': siparis.malzemeler.izolasyon.yapildi,
                            'İzolasyon Hazır': siparis.malzemeler.izolasyon.hazir ? 'Evet' : 'Hayır'
                        };
                    });
                    filename = customFilename || 'siparis_hazirlik_verileri';
                    break;
                    
                case 'hepsi':
                    // Tüm veriler için kombinasyonu oluştur
                    const tumVeriler = [];
                    
                    kaliteKayitlari.forEach(kayit => {
                        tumVeriler.push({
                            'Veri Türü': 'Kalite Kontrol',
                            'Tarih': new Date(kayit.tarih).toLocaleString('tr-TR'),
                            'Kişi': kayit.operator,
                            'Ürün/Sipariş': kayit.urunKodu,
                            'Adet': kayit.toplamAdet,
                            'Detay': `Sipariş: ${kayit.siparisNo}`,
                            'Durum': 'Tamamlandı'
                        });
                    });
                    
                    siparisHazirlikKayitlari.forEach(siparis => {
                        const tamamlanan = Object.values(siparis.malzemeler).filter(m => m.hazir).length;
                        const toplam = Object.keys(siparis.malzemeler).length;
                        tumVeriler.push({
                            'Veri Türü': 'Sipariş Hazırlık',
                            'Tarih': new Date(siparis.tarih).toLocaleDateString('tr-TR'),
                            'Kişi': siparis.operator,
                            'Ürün/Sipariş': siparis.siparisNo,
                            'Adet': siparis.siparisAdet,
                            'Detay': `Ürün: ${siparis.urunKodu}`,
                            'Durum': tamamlanan === toplam ? 'Tamamlandı' : `${tamamlanan}/${toplam}`
                        });
                    });
                    
                    performansKayitlari.forEach(kayit => {
                        const toplamSure = kayit.kutuHazirlik.sure + kayit.koliHazirlama.sure + kayit.izolasyon.sure + kayit.kaliteKontrol.sure;
                        tumVeriler.push({
                            'Veri Türü': 'Performans',
                            'Tarih': new Date(kayit.tarih).toLocaleDateString('tr-TR'),
                            'Kişi': kayit.calisan,
                            'Ürün/Sipariş': 'Performans Kaydı',
                            'Adet': '-',
                            'Detay': `Toplam ${toplamSure} dakika`,
                            'Durum': 'Kayıtlı'
                        });
                    });
                    
                    data = tumVeriler;
                    filename = 'tum_veriler';
                    break;
                    
                default:
                    alert('Geçersiz veri türü!');
                    return;
            }
            
            if (data.length === 0) {
                alert('Dışa aktarılacak veri bulunamadı!');
                return;
            }
            
            // CSV formatında veriyi hazırla
            const csvContent = convertToCSV(data);
            
            // Dosyayı indir
            const blob = new Blob(['\uFEFF' + csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', `${filename}_${new Date().toISOString().slice(0, 10)}.csv`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showAlert('kaliteAlert', `${filename} başarıyla Excel formatında indirildi!`, 'success');
        }

        // CSV'ye çevir
        function convertToCSV(data) {
            if (data.length === 0) return '';
            
            const headers = Object.keys(data[0]);
            const csvRows = [headers.join(',')];
            
            data.forEach(row => {
                const values = headers.map(header => {
                    let value = row[header] || '';
                    // Virgül ve tırnak işaretlerini escape et
                    if (typeof value === 'string' && (value.includes(',') || value.includes('"') || value.includes('\n'))) {
                        value = '"' + value.replace(/"/g, '""') + '"';
                    }
                    return value;
                });
                csvRows.push(values.join(','));
            });
            
            return csvRows.join('\n');
        }

        // Tüm verileri yedekle
        function exportAllData() {
            const allData = {
                kaliteKayitlari: kaliteKayitlari,
                siparisHazirlikKayitlari: siparisHazirlikKayitlari,
                performansKayitlari: performansKayitlari,
                stokBilgileri: stokBilgileri,
                yedeklemeTarihi: new Date().toISOString()
            };
            
            const dataStr = JSON.stringify(allData, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `akg_sistem_yedek_${new Date().toISOString().slice(0, 10)}.json`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
            
            alert('Tüm veriler başarıyla yedeklendi!');
        }

        // Veri geri yükleme
        function importData() {
            const file = document.getElementById('importFile').files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    
                    if (confirm('Bu işlem mevcut tüm verileri silecek ve yedek dosyasındaki verilerle değiştirecektir. Devam etmek istiyor musunuz?')) {
                        if (data.kaliteKayitlari) {
                            kaliteKayitlari = data.kaliteKayitlari;
                            localStorage.setItem('kaliteKayitlari', JSON.stringify(kaliteKayitlari));
                        }
                        if (data.siparisHazirlikKayitlari) {
                            siparisHazirlikKayitlari = data.siparisHazirlikKayitlari;
                            localStorage.setItem('siparisHazirlikKayitlari', JSON.stringify(siparisHazirlikKayitlari));
                        }
                        if (data.performansKayitlari) {
                            performansKayitlari = data.performansKayitlari;
                            localStorage.setItem('performansKayitlari', JSON.stringify(performansKayitlari));
                        }
                        if (data.stokBilgileri) {
                            stokBilgileri = data.stokBilgileri;
                            localStorage.setItem('stokBilgileri', JSON.stringify(stokBilgileri));
                        }
                        
                        // Tüm verileri yeniden yükle
                        loadStats();
                        loadStok();
                        loadKaliteKayitlari();
                        loadSiparislerListesi();
                        loadIstatistikler();
                        loadVeriTablosu();
                        
                        alert('Veriler başarıyla geri yüklendi!');
                    }
                } catch (error) {
                    alert('Yedek dosyası okunamadı! Lütfen geçerli bir JSON dosyası seçin.');
                }
            };
            reader.readAsText(file);
        }

        // Tüm verileri temizle
        function clearAllData() {
            if (confirm('Bu işlem TÜM VERİLERİ siler ve geri alınamaz! Devam etmek istediğinizden emin misiniz?')) {
                if (confirm('Son kez soruyorum: TÜM VERİLER SİLİNECEK! Emin misiniz?')) {
                    localStorage.clear();
                    kaliteKayitlari = [];
                    siparisHazirlikKayitlari = [];
                    performansKayitlari = [];
                    stokBilgileri = {};
                    
                    // Tüm formlari temizle
                    document.querySelectorAll('form').forEach(form => form.reset());
                    
                    // Tarih alanlarını bugüne ayarla
                    const now = new Date();
                    document.getElementById('tarih').value = now.toISOString().slice(0, 16);
                    document.getElementById('hazirlikTarih').value = now.toISOString().slice(0, 10);
                    document.getElementById('performansTarih').value = now.toISOString().slice(0, 10);
                    
                    // Tüm verileri yeniden yükle
                    loadStats();
                    loadStok();
                    loadKaliteKayitlari();
                    loadSiparislerListesi();
                    loadIstatistikler();
                    loadVeriTablosu();
                    
                    alert('Tüm veriler başarıyla temizlendi!');
                }
            }
        }
    </script>
</body>
</html>
